<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HumanGlue Project Manager - Development Roadmap Tool</title>
    <meta name="description" content="Interactive project management and development roadmap tool for the HumanGlue platform">
    <link rel="icon" href="https://hmnglue.com/favcon_HG.png" type="image/png">

    <!-- Open Graph -->
    <meta property="og:title" content="HumanGlue Project Manager">
    <meta property="og:description" content="Interactive development roadmap and project tracking">
    <meta property="og:image" content="https://hmnglue.com/HumnaGlue_logo_white_blue.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/panzoom@9.4.3/dist/panzoom.min.js"></script>
    <!-- Supabase for multi-user collaboration -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --hg-cyan: #61D8FE;
            --hg-royal-blue: #3B82F6;
            --hg-blue: #3B82F6;
            --hg-green: #10B981;
            --hg-amber: #F59E0B;
            --hg-red: #EF4444;
            --hg-bg-primary: #0a0a0f;
            --hg-bg-secondary: #12121a;
            --hg-bg-sidebar: #0f0f16;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--hg-bg-primary);
            color: #e5e7eb;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Layout */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr 400px;
            grid-template-rows: 64px 1fr;
            height: 100vh;
            width: 100vw;
            transition: grid-template-columns 0.3s ease;
        }

        .app-container.sidebar-collapsed {
            grid-template-columns: 56px 1fr 400px;
        }

        .app-container.right-collapsed {
            grid-template-columns: 280px 1fr 56px;
        }

        .app-container.sidebar-collapsed.right-collapsed {
            grid-template-columns: 56px 1fr 56px;
        }

        .header {
            grid-column: 1 / -1;
            background: var(--hg-bg-sidebar);
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .sidebar {
            background: var(--hg-bg-sidebar);
            border-right: 1px solid rgba(97, 216, 254, 0.1);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 16px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            position: relative;
        }

        .sidebar-collapsed .sidebar {
            padding: 16px 8px;
            width: 56px;
            overflow: hidden;
        }

        /* Hide all text elements when sidebar is collapsed */
        .sidebar-collapsed .sidebar .nav-section-title,
        .sidebar-collapsed .sidebar .sidebar-footer,
        .sidebar-collapsed .sidebar .stats-grid,
        .sidebar-collapsed .sidebar .custom-sections,
        .sidebar-collapsed .sidebar #customSectionsContainer {
            display: none !important;
        }

        /* Hide the entire last nav-section (Custom Views) when collapsed */
        .sidebar-collapsed .sidebar .nav-section:last-of-type {
            display: none;
        }

        /* Hide text and badges in nav items when collapsed */
        .sidebar-collapsed .sidebar .nav-item {
            justify-content: center;
            padding: 10px;
            font-size: 0; /* Hide text content */
            overflow: hidden;
            width: 40px;
            height: 40px;
            text-indent: -9999px; /* Extra safety for text hiding */
        }

        .sidebar-collapsed .sidebar .nav-item svg {
            margin-right: 0;
            font-size: 18px; /* Reset for SVG */
            flex-shrink: 0;
            text-indent: 0; /* Reset for SVG */
        }

        .sidebar-collapsed .sidebar .nav-item span {
            display: none;
        }

        /* Collapse toggle buttons */
        .collapse-toggle {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 40px;
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 0 6px 6px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            transition: all 0.2s;
            z-index: 100;
        }

        .collapse-toggle:hover {
            background: rgba(97, 216, 254, 0.1);
            color: var(--hg-cyan);
            border-color: var(--hg-cyan);
        }

        .collapse-toggle.left {
            right: -20px;
        }

        .collapse-toggle.right {
            left: -20px;
            border-radius: 6px 0 0 6px;
        }

        .collapse-toggle svg {
            width: 14px;
            height: 14px;
            transition: transform 0.3s ease;
        }

        .sidebar-collapsed .collapse-toggle.left svg {
            transform: rotate(180deg);
        }

        .right-collapsed .collapse-toggle.right svg {
            transform: rotate(180deg);
        }

        /* Right panel collapse */
        .right-collapsed .right-panel {
            padding: 16px 8px;
        }

        .right-collapsed .right-panel .panel-tabs,
        .right-collapsed .right-panel .panel-content,
        .right-collapsed .right-panel .chat-container {
            display: none;
        }

        .right-collapsed .right-panel .collapsed-icons {
            display: flex;
        }

        .collapsed-icons {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            padding-top: 16px;
        }

        .collapsed-icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .collapsed-icon-btn:hover {
            background: rgba(97, 216, 254, 0.1);
            color: var(--hg-cyan);
            border-color: var(--hg-cyan);
        }

        .collapsed-icon-btn svg {
            width: 20px;
            height: 20px;
        }

        .main-canvas {
            background: var(--hg-bg-primary);
            position: relative;
            overflow: hidden;
        }

        .right-panel {
            background: var(--hg-bg-sidebar);
            border-left: 1px solid rgba(97, 216, 254, 0.1);
            display: flex;
            flex-direction: column;
        }

        /* Logo */
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-img {
            height: 36px;
            width: auto;
        }

        /* Sidebar Styles */
        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #6b7280;
            margin-bottom: 8px;
            padding: 0 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: #9ca3af;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
        }

        .nav-item:hover {
            background: rgba(97, 216, 254, 0.1);
            color: white;
        }

        .nav-item.active {
            background: rgba(97, 216, 254, 0.15);
            color: var(--hg-cyan);
            border-left: 2px solid var(--hg-cyan);
        }

        .nav-item-badge {
            margin-left: auto;
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-green { background: rgba(16, 185, 129, 0.2); color: #10B981; }
        .badge-amber { background: rgba(245, 158, 11, 0.2); color: #F59E0B; }
        .badge-blue { background: rgba(59, 130, 246, 0.2); color: #3B82F6; }
        .badge-red { background: rgba(239, 68, 68, 0.2); color: #EF4444; }
        .badge-cyan { background: rgba(97, 216, 254, 0.2); color: #61D8FE; }

        /* Canvas Controls */
        .canvas-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 8px;
            z-index: 100;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #9ca3af;
            transition: all 0.2s;
        }

        .control-btn:hover {
            background: rgba(97, 216, 254, 0.1);
            color: var(--hg-cyan);
            border-color: var(--hg-cyan);
        }

        .zoom-display {
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 8px;
            padding: 0 16px;
            display: flex;
            align-items: center;
            color: #9ca3af;
            font-size: 13px;
        }

        /* Diagram Container */
        .diagram-container {
            width: 100%;
            height: 100%;
            cursor: grab;
        }

        .diagram-container:active {
            cursor: grabbing;
        }

        .diagram-wrapper {
            padding: 40px;
            min-width: 1400px;
            min-height: 900px;
        }

        /* Mermaid Customization - All Diagram Types */
        .mermaid {
            background: transparent !important;
        }

        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node polygon {
            cursor: pointer !important;
        }

        /* Ensure text is visible across all diagram types */
        .mermaid text,
        .mermaid .nodeLabel,
        .mermaid .label,
        .mermaid .edgeLabel,
        .mermaid .messageText,
        .mermaid tspan {
            fill: #e5e7eb !important;
            color: #e5e7eb !important;
        }

        /* Sequence diagram styling */
        .mermaid .actor {
            fill: #1e293b !important;
            stroke: #61D8FE !important;
            stroke-width: 2px !important;
        }
        .mermaid .actor-line {
            stroke: #61D8FE !important;
        }
        .mermaid .messageLine0,
        .mermaid .messageLine1 {
            stroke: #61D8FE !important;
            stroke-width: 1.5px !important;
        }
        .mermaid .note {
            fill: #12121a !important;
            stroke: #3B82F6 !important;
        }

        /* ER diagram styling */
        .mermaid .entityBox {
            fill: #1e293b !important;
            stroke: #61D8FE !important;
            stroke-width: 2px !important;
        }
        .mermaid .entityLabel {
            fill: #61D8FE !important;
        }
        .mermaid .relationshipLabel {
            fill: #e5e7eb !important;
        }
        .mermaid .relationshipLine {
            stroke: #61D8FE !important;
        }
        .mermaid .attributeBoxOdd {
            fill: #12121a !important;
        }
        .mermaid .attributeBoxEven {
            fill: #1e293b !important;
        }

        /* Gantt chart styling */
        .mermaid .section {
            fill: #12121a !important;
        }
        .mermaid .section0,
        .mermaid .section2 {
            fill: #12121a !important;
        }
        .mermaid .section1,
        .mermaid .section3 {
            fill: #1e293b !important;
        }
        .mermaid .grid .tick line {
            stroke: #374151 !important;
        }
        .mermaid .grid .tick text {
            fill: #9ca3af !important;
        }
        .mermaid .task {
            stroke-width: 0 !important;
        }
        .mermaid .taskText {
            fill: #0a0a0f !important;
            font-weight: 500 !important;
        }
        .mermaid .taskTextOutsideRight,
        .mermaid .taskTextOutsideLeft {
            fill: #e5e7eb !important;
        }
        .mermaid .sectionTitle {
            fill: #e5e7eb !important;
            font-weight: 600 !important;
        }
        .mermaid .titleText {
            fill: #61D8FE !important;
            font-size: 20px !important;
            font-weight: 700 !important;
        }
        .mermaid .todayMarker {
            stroke: #EF4444 !important;
            stroke-width: 2px !important;
        }

        /* Cluster/subgraph styling */
        .mermaid .cluster rect {
            fill: #12121a !important;
            stroke: #3B82F6 !important;
            stroke-width: 1px !important;
        }
        .mermaid .cluster-label text {
            fill: #3B82F6 !important;
        }

        /* Mobile Toggle Buttons */
        .mobile-menu-btn,
        .mobile-panel-btn {
            display: none;
            width: 40px;
            height: 40px;
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 8px;
            color: #9ca3af;
            cursor: pointer;
            align-items: center;
            justify-content: center;
        }

        .mobile-menu-btn:hover,
        .mobile-panel-btn:hover {
            background: rgba(97, 216, 254, 0.1);
            color: var(--hg-cyan);
        }

        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 240px 1fr 320px;
            }
        }

        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: 64px 1fr 60px; /* Add space for bottom nav */
            }

            .sidebar {
                display: none;
                position: fixed;
                top: 64px;
                left: 0;
                width: 280px;
                height: calc(100vh - 64px - 60px); /* Account for bottom nav */
                z-index: 1000;
                box-shadow: 4px 0 20px rgba(0, 0, 0, 0.5);
            }

            .sidebar.show {
                display: flex;
            }

            .right-panel {
                display: none;
                position: fixed;
                top: 64px;
                right: 0;
                width: 100%;
                max-width: 400px;
                height: calc(100vh - 64px - 60px); /* Account for bottom nav */
                z-index: 1000;
                box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
            }

            .right-panel.show {
                display: flex;
            }

            .mobile-menu-btn,
            .mobile-panel-btn {
                display: flex;
            }

            /* Hide desktop collapse toggles on mobile */
            .collapse-toggle {
                display: none !important;
            }

            /* Reset collapsed sidebar styling on mobile - always show full sidebar */
            .sidebar-collapsed .sidebar {
                width: 280px !important;
                padding: 16px !important;
            }

            .sidebar-collapsed .sidebar .nav-section-title,
            .sidebar-collapsed .sidebar .sidebar-footer,
            .sidebar-collapsed .sidebar .stats-grid,
            .sidebar-collapsed .sidebar .custom-sections,
            .sidebar-collapsed .sidebar #customSectionsContainer,
            .sidebar-collapsed .sidebar .nav-section:last-of-type {
                display: block !important;
            }

            .sidebar-collapsed .sidebar .nav-item {
                justify-content: flex-start !important;
                padding: 10px 12px !important;
                font-size: 14px !important;
                width: auto !important;
                height: auto !important;
                text-indent: 0 !important;
            }

            .sidebar-collapsed .sidebar .nav-item svg {
                margin-right: 10px !important;
            }

            .sidebar-collapsed .sidebar .nav-item span {
                display: inline !important;
            }

            .header {
                padding: 0 16px;
            }

            .logo-title {
                display: none;
            }

            .diagram-wrapper {
                padding: 20px;
                padding-left: 0; /* Fix diagram being cut off */
                min-width: auto;
                min-height: auto;
            }

            .diagram-info {
                position: relative;
                left: 0;
                margin-left: 16px;
            }

            .canvas-controls {
                bottom: 70px; /* Above bottom nav */
                left: 10px;
            }

            .control-btn {
                width: 36px;
                height: 36px;
            }

            .zoom-display {
                padding: 0 12px;
                font-size: 12px;
            }

            /* Mobile Bottom Navigation */
            .mobile-bottom-nav {
                display: flex !important;
            }

            /* Hide tasks button in header on mobile - now in bottom nav */
            .mobile-panel-btn {
                display: none !important;
            }
        }

        @media (max-width: 640px) {
            .header {
                padding: 0 12px;
            }

            /* Hide hamburger menu in header - now in bottom nav */
            .mobile-menu-btn {
                display: none !important;
            }

            .logo-img {
                height: 28px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }

            .stat-item {
                padding: 12px;
            }

            .stat-number {
                font-size: 20px;
            }

            .header-actions {
                gap: 8px;
            }

            .header-actions .btn-text {
                display: none;
            }

            .header-actions .auto-save-text {
                display: none;
            }

            /* Better button styling for mobile */
            .header-actions .btn-secondary,
            .header-actions .btn-primary {
                padding: 10px 12px;
                min-width: 44px;
                min-height: 44px;
            }

            .btn-secondary svg:only-child,
            .btn-primary svg:only-child {
                margin: 0;
            }

            .right-panel {
                max-width: 100%;
            }

            .chat-input-container {
                padding: 12px;
            }

            .panel-content {
                padding: 12px;
            }

            .note-card {
                padding: 12px;
            }

            .diagram-info {
                padding: 12px 16px;
            }

            .diagram-info h2 {
                font-size: 18px;
            }

            /* Make canvas fill available space */
            .main-canvas {
                height: calc(100vh - 64px - 60px);
            }
        }

        /* Overlay for mobile panels */
        .mobile-overlay {
            display: none;
            position: fixed;
            inset: 0;
            top: 64px;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .mobile-overlay.show {
            display: block;
        }

        /* Mobile Bottom Navigation */
        .mobile-bottom-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: var(--hg-bg-sidebar);
            border-top: 1px solid rgba(97, 216, 254, 0.2);
            z-index: 1001;
            justify-content: space-around;
            align-items: center;
            padding: 0 8px;
        }

        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #6b7280;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            min-width: 70px;
        }

        .mobile-nav-item:hover,
        .mobile-nav-item:active {
            background: rgba(97, 216, 254, 0.1);
            color: var(--hg-cyan);
        }

        .mobile-nav-item.active {
            color: var(--hg-cyan);
        }

        .mobile-nav-item svg {
            width: 22px;
            height: 22px;
        }

        .mobile-nav-label {
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        /* Right Panel Tabs */
        .panel-tabs {
            display: flex;
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
        }

        .panel-tab {
            flex: 1;
            padding: 14px;
            text-align: center;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
            cursor: pointer;
            border: none;
            background: transparent;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .panel-tab:hover {
            color: #9ca3af;
            background: rgba(97, 216, 254, 0.05);
        }

        .panel-tab.active {
            color: var(--hg-cyan);
            border-bottom-color: var(--hg-cyan);
        }

        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            min-height: 0; /* Allow flex shrinking */
        }

        /* Chat panel needs hidden overflow - chat-messages handles scroll */
        #chatPanel {
            overflow: hidden;
            padding: 0;
            display: flex;
            flex-direction: column;
        }

        /* Notes Panel */
        .note-card {
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .note-card:hover {
            border-color: rgba(97, 216, 254, 0.3);
            transform: translateY(-1px);
        }

        .note-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .note-card-title {
            font-weight: 600;
            font-size: 14px;
            color: white;
        }

        .note-card-status {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .note-card-body {
            font-size: 13px;
            color: #9ca3af;
            line-height: 1.5;
        }

        .note-card-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
            font-size: 11px;
            color: #6b7280;
        }

        .add-note-btn {
            width: 100%;
            padding: 12px;
            background: rgba(97, 216, 254, 0.1);
            border: 1px dashed rgba(97, 216, 254, 0.3);
            border-radius: 8px;
            color: var(--hg-cyan);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .add-note-btn:hover {
            background: rgba(97, 216, 254, 0.15);
            border-color: var(--hg-cyan);
        }

        /* AI Chat Panel */
        .chat-container {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 0; /* Critical for flex children to scroll */
            overflow: hidden;
            height: 100%;
        }

        /* Expert selector - fixed at top */
        #expertSelector {
            flex: 0 0 auto;
        }

        .chat-messages {
            flex: 1 1 0;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 16px;
            min-height: 0;
        }

        /* Input container - fixed at bottom */
        .chat-input-container {
            flex: 0 0 auto;
        }

        /* Hot buttons - fixed at bottom */
        .ai-hot-buttons {
            flex: 0 0 auto;
        }

        .chat-message {
            margin-bottom: 16px;
        }

        .chat-message.user {
            text-align: right;
        }

        .chat-message-bubble {
            display: inline-block;
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 13px;
            line-height: 1.5;
        }

        .chat-message.assistant .chat-message-bubble {
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.1);
            color: #e5e7eb;
            border-bottom-left-radius: 4px;
        }

        .chat-message.user .chat-message-bubble {
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-input-container {
            padding: 16px;
            border-top: 1px solid rgba(97, 216, 254, 0.1);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 8px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 13px;
            outline: none;
            transition: border-color 0.2s;
        }

        .chat-input:focus {
            border-color: var(--hg-cyan);
        }

        .chat-send-btn {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, opacity 0.2s;
        }

        .chat-send-btn:hover {
            transform: scale(1.05);
        }

        /* Tasks Panel */
        .task-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .task-filter {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.1);
            color: #9ca3af;
            transition: all 0.2s;
        }

        .task-filter:hover, .task-filter.active {
            border-color: var(--hg-cyan);
            color: var(--hg-cyan);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal {
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 16px;
            width: 520px;
            max-width: 90vw;
            max-height: 90vh;
            overflow: hidden;
            transform: scale(0.95);
            transition: transform 0.2s;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            background: transparent;
            border: none;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.1);
            color: var(--hg-red);
        }

        .modal-body {
            padding: 24px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #9ca3af;
            margin-bottom: 8px;
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-family: inherit;
            outline: none;
            transition: border-color 0.2s;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            border-color: var(--hg-cyan);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-select {
            cursor: pointer;
        }

        .modal-actions {
            padding: 16px 24px;
            border-top: 1px solid rgba(97, 216, 254, 0.1);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-family: inherit;
        }

        .btn-secondary {
            background: var(--hg-bg-primary);
            border: 1px solid rgba(97, 216, 254, 0.2);
            color: #9ca3af;
        }

        .btn-secondary:hover {
            background: rgba(97, 216, 254, 0.1);
            color: white;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(97, 216, 254, 0.3);
        }

        .btn-danger {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Status Colors */
        .status-todo { background: rgba(107, 114, 128, 0.2); color: #9ca3af; }
        .status-in-progress { background: rgba(245, 158, 11, 0.2); color: #F59E0B; }
        .status-completed { background: rgba(16, 185, 129, 0.2); color: #10B981; }
        .status-blocked { background: rgba(239, 68, 68, 0.2); color: #EF4444; }

        /* Priority Colors */
        .priority-low { border-left: 3px solid #6b7280; }
        .priority-medium { border-left: 3px solid var(--hg-amber); }
        .priority-high { border-left: 3px solid var(--hg-red); }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .stat-mini {
            background: var(--hg-bg-primary);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }

        .stat-mini-value {
            font-size: 24px;
            font-weight: 700;
        }

        .stat-mini-label {
            font-size: 11px;
            color: #6b7280;
            margin-top: 2px;
        }

        /* Sidebar Footer */
        .sidebar-footer {
            margin-top: auto;
            padding-top: 16px;
            border-top: 1px solid rgba(97, 216, 254, 0.1);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .app-container {
                grid-template-columns: 240px 1fr 360px;
            }
        }

        @media (max-width: 1100px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: 64px 1fr auto;
            }
            .sidebar { display: none; }
            .right-panel {
                height: 350px;
                border-left: none;
                border-top: 1px solid rgba(97, 216, 254, 0.1);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(97, 216, 254, 0.2); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(97, 216, 254, 0.3); }

        /* AI Hot Buttons */
        .ai-hot-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            padding: 12px;
            border-top: 1px solid rgba(97, 216, 254, 0.1);
            background: rgba(10, 10, 15, 0.5);
        }

        .ai-hot-btn {
            padding: 6px 12px;
            font-size: 11px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(97, 216, 254, 0.2);
            background: var(--hg-bg-primary);
            color: #9ca3af;
            display: flex;
            align-items: center;
            gap: 4px;
            font-family: inherit;
        }

        .ai-hot-btn:hover {
            border-color: var(--hg-cyan);
            color: var(--hg-cyan);
            background: rgba(97, 216, 254, 0.1);
        }

        .ai-hot-btn svg {
            width: 12px;
            height: 12px;
        }

        /* AI Action Cards in responses */
        .ai-action-card {
            background: rgba(97, 216, 254, 0.05);
            border: 1px solid rgba(97, 216, 254, 0.15);
            border-radius: 10px;
            padding: 12px;
            margin: 8px 0;
        }

        .ai-action-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .ai-action-icon {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-action-icon.status { background: rgba(16, 185, 129, 0.2); color: #10B981; }
        .ai-action-icon.task { background: rgba(59, 130, 246, 0.2); color: #3B82F6; }
        .ai-action-icon.info { background: rgba(59, 130, 246, 0.2); color: #3B82F6; }
        .ai-action-icon.warning { background: rgba(245, 158, 11, 0.2); color: #F59E0B; }
        .ai-action-icon.blocker { background: rgba(239, 68, 68, 0.2); color: #EF4444; }

        .ai-action-title {
            font-weight: 600;
            font-size: 13px;
            color: #e5e7eb;
        }

        .ai-action-content {
            font-size: 12px;
            color: #9ca3af;
            line-height: 1.5;
        }

        .ai-action-content ul {
            margin: 6px 0;
            padding-left: 16px;
        }

        .ai-action-content li {
            margin: 4px 0;
        }

        .ai-response-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .ai-response-btn {
            padding: 5px 10px;
            font-size: 11px;
            border-radius: 6px;
            cursor: pointer;
            border: none;
            font-family: inherit;
            transition: all 0.15s;
        }

        .ai-response-btn.primary {
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            color: white;
        }

        .ai-response-btn.secondary {
            background: rgba(97, 216, 254, 0.1);
            border: 1px solid rgba(97, 216, 254, 0.2);
            color: var(--hg-cyan);
        }

        .ai-response-btn:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 8px 0;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--hg-cyan);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-4px); opacity: 1; }
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6b7280;
        }

        .empty-state svg {
            margin: 0 auto 16px;
            opacity: 0.5;
        }

        /* Diagram title overlay */
        .diagram-title-overlay {
            position: absolute;
            top: 12px;
            left: 12px;
            z-index: 100;
            background: rgba(10, 10, 15, 0.85);
            backdrop-filter: blur(8px);
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid rgba(97, 216, 254, 0.1);
            max-width: 200px;
        }

        .diagram-title-overlay h2 {
            font-size: 14px !important;
            line-height: 1.2;
            margin: 0 0 4px 0;
        }

        .diagram-title-overlay p {
            font-size: 11px !important;
            line-height: 1.3;
            margin: 0;
            opacity: 0.7;
        }

        /* Quick actions */
        .quick-actions {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            gap: 8px;
        }

        /* Interactive Gantt Chart Styles */
        .interactive-gantt {
            width: 100%;
            padding: 20px;
            overflow-x: auto;
        }

        .gantt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
        }

        .gantt-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--hg-cyan);
        }

        .gantt-controls {
            display: flex;
            gap: 12px;
        }

        .gantt-timeline {
            position: relative;
            min-height: 400px;
        }

        .gantt-months {
            display: flex;
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
            padding-bottom: 8px;
            margin-bottom: 16px;
            position: sticky;
            top: 0;
            background: var(--hg-bg-primary);
            z-index: 10;
        }

        .gantt-month {
            flex: 1;
            min-width: 80px;
            text-align: center;
            font-size: 12px;
            font-weight: 500;
            color: #9ca3af;
        }

        .gantt-section {
            margin-bottom: 24px;
        }

        .gantt-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--hg-blue);
            margin-bottom: 12px;
            padding: 8px 12px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 6px;
            display: inline-block;
        }

        .gantt-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .gantt-item {
            display: flex;
            align-items: center;
            height: 36px;
            position: relative;
        }

        .gantt-item-label {
            width: 180px;
            flex-shrink: 0;
            font-size: 13px;
            color: #e5e7eb;
            padding-right: 16px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .gantt-item-bar-container {
            flex: 1;
            position: relative;
            height: 100%;
        }

        .gantt-item-bar {
            position: absolute;
            height: 28px;
            top: 4px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            padding: 0 12px;
            font-size: 12px;
            font-weight: 500;
            color: white;
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            box-shadow: 0 2px 8px rgba(97, 216, 254, 0.3);
        }

        .gantt-item-bar:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(97, 216, 254, 0.4);
        }

        .gantt-item-bar.status-done {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .gantt-item-bar.status-active {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .gantt-item-bar.status-blocked {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .gantt-item-bar .drag-handle {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 12px;
            cursor: ew-resize;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 0 6px 6px 0;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .gantt-item-bar:hover .drag-handle {
            opacity: 1;
        }

        .gantt-grid-lines {
            position: absolute;
            inset: 0;
            pointer-events: none;
            display: flex;
        }

        .gantt-grid-line {
            flex: 1;
            border-left: 1px solid rgba(97, 216, 254, 0.05);
        }

        .gantt-add-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(97, 216, 254, 0.1);
            border: 1px dashed rgba(97, 216, 254, 0.3);
            border-radius: 8px;
            color: var(--hg-cyan);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 12px;
        }

        .gantt-add-btn:hover {
            background: rgba(97, 216, 254, 0.2);
            border-color: var(--hg-cyan);
        }

        /* AI Tooltip Styles */
        .ai-tooltip {
            position: fixed;
            z-index: 9999;
            max-width: 400px;
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.3);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .ai-tooltip.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .ai-tooltip-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
        }

        .ai-tooltip-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-tooltip-title {
            font-weight: 600;
            color: white;
        }

        .ai-tooltip-content {
            font-size: 13px;
            color: #e5e7eb;
            line-height: 1.5;
        }

        .ai-tooltip-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(97, 216, 254, 0.1);
        }

        .ai-tooltip-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .ai-tooltip-btn-primary {
            background: var(--hg-cyan);
            color: #0a0a0f;
        }

        .ai-tooltip-btn-secondary {
            background: rgba(97, 216, 254, 0.1);
            color: var(--hg-cyan);
        }

        /* AI Thinking Animation */
        .ai-thinking {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: var(--hg-cyan);
        }

        .ai-thinking-dot {
            width: 6px;
            height: 6px;
            background: var(--hg-cyan);
            border-radius: 50%;
            animation: ai-pulse 1.4s infinite ease-in-out;
        }

        .ai-thinking-dot:nth-child(2) { animation-delay: 0.2s; }
        .ai-thinking-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes ai-pulse {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* AI Suggestion Cards */
        .ai-suggestion {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }

        .ai-suggestion-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--hg-blue);
            margin-bottom: 8px;
        }

        .ai-suggestion-content {
            font-size: 13px;
            color: #e5e7eb;
        }

        /* Quick AI Actions in Header */
        .ai-quick-ask {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: linear-gradient(135deg, rgba(97, 216, 254, 0.1), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 20px;
            color: var(--hg-cyan);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ai-quick-ask:hover {
            background: linear-gradient(135deg, rgba(97, 216, 254, 0.2), rgba(59, 130, 246, 0.2));
            border-color: var(--hg-cyan);
        }

        .ai-quick-ask svg {
            width: 16px;
            height: 16px;
        }

        /* Context Panel for AI */
        .ai-context-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 12px;
            font-size: 11px;
            color: var(--hg-blue);
        }

        /* ==========================================
           KANBAN BOARD STYLES
           ========================================== */
        .kanban-board {
            display: flex;
            gap: 16px;
            padding: 20px;
            min-height: 100%;
            overflow-x: auto;
        }

        .kanban-column {
            flex: 0 0 280px;
            background: var(--hg-bg-primary);
            border-radius: 12px;
            border: 1px solid rgba(97, 216, 254, 0.1);
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 200px);
        }

        .kanban-column-header {
            padding: 16px;
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .kanban-column-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 14px;
        }

        .kanban-column-count {
            background: rgba(97, 216, 254, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            color: var(--hg-cyan);
        }

        .kanban-column-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .kanban-column-dot.backlog { background: #6b7280; }
        .kanban-column-dot.todo { background: #3B82F6; }
        .kanban-column-dot.progress { background: #F59E0B; }
        .kanban-column-dot.review { background: #3B82F6; }
        .kanban-column-dot.done { background: #10B981; }

        .kanban-column-items {
            padding: 12px;
            flex: 1;
            overflow-y: auto;
            min-height: 200px;
        }

        .kanban-column-items.drag-over {
            background: rgba(97, 216, 254, 0.05);
        }

        .kanban-card {
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 10px;
            cursor: grab;
            transition: all 0.2s;
        }

        .kanban-card:active {
            cursor: grabbing;
        }

        .kanban-card.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .kanban-card:hover {
            border-color: var(--hg-cyan);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }

        .kanban-card-title {
            font-size: 13px;
            font-weight: 500;
            color: #e5e7eb;
            margin-bottom: 8px;
        }

        .kanban-card-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .kanban-card-tag {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .kanban-card-tag.feature { background: rgba(59, 130, 246, 0.2); color: #3B82F6; }
        .kanban-card-tag.bug { background: rgba(239, 68, 68, 0.2); color: #EF4444; }
        .kanban-card-tag.enhancement { background: rgba(59, 130, 246, 0.2); color: #3B82F6; }
        .kanban-card-tag.docs { background: rgba(16, 185, 129, 0.2); color: #10B981; }
        .kanban-card-tag.design { background: rgba(236, 72, 153, 0.2); color: #EC4899; }

        .kanban-card-points {
            background: rgba(97, 216, 254, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            color: var(--hg-cyan);
            font-weight: 600;
        }

        .kanban-card-assignee {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            color: white;
            margin-left: auto;
        }

        .kanban-add-card {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 12px;
            margin: 0 12px 12px;
            background: transparent;
            border: 1px dashed rgba(97, 216, 254, 0.2);
            border-radius: 8px;
            color: #6b7280;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .kanban-add-card:hover {
            border-color: var(--hg-cyan);
            color: var(--hg-cyan);
            background: rgba(97, 216, 254, 0.05);
        }

        .kanban-sprint-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: var(--hg-bg-primary);
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
        }

        .kanban-sprint-info {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .kanban-sprint-name {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }

        .kanban-sprint-dates {
            font-size: 12px;
            color: #6b7280;
        }

        .kanban-sprint-progress {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .kanban-progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(97, 216, 254, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .kanban-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--hg-cyan), var(--hg-green));
            border-radius: 3px;
            transition: width 0.3s;
        }

        .kanban-progress-text {
            font-size: 12px;
            color: var(--hg-cyan);
            font-weight: 600;
        }

        /* ==========================================
           NODE EDITING TOOLBAR
           ========================================== */
        .node-toolbar {
            position: fixed;
            display: none;
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.3);
            border-radius: 10px;
            padding: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            gap: 4px;
        }

        .node-toolbar.visible {
            display: flex;
        }

        .node-toolbar-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid transparent;
            background: transparent;
            color: #9ca3af;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .node-toolbar-btn:hover {
            background: rgba(97, 216, 254, 0.1);
            border-color: var(--hg-cyan);
            color: var(--hg-cyan);
        }

        .node-toolbar-btn.danger:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: #EF4444;
            color: #EF4444;
        }

        .node-toolbar-separator {
            width: 1px;
            height: 28px;
            background: rgba(97, 216, 254, 0.2);
            margin: 0 4px;
        }

        /* GTM Strategy Styles - Fixed scrolling */
        .gtm-page-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow-y: scroll !important;
            overflow-x: hidden;
            background: var(--hg-bg-primary);
            -webkit-overflow-scrolling: touch;
        }

        .gtm-container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px;
            min-height: 100%;
        }

        /* Interactive Checkboxes */
        .gtm-checkbox {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            margin-right: 8px;
            flex-shrink: 0;
            transition: all 0.2s;
        }

        .gtm-checkbox:hover {
            border-color: var(--hg-cyan);
        }

        .gtm-checkbox:checked {
            background: var(--hg-cyan);
            border-color: var(--hg-cyan);
        }

        .gtm-checkbox:checked::after {
            content: '';
            position: absolute;
            top: -2px;
            left: 2px;
            color: var(--hg-bg-primary);
            font-size: 14px;
            font-weight: bold;
        }

        .gtm-task-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .gtm-task-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .gtm-task-item.completed {
            opacity: 0.5;
        }

        .gtm-task-item.completed .gtm-task-text {
            text-decoration: line-through;
        }

        /* Editable Elements */
        .gtm-editable {
            position: relative;
            transition: all 0.2s;
        }

        .gtm-editable:hover::after {
            content: '';
            position: absolute;
            top: 4px;
            right: 4px;
            font-size: 14px;
            color: var(--hg-cyan);
            opacity: 0.5;
        }

        .gtm-editable:focus {
            outline: 2px solid var(--hg-cyan);
            outline-offset: 2px;
            border-radius: 4px;
        }

        /* Progress Bars */
        .gtm-progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .gtm-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--hg-cyan), var(--hg-blue));
            transition: width 0.5s ease;
            border-radius: 2px;
        }

        /* Expandable Sections */
        .gtm-expandable {
            cursor: pointer;
            user-select: none;
        }

        .gtm-expandable-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .gtm-expandable-header:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .gtm-expand-icon {
            transition: transform 0.3s;
        }

        .gtm-expandable.expanded .gtm-expand-icon {
            transform: rotate(180deg);
        }

        .gtm-expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .gtm-expandable.expanded .gtm-expandable-content {
            max-height: 2000px;
        }

        /* Toast Notifications */
        .gtm-toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--hg-bg-secondary);
            border: 1px solid var(--hg-cyan);
            border-radius: 8px;
            padding: 16px 20px;
            color: var(--hg-text);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .gtm-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .gtm-title-section h1 {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .gtm-subtitle {
            color: #9ca3af;
            font-size: 14px;
        }

        .gtm-urgent-card {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(239, 68, 68, 0.1));
            border: 2px solid var(--hg-amber);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 32px;
            position: relative;
        }

        .gtm-urgent-badge {
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--hg-bg-primary);
            padding: 0 12px;
            font-size: 12px;
            font-weight: 700;
            color: var(--hg-amber);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .gtm-workshop-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 24px;
        }

        .gtm-workshop-card {
            background: var(--hg-bg-secondary);
            padding: 24px;
            border-radius: 12px;
            border: 1px solid rgba(97, 216, 254, 0.2);
        }

        .gtm-workshop-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .gtm-workshop-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--hg-cyan), var(--hg-blue));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .gtm-action-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 28px;
            padding-top: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gtm-action-card {
            background: rgba(245, 158, 11, 0.1);
            padding: 16px;
            border-radius: 8px;
            border-left: 3px solid var(--hg-amber);
        }

        .gtm-tabs {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 32px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .gtm-tabs-sticky {
            position: sticky;
            top: 0;
            background: var(--hg-bg-primary);
            z-index: 50;
            padding: 16px 0;
            margin: 0 0 24px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .gtm-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            color: #9ca3af;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s;
        }

        .gtm-tab:hover {
            color: #e5e7eb;
        }

        .gtm-tab.active {
            color: var(--hg-cyan);
            border-bottom-color: var(--hg-cyan);
        }

        .gtm-stage-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .gtm-stage-card {
            background: var(--hg-bg-secondary);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.2s;
        }

        .gtm-stage-card:hover {
            transform: translateY(-2px);
            border-color: var(--hg-cyan);
        }

        .gtm-phase-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
        }

        .gtm-phase-card {
            background: var(--hg-bg-secondary);
            padding: 24px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gtm-timeline-container {
            background: var(--hg-bg-secondary);
            padding: 32px;
            border-radius: 12px;
        }

        .gtm-week-item {
            position: relative;
            padding-left: 32px;
            margin-bottom: 32px;
        }

        .gtm-week-item::before {
            content: '';
            position: absolute;
            left: 7px;
            top: 24px;
            width: 2px;
            height: calc(100% - 8px);
            background: rgba(97, 216, 254, 0.2);
        }

        .gtm-week-item::after {
            content: '';
            position: absolute;
            left: 0;
            top: 4px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--hg-cyan);
            border: 3px solid var(--hg-bg-primary);
        }

        .gtm-template-card {
            background: var(--hg-bg-secondary);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gtm-template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .gtm-template-content {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            color: #d1d5db;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .gtm-metrics-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .gtm-metric-card {
            background: var(--hg-bg-secondary);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .gtm-metric-value {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--hg-cyan), var(--hg-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .gtm-revenue-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .gtm-editable {
            outline: none;
            transition: all 0.2s;
        }

        .gtm-editable[contenteditable="true"] {
            outline: 2px solid var(--hg-cyan);
            outline-offset: 4px;
            border-radius: 4px;
        }

        /* Editable Task Elements */
        .gtm-editable-task {
            outline: none;
            transition: all 0.2s;
            padding: 4px;
            border-radius: 4px;
        }

        .gtm-editable-task[contenteditable="true"] {
            outline: 2px solid var(--hg-cyan);
            outline-offset: 4px;
            border: 1px dashed var(--hg-cyan);
            background: rgba(6, 182, 212, 0.05);
            padding: 8px;
        }

        .gtm-editable-task:focus {
            background: rgba(6, 182, 212, 0.1);
        }

        /* Gantt Chart Styles */
        .gantt-container {
            margin-top: 24px;
        }

        .gantt-chart {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(97, 216, 254, 0.2);
            border-radius: 12px;
            overflow-x: auto;
            padding: 16px;
        }

        .gantt-header {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 16px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(97, 216, 254, 0.3);
        }

        .gantt-task-label {
            font-weight: 600;
            color: var(--hg-cyan);
            padding: 8px 12px;
            display: flex;
            align-items: center;
        }

        .gantt-timeline {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 2px;
            position: relative;
        }

        .gantt-month {
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #9ca3af;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .gantt-row {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 16px;
            margin-bottom: 8px;
            min-height: 48px;
        }

        .gantt-row:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .gantt-row .gantt-task-label {
            font-weight: 500;
            color: #e5e7eb;
            font-size: 14px;
        }

        .gantt-row .gantt-timeline {
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            padding: 8px 0;
        }

        .gantt-bar {
            position: absolute;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            cursor: pointer;
        }

        .gantt-bar:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            z-index: 10;
        }

        /* Interactive Gantt Features */
        .gantt-bar {
            position: relative;
        }

        .gantt-bar::after {
            content: attr(data-details);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
            border: 1px solid rgba(97, 216, 254, 0.3);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        .gantt-bar:hover::after {
            opacity: 1;
            transform: translateX(-50%) translateY(-4px);
        }

        .gantt-bar.completed {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%) !important;
            position: relative;
            overflow: hidden;
        }

        .gantt-bar.completed::before {
            content: '';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            font-weight: bold;
        }

        .gantt-bar.in-progress {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%) !important;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
        }

        .gantt-bar-progress {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px 0 0 6px;
            transition: width 0.3s;
        }

        .gantt-row.expandable {
            cursor: pointer;
        }

        .gantt-row.expandable .gantt-task-label::before {
            content: '';
            margin-right: 8px;
            transition: transform 0.3s;
            display: inline-block;
        }

        .gantt-row.expandable.expanded .gantt-task-label::before {
            transform: rotate(90deg);
        }

        .gantt-subtasks {
            display: none;
            padding-left: 32px;
            margin-top: 8px;
            border-left: 2px solid rgba(97, 216, 254, 0.2);
        }

        .gantt-row.expanded + .gantt-subtasks {
            display: block;
        }

        .gantt-legend {
            display: flex;
            gap: 24px;
            margin-top: 16px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .gantt-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #9ca3af;
        }

        .gantt-legend-color {
            width: 24px;
            height: 16px;
            border-radius: 4px;
        }

        /* Mobile Responsiveness */
        @media (max-width: 1024px) {
            .gtm-container {
                padding: 16px;
            }

            .gtm-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: thin;
            }

            .gtm-tabs::-webkit-scrollbar {
                height: 4px;
            }

            .gtm-tabs::-webkit-scrollbar-track {
                background: rgba(0, 0, 0, 0.2);
            }

            .gtm-tabs::-webkit-scrollbar-thumb {
                background: var(--hg-cyan);
                border-radius: 2px;
            }

            .gtm-tab {
                min-width: 120px;
            }

            .gantt-header {
                grid-template-columns: 200px 1fr;
            }

            .gantt-row {
                grid-template-columns: 200px 1fr;
            }

            .gantt-task-label {
                font-size: 12px;
                padding: 6px 8px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 8px;
            }

            .gtm-header {
                padding: 16px;
            }

            .gtm-title {
                font-size: 24px;
            }

            .gtm-subtitle {
                font-size: 13px;
            }

            .gtm-controls {
                flex-direction: column;
                gap: 8px;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .gtm-progress-container {
                width: 100%;
            }

            .gtm-tabs {
                padding: 8px;
                gap: 4px;
            }

            .gtm-tab {
                min-width: 100px;
                padding: 8px 12px;
                font-size: 12px;
            }

            .gtm-content {
                padding: 16px;
            }

            .gtm-phase {
                padding: 16px;
            }

            .gtm-section {
                padding: 12px;
            }

            /* Gantt Charts Mobile */
            .gantt-container {
                margin-top: 16px;
            }

            .gantt-chart {
                padding: 12px;
                overflow-x: scroll;
                -webkit-overflow-scrolling: touch;
            }

            .gantt-header {
                grid-template-columns: 150px 1fr;
                gap: 8px;
                margin-bottom: 12px;
            }

            .gantt-row {
                grid-template-columns: 150px 1fr;
                gap: 8px;
                margin-bottom: 6px;
                min-height: 40px;
            }

            .gantt-task-label {
                font-size: 11px;
                padding: 4px 6px;
            }

            .gantt-timeline {
                min-width: 400px; /* Ensure scrollable width */
            }

            .gantt-month {
                font-size: 10px;
                padding: 6px 4px;
            }

            .gantt-bar {
                height: 28px;
                font-size: 10px;
            }

            .gantt-bar::after {
                font-size: 10px;
                padding: 8px 12px;
                white-space: normal;
                max-width: 200px;
            }

            .gantt-legend {
                flex-direction: column;
                gap: 12px;
                padding: 8px;
            }

            .gantt-legend-item {
                font-size: 11px;
            }

            /* Workshop Grid Mobile */
            .gtm-workshop-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .gtm-workshop-card {
                padding: 16px;
            }

            .gtm-workshop-title {
                font-size: 16px;
            }

            .gtm-metrics-grid {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }

            .gtm-content-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }

        @media (max-width: 480px) {
            .gtm-title {
                font-size: 20px;
            }

            .gtm-subtitle {
                font-size: 12px;
            }

            .gtm-tab {
                min-width: 80px;
                padding: 6px 8px;
                font-size: 11px;
            }

            .gtm-phase-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .gtm-section-title {
                font-size: 16px;
            }

            .gantt-header {
                grid-template-columns: 120px 1fr;
            }

            .gantt-row {
                grid-template-columns: 120px 1fr;
            }

            .gantt-task-label {
                font-size: 10px;
            }

            .gantt-bar {
                height: 24px;
                font-size: 9px;
            }

            .gtm-metrics-grid {
                grid-template-columns: 1fr;
            }

            /* Touch-friendly interactions */
            .gantt-bar,
            .gtm-tab,
            .btn {
                min-height: 44px;
                touch-action: manipulation;
            }
        }

        /* Landscape Mobile */
        @media (max-width: 896px) and (orientation: landscape) {
            .gtm-header {
                padding: 12px 16px;
            }

            .gtm-title {
                font-size: 20px;
            }

            .gtm-controls {
                flex-direction: row;
            }

            .gantt-timeline {
                min-width: 500px;
            }
        }

        /* Print Styles */
        @media print {
            .gtm-controls,
            .gtm-tabs,
            .btn {
                display: none !important;
            }

            .gtm-content {
                display: block !important;
            }

            .gantt-bar::after {
                display: none;
            }

            .gantt-chart {
                break-inside: avoid;
            }
        }

        /* Node Palette for adding nodes */
        .node-palette {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            background: var(--hg-bg-secondary);
            border: 1px solid rgba(97, 216, 254, 0.3);
            border-radius: 12px;
            padding: 12px 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            z-index: 900;
            gap: 8px;
        }

        .node-palette.visible {
            display: flex;
            align-items: center;
        }

        .node-palette-title {
            font-size: 11px;
            color: #6b7280;
            margin-right: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .node-palette-item {
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            border: 1px solid rgba(97, 216, 254, 0.2);
            background: var(--hg-bg-primary);
            color: #9ca3af;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .node-palette-item:hover {
            border-color: var(--hg-cyan);
            color: white;
            background: rgba(97, 216, 254, 0.1);
        }

        .node-palette-item.component { border-left: 3px solid var(--hg-cyan); }
        .node-palette-item.database { border-left: 3px solid var(--hg-green); }
        .node-palette-item.service { border-left: 3px solid var(--hg-blue); }
        .node-palette-item.external { border-left: 3px solid var(--hg-amber); }

        /* ==========================================
           ENHANCED ROADMAP STYLES
           ========================================== */
        .roadmap-milestone {
            position: absolute;
            width: 16px;
            height: 16px;
            background: var(--hg-amber);
            transform: rotate(45deg);
            border: 2px solid var(--hg-bg-secondary);
            z-index: 10;
            cursor: pointer;
        }

        .roadmap-milestone:hover {
            transform: rotate(45deg) scale(1.2);
        }

        .roadmap-milestone-label {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) rotate(-45deg);
            font-size: 10px;
            white-space: nowrap;
            color: var(--hg-amber);
        }

        .roadmap-dependency-line {
            stroke: var(--hg-blue);
            stroke-width: 2;
            fill: none;
            stroke-dasharray: 4 2;
            opacity: 0.6;
        }

        .gantt-item-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: rgba(16, 185, 129, 0.4);
            border-radius: 4px 0 0 4px;
            transition: width 0.3s;
        }

        .roadmap-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .roadmap-filter-btn {
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 11px;
            border: 1px solid rgba(97, 216, 254, 0.2);
            background: transparent;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.2s;
        }

        .roadmap-filter-btn.active,
        .roadmap-filter-btn:hover {
            border-color: var(--hg-cyan);
            color: var(--hg-cyan);
            background: rgba(97, 216, 254, 0.1);
        }

        /* Sprint Task Modal */
        .sprint-task-modal .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .sprint-stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            padding: 16px 20px;
            background: var(--hg-bg-primary);
            border-bottom: 1px solid rgba(97, 216, 254, 0.1);
        }

        .sprint-stat {
            text-align: center;
        }

        .sprint-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--hg-cyan);
        }

        .sprint-stat-label {
            font-size: 11px;
            color: #6b7280;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <!-- Mobile menu button -->
                <button class="mobile-menu-btn" onclick="toggleMobileSidebar()" aria-label="Toggle menu">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
                <img src="https://hmnglue.com/HumnaGlue_logo_white_blue.png" alt="HumanGlue" class="logo-img">
                <div class="logo-title" style="border-left: 1px solid rgba(97, 216, 254, 0.2); padding-left: 12px; margin-left: 4px;">
                    <div style="font-size: 14px; font-weight: 600; color: white;">Project Manager</div>
                    <div style="font-size: 11px; color: #6b7280;">Development Roadmap Tool</div>
                </div>
            </div>
            <div class="header-actions" style="display: flex; align-items: center; gap: 16px;">
                <div class="auto-save-text" style="font-size: 12px; color: #6b7280;">
                    Auto-saved <span id="lastSaved" style="color: var(--hg-cyan);">just now</span>
                </div>
                <button onclick="importNotes()" class="btn btn-secondary" style="padding: 8px 14px; font-size: 13px;">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 6px; vertical-align: -3px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                    </svg>
                    <span class="btn-text">Import</span>
                </button>
                <button onclick="exportNotes()" class="btn btn-secondary" style="padding: 8px 14px; font-size: 13px;">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 6px; vertical-align: -3px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                    </svg>
                    <span class="btn-text">Export</span>
                </button>
                <button onclick="window.open('https://hmnglue.com', '_blank')" class="btn btn-primary" style="padding: 8px 14px; font-size: 13px;">
                    <span class="btn-text">Open Platform</span>
                    <svg class="mobile-only" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="display: none;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                </button>
                <!-- Mobile tasks panel button -->
                <button class="mobile-panel-btn" onclick="toggleRightPanel()" aria-label="Toggle tasks">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Mobile overlay - only closes sidebar, not right panel -->
        <div class="mobile-overlay" id="mobileOverlay" onclick="closeSidebarOnly()"></div>

        <!-- Mobile Bottom Navigation -->
        <nav class="mobile-bottom-nav" id="mobileBottomNav">
            <button class="mobile-nav-item" onclick="toggleMobileSidebar()" id="navMenu">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
                <span class="mobile-nav-label">Menu</span>
            </button>
            <button class="mobile-nav-item active" onclick="showMobileCanvas()" id="navCanvas">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"/>
                </svg>
                <span class="mobile-nav-label">Canvas</span>
            </button>
            <button class="mobile-nav-item" onclick="showMobileTasks()" id="navTasks">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                </svg>
                <span class="mobile-nav-label">Tasks</span>
            </button>
            <button class="mobile-nav-item" onclick="showMobileAI()" id="navAI">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                </svg>
                <span class="mobile-nav-label">AI</span>
            </button>
        </nav>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Collapse Toggle -->
            <button class="collapse-toggle left" onclick="toggleSidebar()" title="Toggle sidebar">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-mini">
                    <div class="stat-mini-value" style="color: var(--hg-green);" id="statCompleted">0</div>
                    <div class="stat-mini-label">Completed</div>
                </div>
                <div class="stat-mini">
                    <div class="stat-mini-value" style="color: var(--hg-amber);" id="statProgress">0</div>
                    <div class="stat-mini-label">In Progress</div>
                </div>
                <div class="stat-mini">
                    <div class="stat-mini-value" style="color: var(--hg-blue);" id="statTodo">0</div>
                    <div class="stat-mini-label">To Do</div>
                </div>
                <div class="stat-mini">
                    <div class="stat-mini-value" style="color: var(--hg-red);" id="statBlocked">0</div>
                    <div class="stat-mini-label">Blocked</div>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Architecture Views</div>
                <button class="nav-item active" onclick="loadDiagram('platform', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                    </svg>
                    Platform Overview
                </button>
                <button class="nav-item" onclick="loadDiagram('roles', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                    </svg>
                    User Roles
                    <span class="nav-item-badge badge-green">6</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('whitelabel', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                    </svg>
                    White-Label
                    <span class="nav-item-badge badge-amber">65%</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('database', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"/>
                    </svg>
                    Database
                </button>
                <button class="nav-item" onclick="loadDiagram('assessment', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                    </svg>
                    Assessment Flow
                </button>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Development</div>
                <button class="nav-item" onclick="loadDiagram('roadmap', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                    </svg>
                    2026 Roadmap
                    <span class="nav-item-badge badge-blue">Q1-Q4</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('sprint', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    Sprint Board
                    <span class="nav-item-badge badge-cyan">Kanban</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('mindmap', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
                    </svg>
                    Mind Map
                    <span class="nav-item-badge badge-green">New</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('blockers', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                    </svg>
                    Blockers
                    <span class="nav-item-badge badge-red">2</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('integrations', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"/>
                    </svg>
                    Integrations
                </button>
                <button class="nav-item" onclick="loadDiagram('gtm', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                    </svg>
                    GTM Strategy
                    <span class="nav-item-badge badge-green">Live</span>
                </button>
                <button class="nav-item" onclick="loadDiagram('b2c-workshops', this)">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                    </svg>
                    B2C Workshops
                    <span class="nav-item-badge badge-amber">Beta</span>
                </button>
            </div>

            <!-- Custom Sections -->
            <div class="nav-section">
                <div class="nav-section-title" style="display: flex; justify-content: space-between; align-items: center;">
                    Custom Views
                    <button onclick="openAddSectionModal()" style="background: none; border: none; cursor: pointer; padding: 2px;" title="Add new section">
                        <svg width="14" height="14" fill="none" stroke="var(--hg-cyan)" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                        </svg>
                    </button>
                </div>
                <div id="customSectionsContainer">
                    <!-- Custom sections will be added here dynamically -->
                </div>
                <button class="nav-item" onclick="openAddSectionModal()" style="color: #6b7280; font-style: italic; font-size: 12px;">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                    </svg>
                    Add custom section...
                </button>
            </div>

            <div class="sidebar-footer">
                <button class="nav-item" onclick="openSettingsModal()">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    Settings
                </button>
                <div style="text-align: center; padding: 12px; font-size: 11px; color: #4b5563;">
                    HumanGlue Project Manager v1.0
                </div>
            </div>
        </aside>

        <!-- Main Canvas -->
        <main class="main-canvas">
            <div id="diagramContainer" class="diagram-container">
                <div class="diagram-wrapper">
                    <div id="mermaidDiagram" class="mermaid"></div>
                </div>
            </div>

            <!-- Diagram Title -->
            <div class="diagram-title-overlay">
                <h2 id="diagramTitle" style="font-size: 20px; font-weight: 700; color: white; margin: 0;">Platform Overview</h2>
                <p id="diagramSubtitle" style="font-size: 12px; color: #6b7280; margin: 4px 0 0 0;">Click nodes to add development notes</p>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="control-btn" onclick="openNoteModal()" title="Add Note">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                    </svg>
                </button>
                <button class="control-btn" onclick="toggleFullscreen()" title="Fullscreen">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"/>
                    </svg>
                </button>
            </div>

            <!-- Canvas Controls -->
            <div class="canvas-controls">
                <button class="control-btn" onclick="zoomIn()" title="Zoom In (Ctrl++)">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"/>
                    </svg>
                </button>
                <button class="control-btn" onclick="zoomOut()" title="Zoom Out (Ctrl+-)">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"/>
                    </svg>
                </button>
                <button class="control-btn" onclick="resetZoom()" title="Reset (Ctrl+0)">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                </button>
                <div class="zoom-display">
                    <span id="zoomLevel">100%</span>
                </div>
                <button class="control-btn" onclick="fitToScreen()" title="Fit to Screen">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"/>
                    </svg>
                </button>
            </div>
        </main>

        <!-- Right Panel -->
        <aside class="right-panel">
            <!-- Collapse Toggle -->
            <button class="collapse-toggle right" onclick="toggleRightPanel()" title="Toggle panel">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
            </button>
            <!-- Collapsed State Icons -->
            <div class="collapsed-icons">
                <button class="collapsed-icon-btn" onclick="toggleRightPanel(); switchTab('notes', document.querySelector('.panel-tab'))" title="Tasks">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                    </svg>
                </button>
                <button class="collapsed-icon-btn" onclick="toggleRightPanel(); switchTab('chat', document.querySelectorAll('.panel-tab')[1])" title="AI Assistant">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
                    </svg>
                </button>
                <button class="collapsed-icon-btn" onclick="openNoteModal()" title="Add Task">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                    </svg>
                </button>
            </div>
            <div class="panel-tabs">
                <button class="panel-tab active" onclick="switchTab('notes', this)">Tasks & Notes</button>
                <button class="panel-tab" onclick="switchTab('chat', this)">AI Assistant</button>
            </div>

            <!-- Notes Panel -->
            <div id="notesPanel" class="panel-content">
                <div class="task-filters">
                    <button class="task-filter active" onclick="filterNotes('all', this)">All</button>
                    <button class="task-filter" onclick="filterNotes('todo', this)">To Do</button>
                    <button class="task-filter" onclick="filterNotes('in-progress', this)">In Progress</button>
                    <button class="task-filter" onclick="filterNotes('completed', this)">Done</button>
                    <button class="task-filter" onclick="filterNotes('blocked', this)">Blocked</button>
                </div>
                <div id="notesList"></div>
                <button class="add-note-btn" onclick="openNoteModal()">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                    </svg>
                    Add Task or Note
                </button>
            </div>

            <!-- Chat Panel -->
            <div id="chatPanel" class="panel-content" style="display: none;">
                <div class="chat-container">
                    <!-- Expert Advisor Selector -->
                    <div id="expertSelector" style="padding: 12px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-subtle);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;">Chat with Expert</span>
                            <span class="nav-item-badge badge-cyan" style="font-size: 9px;">Mind Reasoner</span>
                        </div>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button onclick="selectExpertForChat('ai')" id="expert-btn-ai" class="expert-chip active" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; border: 1px solid var(--hg-cyan); background: rgba(97, 216, 254, 0.1); color: var(--hg-cyan); cursor: pointer; font-size: 12px; transition: all 0.2s;">
                                 AI Assistant
                            </button>
                            <button onclick="selectExpertForChat('steve-jobs')" id="expert-btn-steve-jobs" class="expert-chip" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; border: 1px solid var(--border-subtle); background: var(--bg-tertiary); color: var(--text-secondary); cursor: pointer; font-size: 12px; transition: all 0.2s;">
                                <img src="https://avatars.reasoner.com/public/steve_jobs.png" alt="" style="width:18px;height:18px;border-radius:50%;"> Steve Jobs
                            </button>
                            <button onclick="selectExpertForChat('paul-graham')" id="expert-btn-paul-graham" class="expert-chip" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; border: 1px solid var(--border-subtle); background: var(--bg-tertiary); color: var(--text-secondary); cursor: pointer; font-size: 12px; transition: all 0.2s;">
                                <img src="https://avatars.reasoner.com/public/paul_graham.png" alt="" style="width:18px;height:18px;border-radius:50%;"> Paul Graham
                            </button>
                            <button onclick="selectExpertForChat('jony-ive')" id="expert-btn-jony-ive" class="expert-chip" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; border: 1px solid var(--border-subtle); background: var(--bg-tertiary); color: var(--text-secondary); cursor: pointer; font-size: 12px; transition: all 0.2s;">
                                <img src="https://avatars.reasoner.com/public/jony_ive.png" alt="" style="width:18px;height:18px;border-radius:50%;"> Jony Ive
                            </button>
                            <button onclick="selectExpertForChat('peter-thiel')" id="expert-btn-peter-thiel" class="expert-chip" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; border: 1px solid var(--border-subtle); background: var(--bg-tertiary); color: var(--text-secondary); cursor: pointer; font-size: 12px; transition: all 0.2s;">
                                <img src="https://avatars.reasoner.com/public/peter_thiel.png" alt="" style="width:18px;height:18px;border-radius:50%;"> Peter Thiel
                            </button>
                        </div>
                    </div>
                    <div id="chatMessages" class="chat-messages">
                        <div class="chat-message assistant">
                            <div class="chat-message-bubble">
                                <strong style="color: var(--hg-cyan);"> HumanGlue AI Project Assistant</strong>
                                <br><br>
                                I'm your AI-powered development partner for the HumanGlue platform. I understand the entire codebase, architecture, and roadmap.
                                <br><br>
                                <div class="ai-action-card" style="margin: 8px 0;">
                                    <div class="ai-action-header">
                                        <div class="ai-action-icon info">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                                            </svg>
                                        </div>
                                        <div class="ai-action-title">Quick Actions</div>
                                    </div>
                                    <div class="ai-action-content">
                                        <ul style="margin:0;padding-left:16px;">
                                            <li>Use <strong>hot buttons</strong> below for instant insights</li>
                                            <li>Click <strong>diagram nodes</strong> for component context</li>
                                            <li>Select an <strong>Expert Advisor</strong> above for specialized guidance</li>
                                        </ul>
                                    </div>
                                </div>
                                <p style="font-size:12px;color:#6b7280;margin-top:8px;">Try: "project status", "next steps", or "what's blocking us?"</p>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input-wrapper">
                            <input type="text" id="chatInput" class="chat-input" placeholder="Ask about the project..." onkeypress="if(event.key==='Enter')sendMessage()">
                            <button class="chat-send-btn" onclick="sendMessage()">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- AI Hot Buttons -->
                    <div class="ai-hot-buttons">
                        <button class="ai-hot-btn" onclick="askAI('project status')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
                            Project Status
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('blockers')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                            Blockers
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('next steps')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/></svg>
                            Next Steps
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('database')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/></svg>
                            Database
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('current diagram')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"/></svg>
                            This View
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('tasks')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
                            My Tasks
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('architecture')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
                            Architecture
                        </button>
                        <button class="ai-hot-btn" onclick="askAI('files')">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            Files
                        </button>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Add/Edit Note Modal -->
    <div id="noteModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="noteModalTitle">Add Task</h3>
                <button class="modal-close" onclick="closeNoteModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Title *</label>
                    <input type="text" id="noteTitle" class="form-input" placeholder="e.g., Implement Stripe webhooks">
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="noteDescription" class="form-textarea" placeholder="Describe what needs to be built, changed, or investigated..."></textarea>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select id="noteStatus" class="form-select">
                            <option value="todo">To Do</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="blocked">Blocked</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Priority</label>
                        <select id="notePriority" class="form-select">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Component / Area</label>
                    <select id="noteComponent" class="form-select">
                        <option value="platform">Platform Core</option>
                        <option value="auth">Authentication</option>
                        <option value="admin">Admin Dashboard</option>
                        <option value="assessment">Assessment System</option>
                        <option value="whitelabel">White-Label</option>
                        <option value="payments">Payments</option>
                        <option value="communications">Communications</option>
                        <option value="video">Video Conferencing</option>
                        <option value="lms">Learning Management</option>
                        <option value="experts">Expert Marketplace</option>
                        <option value="analytics">Analytics</option>
                        <option value="mobile">Mobile</option>
                        <option value="discord">Discord Bot</option>
                        <option value="agent">HumanGlue Agent</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Assignee (optional)</label>
                    <input type="text" id="noteAssignee" class="form-input" placeholder="e.g., Alex, Matt">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-danger" id="deleteNoteBtn" onclick="deleteCurrentNote()" style="margin-right: auto; display: none;">Delete</button>
                <button class="btn btn-secondary" onclick="closeNoteModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveNote()">Save</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Settings</h3>
                <button class="modal-close" onclick="closeSettingsModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Project Name</label>
                    <input type="text" id="settingsProjectName" class="form-input" value="HumanGlue Platform">
                </div>
                <div class="form-group">
                    <label class="form-label">Team Members (comma separated)</label>
                    <input type="text" id="settingsTeam" class="form-input" placeholder="Alex, Matt, etc.">
                </div>
                <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid rgba(97, 216, 254, 0.1);">
                    <h4 style="color: white; font-size: 14px; margin-bottom: 12px;">Data Management</h4>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn btn-secondary" onclick="clearAllNotes()">Clear All Tasks</button>
                        <button class="btn btn-secondary" onclick="exportNotes()">Export Data</button>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeSettingsModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Hidden file input for import -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="handleImport(event)">

    <!-- Expert Advisors Modal -->
    <div id="expertsModal" class="modal-overlay">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title"> Expert Advisors - Mind Reasoner</h3>
                <button class="modal-close" onclick="closeExpertsModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p style="color: #9ca3af; margin-bottom: 16px; font-size: 13px;">Consult digital twins of world-class entrepreneurs, designers, and innovators to get insights on your project.</p>
                <div id="expertsGrid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                    <!-- Experts will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Section Modal -->
    <div id="addSectionModal" class="modal-overlay">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title"> Add Custom Section</h3>
                <button class="modal-close" onclick="closeAddSectionModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Section Name *</label>
                    <input type="text" id="newSectionName" class="form-input" placeholder="e.g., API Documentation">
                </div>
                <div class="form-group">
                    <label class="form-label">Section Type</label>
                    <select id="newSectionType" class="form-select">
                        <option value="mermaid">Mermaid Diagram</option>
                        <option value="notes">Notes / Documentation</option>
                        <option value="kanban">Kanban Board</option>
                        <option value="checklist">Checklist</option>
                        <option value="timeline">Timeline</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="newSectionDescription" class="form-input" rows="3" placeholder="What is this section for?"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Icon Color</label>
                    <div style="display: flex; gap: 8px;">
                        <button onclick="setNewSectionColor('cyan')" class="color-btn" style="background: #61D8FE; width: 28px; height: 28px; border-radius: 50%; border: 2px solid transparent;"></button>
                        <button onclick="setNewSectionColor('green')" class="color-btn" style="background: #10B981; width: 28px; height: 28px; border-radius: 50%; border: 2px solid transparent;"></button>
                        <button onclick="setNewSectionColor('blue')" class="color-btn" style="background: #3B82F6; width: 28px; height: 28px; border-radius: 50%; border: 2px solid transparent;"></button>
                        <button onclick="setNewSectionColor('amber')" class="color-btn" style="background: #F59E0B; width: 28px; height: 28px; border-radius: 50%; border: 2px solid transparent;"></button>
                        <button onclick="setNewSectionColor('red')" class="color-btn" style="background: #EF4444; width: 28px; height: 28px; border-radius: 50%; border: 2px solid transparent;"></button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddSectionModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveCustomSection()">Create Section</button>
            </div>
        </div>
    </div>

    <!-- Expert Consultation Modal -->
    <div id="expertConsultModal" class="modal-overlay">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <img id="expertConsultAvatar" src="" alt="" style="width: 40px; height: 40px; border-radius: 50%;">
                    <div>
                        <h3 class="modal-title" id="expertConsultName" style="margin: 0;">Expert Name</h3>
                        <span style="font-size: 11px; color: #9ca3af;">Mind Reasoner Digital Twin</span>
                    </div>
                </div>
                <button class="modal-close" onclick="closeExpertConsultModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div id="expertConversation" style="max-height: 300px; overflow-y: auto; margin-bottom: 16px; padding: 12px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <!-- Conversation history will appear here -->
                </div>
                <div class="form-group">
                    <label class="form-label">Ask about your project:</label>
                    <textarea id="expertQuery" class="form-input" rows="3" placeholder="e.g., What do you think about our approach to the white-label system?"></textarea>
                </div>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 12px;">
                    <button class="btn btn-secondary" style="font-size: 11px; padding: 6px 12px;" onclick="askExpertQuickQuestion('product design')"> Product Design</button>
                    <button class="btn btn-secondary" style="font-size: 11px; padding: 6px 12px;" onclick="askExpertQuickQuestion('prioritization')"> Prioritization</button>
                    <button class="btn btn-secondary" style="font-size: 11px; padding: 6px 12px;" onclick="askExpertQuickQuestion('market fit')"> Market Fit</button>
                    <button class="btn btn-secondary" style="font-size: 11px; padding: 6px 12px;" onclick="askExpertQuickQuestion('team building')"> Team</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeExpertConsultModal()">Close</button>
                <button class="btn btn-primary" onclick="sendExpertQuery()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 4px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    Ask Expert
                </button>
            </div>
        </div>
    </div>

    <!-- Roadmap Item Modal -->
    <div id="roadmapModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="roadmapModalTitle">Add Timeline Item</h3>
                <button class="modal-close" onclick="closeRoadmapModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Feature Name *</label>
                    <input type="text" id="roadmapTitle" class="form-input" placeholder="e.g., Stripe Integration">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label class="form-label">Quarter</label>
                        <select id="roadmapQuarter" class="form-select">
                            <option value="Q1 2026">Q1 2026</option>
                            <option value="Q2 2026">Q2 2026</option>
                            <option value="Q3 2026">Q3 2026</option>
                            <option value="Q4 2026">Q4 2026</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Duration (days)</label>
                        <input type="number" id="roadmapDuration" class="form-input" value="30" min="1" max="365">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" id="roadmapStartDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select id="roadmapStatus" class="form-select">
                            <option value="planned">Planned</option>
                            <option value="active">Active</option>
                            <option value="done">Done</option>
                            <option value="blocked">Blocked</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="roadmapDescription" class="form-textarea" placeholder="What does this feature include?"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Dependencies (optional)</label>
                    <input type="text" id="roadmapDependencies" class="form-input" placeholder="e.g., Stripe account, Zoom API access">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-danger" id="deleteRoadmapBtn" onclick="deleteRoadmapItem()" style="margin-right: auto; display: none;">Delete</button>
                <button class="btn btn-secondary" onclick="closeRoadmapModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveRoadmapItem()">Save</button>
            </div>
        </div>
    </div>

    <!-- AI Context Tooltip -->
    <div id="aiTooltip" class="ai-tooltip">
        <div class="ai-tooltip-header">
            <div class="ai-tooltip-icon">
                <svg width="18" height="18" fill="none" stroke="white" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                </svg>
            </div>
            <div>
                <div class="ai-tooltip-title" id="aiTooltipTitle">Component Name</div>
                <div class="ai-context-badge">AI Context</div>
            </div>
        </div>
        <div class="ai-tooltip-content" id="aiTooltipContent">
            Loading context...
        </div>
        <div class="ai-tooltip-actions">
            <button class="ai-tooltip-btn ai-tooltip-btn-primary" onclick="askAIAboutNode()">Ask AI</button>
            <button class="ai-tooltip-btn ai-tooltip-btn-secondary" onclick="addTaskFromNode()">Add Task</button>
            <button class="ai-tooltip-btn ai-tooltip-btn-secondary" onclick="hideAITooltip()">Close</button>
        </div>
    </div>

    <script>
        // Initialize Mermaid with comprehensive theming
        mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            securityLevel: 'loose',
            suppressErrorRendering: false,
            themeVariables: {
                // Core colors
                primaryColor: '#1e293b',
                primaryTextColor: '#e5e7eb',
                primaryBorderColor: '#61D8FE',
                lineColor: '#61D8FE',
                secondaryColor: '#12121a',
                tertiaryColor: '#0f0f16',
                background: '#0a0a0f',
                mainBkg: '#1e293b',
                nodeBorder: '#61D8FE',
                clusterBkg: '#12121a',
                clusterBorder: '#3B82F6',
                titleColor: '#61D8FE',
                edgeLabelBackground: '#12121a',

                // Sequence diagram specific
                actorBkg: '#1e293b',
                actorBorder: '#61D8FE',
                actorTextColor: '#e5e7eb',
                actorLineColor: '#61D8FE',
                signalColor: '#61D8FE',
                signalTextColor: '#e5e7eb',
                sequenceNumberColor: '#e5e7eb',
                noteBkgColor: '#12121a',
                noteBorderColor: '#3B82F6',
                noteTextColor: '#e5e7eb',
                activationBkgColor: '#1e293b',
                activationBorderColor: '#61D8FE',

                // ER diagram specific
                entityTitleBackground: '#1e293b',
                entityBkg: '#12121a',
                entityBorder: '#61D8FE',
                labelColor: '#e5e7eb',
                attributeBackgroundColorOdd: '#12121a',
                attributeBackgroundColorEven: '#1e293b',

                // Gantt specific
                sectionBkgColor: '#12121a',
                sectionBkgColor2: '#1e293b',
                altSectionBkgColor: '#12121a',
                gridColor: '#374151',
                doneTaskBkgColor: '#10B981',
                doneTaskBorderColor: '#10B981',
                activeTaskBkgColor: '#F59E0B',
                activeTaskBorderColor: '#F59E0B',
                taskBkgColor: '#61D8FE',
                taskBorderColor: '#61D8FE',
                taskTextColor: '#0a0a0f',
                taskTextDarkColor: '#0a0a0f',
                taskTextOutsideColor: '#e5e7eb',
                todayLineColor: '#EF4444',
                critBkgColor: '#EF4444',
                critBorderColor: '#EF4444'
            },
            flowchart: {
                curve: 'basis',
                padding: 20,
                htmlLabels: true,
                useMaxWidth: false
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 80,
                width: 200,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: false,
                useMaxWidth: false,
                rightAngles: false,
                showSequenceNumbers: false
            },
            er: {
                useMaxWidth: false,
                entityPadding: 15,
                layoutDirection: 'TB'
            },
            gantt: {
                titleTopMargin: 25,
                barHeight: 25,
                barGap: 6,
                topPadding: 75,
                leftPadding: 150,
                gridLineStartPadding: 35,
                fontSize: 12,
                sectionFontSize: 13,
                numberSectionStyles: 4,
                axisFormat: '%b %d',
                useMaxWidth: false
            }
        });

        // Supabase Configuration - injected at build time from environment variables
        const SUPABASE_URL = '__SUPABASE_URL__';
        const SUPABASE_ANON_KEY = '__SUPABASE_ANON_KEY__';

        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // State
        let panzoomInstance = null;
        let currentDiagram = 'platform';
        let currentFilter = 'all';
        let notes = []; // Will be loaded from Supabase
        let roadmapItems = []; // Interactive timeline items from Supabase
        let settings = JSON.parse(localStorage.getItem('hg_pm_settings') || '{"projectName": "HumanGlue Platform", "team": ""}');
        let editingNoteId = null; // UUID for editing
        let editingRoadmapId = null; // UUID for roadmap item editing
        let editingSprintTaskId = null; // UUID for sprint task editing
        let realtimeSubscription = null;
        let aiConversationHistory = []; // For contextual AI conversations
        let hoveredNode = null; // For AI tooltips
        let draggedCard = null; // For Kanban drag-drop

        // Sprint Tasks Data
        let sprintTasks = [
            { id: '1', title: 'White-Label Audit', description: 'Complete comprehensive audit of hex color values', status: 'progress', type: 'feature', points: 5, assignee: 'MS' },
            { id: '2', title: 'Discord Bot Setup', description: 'Configure discord.js bot with slash commands', status: 'progress', type: 'feature', points: 8, assignee: 'MS' },
            { id: '3', title: 'HumanGlue Agent Service', description: 'Build Express backend for MCP integration', status: 'progress', type: 'feature', points: 13, assignee: 'MS' },
            { id: '4', title: 'Branding Settings UI', description: 'Admin panel for org branding configuration', status: 'progress', type: 'enhancement', points: 5, assignee: 'MS' },
            { id: '5', title: 'Dashboard Components', description: 'Convert remaining 35 dashboard components to white-label', status: 'todo', type: 'feature', points: 8, assignee: '' },
            { id: '6', title: 'PDF Template Theming', description: 'Apply branding to PDF report templates', status: 'todo', type: 'enhancement', points: 5, assignee: '' },
            { id: '7', title: 'MindReasoner Integration', description: 'Connect personality analysis to Discord bot', status: 'todo', type: 'feature', points: 8, assignee: '' },
            { id: '8', title: 'Docker Deployment', description: 'Containerize services for DigitalOcean', status: 'todo', type: 'enhancement', points: 3, assignee: '' },
            { id: '9', title: 'Color Picker UI', description: 'Build visual color picker for admin settings', status: 'backlog', type: 'design', points: 3, assignee: '' },
            { id: '10', title: 'Logo Upload', description: 'Implement logo upload with S3 storage', status: 'backlog', type: 'feature', points: 5, assignee: '' },
            { id: '11', title: 'Hex colors conversion (22478)', description: 'Converted hardcoded hex values', status: 'done', type: 'enhancement', points: 5, assignee: 'MS' },
            { id: '12', title: 'Footer white-label', description: 'Footer component now uses BrandingContext', status: 'done', type: 'feature', points: 2, assignee: 'MS' },
            { id: '13', title: 'Login page white-label', description: 'Login/signup pages themed', status: 'done', type: 'feature', points: 3, assignee: 'MS' },
            { id: '14', title: 'Org page nav fix', description: 'Fixed navigation in organization pages', status: 'done', type: 'bug', points: 1, assignee: 'MS' },
            { id: '15', title: 'Architecture documentation', description: 'Created comprehensive system docs', status: 'done', type: 'docs', points: 3, assignee: 'MS' }
        ];

        // Mind Map Nodes Data
        let mindMapNodes = [
            { id: 'root', label: 'HumanGlue Platform', x: 400, y: 300, children: ['assessment', 'admin', 'client', 'integrations'], expanded: true, color: '#61D8FE',
              why: 'Central hub for AI maturity assessment - our core product offering', priority: 'critical', prunable: false },
            { id: 'assessment', label: 'Assessment Engine', x: 200, y: 150, children: ['vapi', 'scoring', 'reports'], expanded: true, color: '#10B981',
              why: 'REVENUE DRIVER: Core product that differentiates us from competitors', priority: 'critical', prunable: false },
            { id: 'vapi', label: 'VAPI Voice AI', x: 80, y: 80, children: [], expanded: false, color: '#F59E0B',
              why: 'Unique voice-based assessment experience, key differentiator', priority: 'high', prunable: false },
            { id: 'scoring', label: 'Scoring Algorithm', x: 200, y: 50, children: [], expanded: false, color: '#10B981',
              why: 'Proprietary LVNG framework scoring - our IP', priority: 'critical', prunable: false },
            { id: 'reports', label: 'PDF Reports', x: 320, y: 80, children: [], expanded: false, color: '#3B82F6',
              why: 'Deliverable for clients, justifies assessment pricing', priority: 'high', prunable: false },
            { id: 'admin', label: 'Admin Console', x: 600, y: 150, children: ['users', 'content', 'analytics'], expanded: true, color: '#3B82F6',
              why: 'Management interface for platform operators', priority: 'medium', prunable: false },
            { id: 'users', label: 'User Management', x: 520, y: 80, children: [], expanded: false, color: '#3B82F6',
              why: 'Essential for multi-tenant white-label system', priority: 'high', prunable: false },
            { id: 'content', label: 'Content CMS', x: 640, y: 50, children: [], expanded: false, color: '#3B82F6',
              why: 'Allows partners to customize content - CONSIDER: Could use external CMS?', priority: 'medium', prunable: true },
            { id: 'analytics', label: 'Analytics', x: 720, y: 80, children: [], expanded: false, color: '#3B82F6',
              why: 'CONSIDER: Phase 2 feature? Could defer to Q3', priority: 'low', prunable: true },
            { id: 'client', label: 'Client Portal', x: 200, y: 450, children: ['results', 'workshops', 'courses'], expanded: true, color: '#3B82F6',
              why: 'Client-facing dashboard for assessment results and learning', priority: 'high', prunable: false },
            { id: 'results', label: 'Assessment Results', x: 80, y: 520, children: [], expanded: false, color: '#10B981',
              why: 'Core client value - shows their AI maturity scores', priority: 'critical', prunable: false },
            { id: 'workshops', label: 'Workshops', x: 200, y: 550, children: [], expanded: false, color: '#F59E0B',
              why: 'REVENUE STREAM: Upsell from assessment, defer if needed', priority: 'medium', prunable: true },
            { id: 'courses', label: 'Learning', x: 320, y: 520, children: [], expanded: false, color: '#EC4899',
              why: 'FUTURE SCOPE: Consider for v2.0, not essential for MVP', priority: 'low', prunable: true },
            { id: 'integrations', label: 'Integrations', x: 600, y: 450, children: ['stripe', 'zoom', 'resend'], expanded: true, color: '#F59E0B',
              why: 'Third-party services to extend platform capabilities', priority: 'medium', prunable: false },
            { id: 'stripe', label: 'Stripe', x: 520, y: 520, children: [], expanded: false, color: '#6366F1', status: 'blocked',
              why: 'CRITICAL: Required for paid subscriptions. Blocked on setup', priority: 'critical', prunable: false },
            { id: 'zoom', label: 'Zoom', x: 640, y: 550, children: [], expanded: false, color: '#0EA5E9', status: 'blocked',
              why: 'DEFER: Can use manual scheduling initially. Phase 2', priority: 'low', prunable: true },
            { id: 'resend', label: 'Resend Email', x: 720, y: 520, children: [], expanded: false, color: '#10B981', status: 'active',
              why: 'ACTIVE: Transactional emails working. Essential', priority: 'high', prunable: false }
        ];

        // Track drag state for mind map nodes
        let mindMapDragState = { isDragging: false, nodeId: null, offsetX: 0, offsetY: 0 };

        // Diagram definitions (comprehensive)
        const diagrams = {
            platform: {
                title: 'Platform Overview',
                subtitle: 'Core architecture and data flow - click nodes to add notes',
                code: `
flowchart TB
    subgraph Client["Client Layer"]
        Browser["Browser/PWA"]
        Mobile["Mobile App (Future)"]
    end

    subgraph Frontend["Frontend - Next.js 14"]
        AppRouter["App Router"]
        Pages["Pages & Layouts"]
        Components["Component Library"]
        Contexts["Context Providers"]
    end

    subgraph Backend["Backend Services"]
        API["API Routes"]
        Auth["Auth Service"]
        Email["Resend Email"]
        SMS["Twilio SMS"]
        Voice["VAPI Voice AI"]
    end

    subgraph Database["Supabase"]
        PG[("PostgreSQL")]
        Storage["File Storage"]
        RLS["Row Level Security"]
    end

    subgraph External["External Integrations"]
        Stripe["Stripe Payments"]
        Zoom["Zoom Video"]
        Neo4j["Neo4j Graph"]
    end

    Browser --> AppRouter
    Mobile -.-> AppRouter
    AppRouter --> Pages
    Pages --> Components
    Components --> Contexts
    Contexts --> API
    API --> Auth
    API --> Email
    API --> SMS
    API --> Voice
    Auth --> PG
    API --> PG
    API --> Storage
    PG --> RLS
    API -.-> Stripe
    API -.-> Zoom
    Voice --> Neo4j

    style Browser fill:#1e293b,stroke:#61D8FE,stroke-width:2px
    style Mobile fill:#1e293b,stroke:#3B82F6,stroke-dasharray:5 5
    style AppRouter fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style PG fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Voice fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style Stripe fill:#1e293b,stroke:#EF4444,stroke-dasharray:5 5
    style Zoom fill:#1e293b,stroke:#EF4444,stroke-dasharray:5 5
`
            },
            roles: {
                title: 'User Roles & Permissions',
                subtitle: '6 distinct roles with hierarchical permissions',
                code: `
flowchart TB
    subgraph Hierarchy["Role Hierarchy"]
        SA["Super Admin (Full)"]
        SAC["Super Admin (Courses)"]
        Admin["Platform Admin"]
        Instructor["Instructor"]
        Expert["Expert"]
        Client["Client"]
    end

    subgraph SuperCaps["Super Admin Capabilities"]
        AllOrgs["Manage All Orgs"]
        AllUsers["Manage All Users"]
        SystemSettings["System Settings"]
        Billing["Billing Access"]
        WhiteLabel["White-Label Config"]
    end

    subgraph AdminCaps["Admin Capabilities"]
        OrgUsers["Org User Mgmt"]
        Content["Content Mgmt"]
        Reports["Reports"]
        Workshops["Workshops"]
        Courses["Courses"]
    end

    subgraph InstructorCaps["Instructor Capabilities"]
        Teach["Teach Courses"]
        Lessons["Create Lessons"]
        Students["View Students"]
        InstAnalytics["Analytics"]
    end

    subgraph ExpertCaps["Expert Capabilities"]
        Consult["Consultations"]
        Avail["Availability"]
        Earnings["Earnings"]
        Profile["Profile"]
    end

    subgraph ClientCaps["Client Capabilities"]
        Assess["Assessments"]
        Results["Results"]
        Book["Book Workshops"]
        Learn["Courses"]
        Hire["Hire Experts"]
    end

    SA --> SuperCaps
    SA --> AdminCaps
    SAC --> Courses
    Admin --> AdminCaps
    Instructor --> InstructorCaps
    Expert --> ExpertCaps
    Client --> ClientCaps

    style SA fill:#1e293b,stroke:#10B981,stroke-width:2px
    style SAC fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Admin fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style Instructor fill:#1e293b,stroke:#61D8FE,stroke-width:2px
    style Expert fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style Client fill:#1e293b,stroke:#3B82F6,stroke-width:2px
`
            },
            whitelabel: {
                title: 'White-Label System',
                subtitle: 'Organization branding customization flow',
                code: `
flowchart TB
    subgraph Entry["User Entry"]
        Login["User Login"]
    end

    subgraph Context["BrandingContext"]
        Init["Initialize Context"]
        Defaults["Load HumanGlue Defaults"]
        Override["Override with Org Branding"]
    end

    subgraph API["API Layer"]
        BrandingAPI["GET /api/organizations/:id/branding"]
        Query["SELECT FROM org_branding"]
    end

    subgraph DB["Supabase Database"]
        OrgBranding[("org_branding")]
        Config["company_name, logo, colors"]
    end

    subgraph Components["Branded Components"]
        FooterC["Footer"]
        LoginC["Login Page"]
        Charts["Charts"]
        Emails["Email Templates"]
        PDFs["PDF Reports"]
    end

    Login --> Init
    Init --> Defaults
    Defaults --> BrandingAPI
    BrandingAPI --> Query
    Query --> OrgBranding
    OrgBranding --> Config
    Config --> Override
    Override --> FooterC
    Override --> LoginC
    Override --> Charts
    Override --> Emails
    Override --> PDFs

    style Login fill:#1e293b,stroke:#61D8FE,stroke-width:2px
    style Override fill:#1e293b,stroke:#10B981,stroke-width:2px
    style OrgBranding fill:#1e293b,stroke:#3B82F6,stroke-width:2px
`
            },
            database: {
                title: 'Database Schema',
                subtitle: 'Core Supabase PostgreSQL tables and relationships',
                code: `
flowchart TB
    subgraph Core["Core Tables"]
        Orgs["organizations<br/>id, name, slug, tier"]
        Users["users<br/>id, email, full_name, org_id"]
        Roles["user_roles<br/>id, user_id, role"]
    end

    subgraph Branding["White-Label"]
        OrgBrand["org_branding<br/>company_name, logo, colors"]
    end

    subgraph Assessment["Assessment System"]
        Assess["assessments<br/>id, user_id, responses, score"]
        Responses["assessment_responses<br/>question_id, answer, metadata"]
    end

    subgraph Learning["Learning Platform"]
        Courses["courses<br/>title, instructor_id, price"]
        Workshops["workshops<br/>title, date, max_participants"]
        CourseEnroll["course_enrollments<br/>user_id, course_id"]
        WorkshopEnroll["workshop_enrollments<br/>user_id, workshop_id"]
    end

    subgraph Experts["Expert Network"]
        ExpertProf["experts<br/>specialties, hourly_rate"]
        Consults["consultations<br/>expert_id, client_id"]
    end

    Orgs --> Users
    Orgs --> OrgBrand
    Users --> Roles
    Users --> Assess
    Assess --> Responses
    Users --> CourseEnroll
    Users --> WorkshopEnroll
    Courses --> CourseEnroll
    Workshops --> WorkshopEnroll
    Users --> ExpertProf
    ExpertProf --> Consults

    style Orgs fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Users fill:#1e293b,stroke:#61D8FE,stroke-width:2px
    style Assess fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style Courses fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style ExpertProf fill:#1e293b,stroke:#EF4444,stroke-width:2px
`
            },
            assessment: {
                title: 'AI Assessment Flow',
                subtitle: 'VAPI voice-powered maturity assessment system',
                code: `
flowchart TB
    subgraph Entry["Entry Points"]
        Chat["Chat Widget"]
        Direct["Direct Link"]
        CTA["CTA Button"]
    end

    subgraph Assessment["Assessment Process"]
        VAPI["VAPI Voice AI"]
        Questions["Dynamic Questions"]
        Analysis["Response Analysis"]
        Scoring["Maturity Scoring 0-10"]
    end

    subgraph Results["Results & Actions"]
        Report["PDF Report"]
        Dashboard["Results Dashboard"]
        Recs["AI Recommendations"]
        Solutions["Solution Matching"]
    end

    subgraph Storage["Data Storage"]
        Responses["assessment_responses"]
        UsersDB["users table"]
        OrgsDB["organizations table"]
    end

    subgraph Follow["Follow-up Actions"]
        Email["Email Summary"]
        Workshop["Workshop Invite"]
        Expert["Expert Match"]
    end

    Chat --> VAPI
    Direct --> VAPI
    CTA --> VAPI
    VAPI --> Questions
    Questions --> Analysis
    Analysis --> Scoring
    Scoring --> Report
    Scoring --> Dashboard
    Scoring --> Recs
    Recs --> Solutions
    Scoring --> Responses
    Responses --> UsersDB
    UsersDB --> OrgsDB
    Report --> Email
    Solutions --> Workshop
    Solutions --> Expert

    style VAPI fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style Scoring fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Report fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style Email fill:#1e293b,stroke:#61D8FE,stroke-width:2px
`
            },
            roadmap: {
                title: '2026 Feature Roadmap',
                subtitle: 'Interactive timeline - click items to edit, use + to add new items',
                type: 'interactive-gantt', // Special flag for interactive rendering
                code: `
gantt
    title HumanGlue Development Roadmap 2026
    dateFormat YYYY-MM
    section Q1 2026
        Payment System           :active, pay, 2026-01, 90d
        Stripe Integration       :pay1, 2026-01, 30d
        Subscription Billing     :pay2, after pay1, 30d
        Expert Payouts          :pay3, after pay2, 30d
        Video Conferencing      :vid, 2026-01, 90d
        Zoom Integration        :vid1, 2026-01, 45d
        Workshop Rooms          :vid2, after vid1, 45d
    section Q2 2026
        Advanced LMS            :lms, 2026-04, 90d
        Course Builder          :lms1, 2026-04, 45d
        Progress Tracking       :lms2, after lms1, 25d
        Certificates            :lms3, after lms2, 20d
        Expert Marketplace      :exp, 2026-04, 90d
        Profile Pages           :exp1, 2026-04, 30d
        Booking System          :exp2, after exp1, 45d
        Reviews                 :exp3, after exp2, 15d
    section Q3 2026
        Advanced Analytics      :ana, 2026-07, 90d
        AI Insights Dashboard   :ana1, 2026-07, 45d
        Custom Report Builder   :ana2, after ana1, 30d
        ROI Tracking            :ana3, after ana2, 15d
    section Q4 2026
        Mobile Experience       :mob, 2026-10, 90d
        PWA Optimization        :mob1, 2026-10, 30d
        Push Notifications      :mob2, after mob1, 30d
        Native Apps             :mob3, after mob2, 30d
`
            },
            sprint: {
                title: 'Current Sprint',
                subtitle: 'Sprint 12  Dec 2-15, 2025  Drag cards to update status',
                type: 'kanban', // Special flag for Kanban board rendering
                code: '' // Not used for Kanban
            },
            mindmap: {
                title: 'Platform Mind Map',
                subtitle: 'Interactive system visualization - click nodes to expand, drag to reorganize',
                type: 'mindmap', // Special flag for mind map rendering
                code: ''
            },
            blockers: {
                title: 'Blockers & Risks',
                subtitle: 'Issues requiring resolution before progress',
                code: `
flowchart TB
    subgraph Blockers["Current Blockers"]
        B1["Zoom API Access"]
        B2["Stripe Account Setup"]
    end

    subgraph Impact["Blocked Features"]
        I1["Video Conferencing"]
        I2["Workshop Rooms"]
        I3["Expert Calls"]
        I4["Payment Processing"]
        I5["Subscriptions"]
        I6["Expert Payouts"]
    end

    subgraph Resolution["Resolution Steps"]
        R1["Apply for Zoom Marketplace"]
        R2["Complete business verification"]
        R3["Submit KYC documents"]
        R4["Configure webhook endpoints"]
    end

    subgraph Timeline["Expected Timeline"]
        T1["Zoom: 2-4 weeks"]
        T2["Stripe: 1-2 weeks"]
    end

    B1 --> I1 & I2 & I3
    B2 --> I4 & I5 & I6

    B1 --> R1 --> R2 --> T1
    B2 --> R3 --> R4 --> T2

    style B1 fill:#7f1d1d,stroke:#EF4444,stroke-width:2px
    style B2 fill:#7f1d1d,stroke:#EF4444,stroke-width:2px
    style I1 fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style I2 fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style I3 fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style I4 fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style I5 fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style I6 fill:#1e293b,stroke:#F59E0B,stroke-width:2px
`
            },
            integrations: {
                title: 'Third-Party Integrations',
                subtitle: 'External services and their status',
                code: `
flowchart TB
    subgraph Active["Active Integrations"]
        Supabase["Supabase - Database & Auth"]
        Resend["Resend - Email"]
        Twilio["Twilio - SMS"]
        VAPI["VAPI - Voice AI"]
        Netlify["Netlify - Hosting"]
    end

    subgraph InProgress["In Progress"]
        Neo4j["Neo4j - Knowledge Graph"]
        Discord["Discord - Bot"]
        MindReasoner["MindReasoner - AI Simulation"]
    end

    subgraph Planned["Planned"]
        Stripe["Stripe - Payments"]
        Zoom["Zoom - Video"]
        Calendly["Calendly - Scheduling"]
        Analytics["Mixpanel - Analytics"]
    end

    subgraph Platform["HumanGlue Platform"]
        Core["Core Application"]
    end

    Active --> Core
    InProgress -.-> Core
    Planned -.-> Core

    style Supabase fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Resend fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Twilio fill:#1e293b,stroke:#10B981,stroke-width:2px
    style VAPI fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Netlify fill:#1e293b,stroke:#10B981,stroke-width:2px
    style Neo4j fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style Discord fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style MindReasoner fill:#1e293b,stroke:#F59E0B,stroke-width:2px
    style Stripe fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style Zoom fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style Calendly fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style Analytics fill:#1e293b,stroke:#3B82F6,stroke-width:2px
    style Core fill:#1e293b,stroke:#61D8FE,stroke-width:3px
`
            },
            gtm: {
                title: 'Go-To-Market Strategy',
                subtitle: 'Interactive GTM execution plan - click sections to edit (collaborative)',
                type: 'interactive-gtm',
                code: '' // Handled by custom renderer
            },
            'b2c-workshops': {
                title: 'B2C Workshops',
                subtitle: 'Online workshops for practicing HumanGlue components with B2C audience',
                type: 'interactive-b2c-workshops',
                code: '' // Handled by custom renderer
            }
        };

        // AI Knowledge Base
        const aiKnowledge = {
            'gtm': `**Go-To-Market Strategy Overview**

Our GTM strategy follows the "Analog to Automated" framework, targeting companies at different AI maturity levels (0-10 scale) with tailored solutions.

**Immediate Action: Workshops**
- Web Workshops: $2,500-$5,000 (3 hours, up to 50 people)
- In-Person: $10,000-$15,000 (full day, 10-50 people)
- Can launch THIS WEEK to generate immediate revenue

**90-Day Execution Plan:**
- Phase 1 (M1-M3): Foundation - White-glove consulting, workshops, case studies
  Goal: 50 assessments, 10 engagements, $75K
- Phase 2 (M4-M8): Scale - Course library, templates, group workshops
  Goal: 200 enrollments, 30 workshops, $150K
- Phase 3 (M9-M12): Automation - SaaS platform, AI engine, enterprise API
  Goal: 100 subscribers, 70% self-serve, $250K MRR

**Target Customers by Maturity:**
- 0-2 (Analog): White-glove consulting $5-15K
- 3-4 (Exploring): Workshops + experts $3-8K
- 5-6 (Implementing): Courses + templates $2-5K
- 7-8 (Scaling): Self-service platform $500-2K/mo
- 9-10 (Automated): Enterprise + API $5-20K/mo`,

            'workshops': `**Workshop Implementation Guide**

**Web Workshop Setup (This Week):**
1. Day 1-2: Finalize deck, create registration page, draft outreach
2. Day 3-4: Send 15 personalized emails, post on LinkedIn, set up Zoom
3. Day 5-7: Follow up leads, confirm first booking
Goal: 1 workshop booked

**Web Workshop Structure (3 hours):**
- Part 1: Foundation (60m) - 5-stage model, interactive assessment
- Part 2: Implementation (60m) - Common mistakes, 30-day wins, ROI framework
- Part 3: Action Planning (60m) - Case studies, Q&A, personalized roadmap

**In-Person Workshop (Full Day):**
Morning: Assessment, process mapping, tool setup, use case development
Afternoon: Team exercises, build first workflow, 90-day roadmap
Includes: Materials, 30-day support, travel expenses

**Target Audience:**
- CTOs/VPs tired of AI experiments going nowhere
- Teams beyond ChatGPT but unsure what's next
- Leaders needing to prove AI ROI`,

            'maturity': `**AI Maturity Model (0-10 Scale)**

**Stage 1: ANALOG (0-2)** 
- Manual processes, no AI adoption
- Solution: White-glove consulting $5-15K
- Focus: Quick wins, basic automation

**Stage 2: EXPLORING (3-4)** 
- Experimenting with ChatGPT, scattered tools
- Solution: Workshops + expert guidance $3-8K
- Focus: Strategy alignment, tool selection

**Stage 3: IMPLEMENTING (5-6)** 
- Active AI projects, some success
- Solution: Courses + templates $2-5K
- Focus: Best practices, scaling what works

**Stage 4: SCALING (7-8)** 
- Multiple AI systems, measuring ROI
- Solution: Self-service platform $500-2K/mo
- Focus: Optimization, advanced features

**Stage 5: AUTOMATED (9-10)** 
- AI-first operations, competitive advantage
- Solution: Enterprise + API $5-20K/mo
- Focus: Innovation, custom integrations

Companies typically increase 2-3 levels in 90 days with proper guidance.`,

            'stripe': `**Stripe Integration Plan**

1. **Account Setup** (Blocker)
   - Business verification required
   - KYC documents needed
   - Timeline: 1-2 weeks

2. **Implementation Steps**
   - Install @stripe/stripe-js
   - Create /api/webhooks/stripe endpoint
   - Set up Products & Prices
   - Implement Checkout Sessions
   - Add Customer Portal

3. **Database Changes**
   - subscriptions table
   - payments table
   - stripe_customers linking

Estimated dev time: 2-3 weeks after account approval`,

            'zoom': `**Zoom Integration Plan**

1. **Marketplace App** (Blocker)
   - Apply at marketplace.zoom.us
   - App review: 2-4 weeks
   - OAuth scopes needed

2. **Features to Implement**
   - Meeting creation API
   - Embedded meeting SDK
   - Webhook handlers
   - Recording access

3. **Use Cases**
   - Workshop video rooms
   - Expert consultation calls
   - Course live sessions

Estimated dev time: 2-3 weeks after approval`,

            'white-label': `**White-Label System Status**

**Completed:**
- BrandingContext provider
- org_branding database table
- Footer component
- Login/Signup pages
- Chart color theming
- Email template variables

**In Progress:**
- Dashboard components (35 remaining)
- PDF report templates

**Architecture:**
\`\`\`
BrandingProvider (layout.tsx)
  -> useBranding() hook
  -> CSS variables override
  -> Component rendering
\`\`\`

Progress: 65% hex colors converted`,

            'assessment': `**AI Assessment System**

**Status:** Fully Implemented

**Flow:**
1. Entry via chat widget or direct link
2. VAPI voice conversation
3. Dynamic question branching
4. Real-time analysis
5. Maturity score (0-10)
6. PDF report generation
7. AI recommendations

**Technologies:**
- VAPI for voice AI
- Claude for analysis
- React-PDF for reports
- Supabase for storage

**Data Tables:**
- assessment_responses
- assessments
- users`,

            'database': `**Supabase Database**

**Core Tables:**
- organizations (multi-tenant)
- users (profiles)
- user_roles (RBAC)
- org_branding (white-label)
- assessments
- assessment_responses
- workshops
- courses
- experts

**Security:**
- RLS on all tables
- Service role for admin APIs
- Anon role for public data

**Connection:**
\`\`\`env
NEXT_PUBLIC_SUPABASE_URL
NEXT_PUBLIC_SUPABASE_ANON_KEY
SUPABASE_SERVICE_ROLE_KEY
\`\`\``,

            'roles': `**User Role System**

**6 Roles:**
1. **super_admin_full** - Everything
2. **super_admin_courses** - Course management only
3. **admin** - Organization management
4. **instructor** - Teaching features
5. **expert** - Consultation features
6. **client** - End user features

**Implementation:**
- user_roles table
- Middleware protection
- Component-level guards
- API route validation

**Demo Accounts:**
All roles have demo accounts for testing`,

            'discord': `**Discord Bot Development**

**Status:** In Progress

**Architecture:**
- discord.js v14
- Express backend
- Neo4j knowledge graph
- MindReasoner integration

**Features Planned:**
- Community Q&A
- Assessment initiation
- Workshop notifications
- Expert matching

**Deployment:**
- Docker container
- DigitalOcean hosting
- Kubernetes ready`,

            'prd': `**HumanGlue Platform - Product Requirements Document**

**Vision:** AI-Powered Maturity Assessment & Transformation Platform

**Mission:** Help organizations measure, understand, and improve their AI readiness through expert-guided assessments, actionable insights, and continuous learning.

---

**CORE MODULES:**

**1. AI Maturity Assessment (Complete)**
- Voice-driven assessment via VAPI
- Dynamic question branching (40+ questions)
- Real-time scoring (0-10 scale)
- PDF report generation
- Personalized recommendations

**2. White-Label System (65% Complete)**
- Custom branding per organization
- Logo, colors, typography override
- Custom email templates
- Co-branded reports
- Subdomain support (future)

**3. Expert Marketplace (Planned Q2 2026)**
- Expert profiles & ratings
- Booking system
- Video consultations
- Payment splits

**4. Learning Management (Planned Q2 2026)**
- Course builder
- Progress tracking
- Certificates
- Live workshops

**5. Analytics Dashboard (Planned Q3 2026)**
- Organization trends
- Industry benchmarks
- ROI tracking
- Custom reports

---

**USER PERSONAS:**
- **CTO/CIO** - Strategic AI adoption
- **HR Leader** - Workforce readiness
- **CFO** - ROI & investment planning
- **Team Leads** - Skill gap analysis

---

**SUCCESS METRICS:**
- 1000 assessments/month
- 85% completion rate
- 4.5+ star rating
- 50% conversion to workshops`,

            'milestones': `**Project Milestones 2025-2026**

**COMPLETED **
- [Dec 2024] Core platform launch
- [Dec 2024] Assessment engine v1
- [Dec 2024] Multi-tenant architecture
- [Dec 2024] 6-role permission system
- [Dec 2024] White-label foundation

**Q1 2026 GOALS:**
- [ ] Stripe payment integration
- [ ] Expert payout system
- [ ] Zoom video integration
- [ ] Workshop scheduling
- [ ] Mobile PWA optimization

**Q2 2026 GOALS:**
- [ ] Expert marketplace launch
- [ ] Course builder MVP
- [ ] Progress tracking
- [ ] Certificate generation

**Q3 2026 GOALS:**
- [ ] AI insights dashboard
- [ ] Industry benchmarks
- [ ] Custom report builder
- [ ] API v1 for partners

**Q4 2026 GOALS:**
- [ ] Native mobile apps
- [ ] Push notifications
- [ ] Enterprise features
- [ ] SOC 2 compliance`,

            'architecture-detail': `**System Architecture Deep Dive**

**Frontend Stack:**
- Next.js 14 (App Router)
- React 18 with Server Components
- Tailwind CSS + Custom Design System
- Framer Motion animations
- React-PDF for reports

**Backend Stack:**
- Next.js API Routes (serverless)
- Supabase PostgreSQL
- Row Level Security (RLS)
- Edge Functions (Deno)

**AI/ML Stack:**
- VAPI for voice conversations
- Claude API for analysis
- MindReasoner for personality insights
- OpenAI for embeddings (future)

**Infrastructure:**
- Netlify (frontend hosting)
- Supabase (database + auth)
- Resend (transactional email)
- Twilio (SMS notifications)

**Security:**
- JWT authentication
- RLS policies on all tables
- Encrypted secrets
- CORS configuration`,

            'mindmap': `**Mind Map: HumanGlue Ecosystem**

**Core Platform**
 Assessment Engine
    VAPI Voice Interface
    Question Branching Logic
    Scoring Algorithm
    Report Generator
 User Management
    Authentication (Supabase)
    Role-Based Access
    Organization Hierarchy
    Profile Management
 White-Label System
    Branding Context
    Theme Variables
    Email Templates
    Report Customization
 Integration Layer
     VAPI (Voice AI)
     Stripe (Payments)
     Zoom (Video)
     Resend (Email)
     Twilio (SMS)

**Admin Console**
 User Management
 Organization Settings
 Content Management
 Analytics Dashboard
 System Configuration

**Client Portal**
 Assessment Journey
 Results & Reports
 Workshop Access
 Expert Booking
 Course Enrollment`,

            'default': `**HumanGlue Platform Assistant**

I'm your AI development partner with full context about the HumanGlue platform. I can help with:

** Project Info**
- "Show me the PRD" - Full product requirements
- "What are the milestones?" - Project timeline
- "Mind map" - System architecture overview

** Architecture**
- "How does [component] work?"
- "What tech stack do we use?"
- "Explain the data flow"

** Implementation**
- "What's blocking [feature]?"
- "How do I implement [feature]?"
- "Database schema for [table]"

** Status**
- "Project status" - Overall progress
- "What's in progress?"
- "What's next?"

Try clicking on any diagram node for context-aware help!`
        };

        // Comprehensive component context for AI tooltips - explains what each node does
        const componentContext = {
            // Frontend Layer
            'Browser': {
                title: 'Browser/PWA Client',
                description: 'The primary user interface delivered as a Progressive Web App (PWA). Users access HumanGlue through modern web browsers with offline capabilities, responsive design, and native-like features.',
                tech: ['Next.js 14', 'React 18', 'Tailwind CSS', 'Service Workers'],
                files: ['app/**/*.tsx', 'components/**/*.tsx'],
                status: 'active',
                relatedTasks: ['PWA optimization', 'Mobile responsive design']
            },
            'Mobile': {
                title: 'Mobile App (Future)',
                description: 'Planned native mobile applications for iOS and Android. Currently in roadmap for Q4 2026. Will share most business logic with web app through shared components.',
                tech: ['React Native', 'Expo', 'Shared UI Kit'],
                files: ['(planned)'],
                status: 'planned',
                relatedTasks: ['Native app development', 'Push notifications']
            },
            'AppRouter': {
                title: 'Next.js App Router',
                description: 'Server-side rendering and routing engine. Uses file-based routing with layouts, loading states, and error boundaries. Handles authentication redirects and protected routes.',
                tech: ['Next.js 14 App Router', 'Server Components', 'Streaming'],
                files: ['app/layout.tsx', 'app/**/page.tsx', 'middleware.ts'],
                status: 'active',
                relatedTasks: ['Route optimization', 'SEO improvements']
            },
            'Pages': {
                title: 'Pages & Layouts',
                description: 'Application pages organized by user role: admin dashboard, instructor portal, expert marketplace, and client-facing views. Each has a layout with role-specific navigation.',
                tech: ['Server Components', 'Client Components', 'Suspense'],
                files: ['app/admin/**', 'app/instructor/**', 'app/(client)/**'],
                status: 'active',
                relatedTasks: ['Dashboard components', 'Navigation fixes']
            },
            'Components': {
                title: 'Component Library',
                description: 'Reusable UI components using atomic design principles (atoms, molecules, organisms). Built with accessibility in mind and supports theming/white-labeling.',
                tech: ['React', 'Tailwind CSS', 'Radix UI', 'Framer Motion'],
                files: ['components/**/*.tsx'],
                status: 'active',
                relatedTasks: ['White-label theming', 'Component documentation']
            },
            'Contexts': {
                title: 'Context Providers',
                description: 'React contexts for global state management including auth state, branding/theming, user preferences, and real-time subscriptions.',
                tech: ['React Context', 'Custom Hooks', 'Supabase Realtime'],
                files: ['lib/context/**', 'lib/hooks/**'],
                status: 'active',
                relatedTasks: ['BrandingContext enhancement']
            },

            // Backend Layer
            'API': {
                title: 'API Routes',
                description: 'Server-side API endpoints built with Next.js Route Handlers. Handles business logic, data validation, and external service integration.',
                tech: ['Next.js Route Handlers', 'Zod validation', 'Server Actions'],
                files: ['app/api/**/*.ts'],
                status: 'active',
                relatedTasks: ['API security audit', 'Rate limiting']
            },
            'Auth': {
                title: 'Authentication Service',
                description: 'Supabase Auth integration with email/password, magic links, and OAuth providers. Manages sessions, tokens, and role-based access control.',
                tech: ['Supabase Auth', 'JWT', 'RLS Policies'],
                files: ['lib/supabase/auth.ts', 'middleware.ts'],
                status: 'active',
                relatedTasks: ['SSO integration', 'MFA support']
            },
            'Email': {
                title: 'Resend Email Service',
                description: 'Transactional email service using Resend. Handles welcome emails, notifications, assessment reports, and marketing communications with white-label support.',
                tech: ['Resend API', 'React Email', 'HTML Templates'],
                files: ['lib/email-templates.ts', 'app/api/email/**'],
                status: 'active',
                relatedTasks: ['Email template theming']
            },
            'SMS': {
                title: 'Twilio SMS Service',
                description: 'SMS notifications and two-factor authentication via Twilio. Used for workshop reminders, assessment invitations, and urgent alerts.',
                tech: ['Twilio API', '10DLC compliant'],
                files: ['lib/services/twilio.ts'],
                status: 'active',
                relatedTasks: ['SMS templates', 'Opt-in management']
            },
            'Voice': {
                title: 'VAPI Voice AI',
                description: 'Voice-powered AI assessments using VAPI. Conducts conversational maturity assessments, provides real-time analysis, and generates actionable insights.',
                tech: ['VAPI SDK', 'Claude AI', 'WebRTC'],
                files: ['components/vapi/**', 'lib/services/vapi.ts'],
                status: 'active',
                relatedTasks: ['Assessment refinement', 'Multi-language support']
            },

            // Database Layer
            'PG': {
                title: 'PostgreSQL Database',
                description: 'Core database hosted on Supabase. Contains all application data with proper indexing, constraints, and row-level security policies.',
                tech: ['PostgreSQL 15', 'Supabase', 'pgvector'],
                files: ['supabase/migrations/**'],
                status: 'active',
                relatedTasks: ['Query optimization', 'Index tuning']
            },
            'Storage': {
                title: 'File Storage',
                description: 'Supabase Storage for file uploads: profile images, course materials, assessment reports, and organization logos. Supports CDN delivery.',
                tech: ['Supabase Storage', 'S3-compatible', 'CDN'],
                files: ['lib/supabase/storage.ts'],
                status: 'active',
                relatedTasks: ['Image optimization', 'Video streaming']
            },
            'RLS': {
                title: 'Row Level Security',
                description: 'PostgreSQL RLS policies ensuring data isolation between organizations. Users can only access data within their org and permission level.',
                tech: ['PostgreSQL RLS', 'Policy Functions'],
                files: ['supabase/migrations/**'],
                status: 'active',
                relatedTasks: ['Security audit', 'Policy optimization']
            },

            // External Integrations
            'Stripe': {
                title: 'Stripe Payments (Planned)',
                description: 'Payment processing for subscriptions, course purchases, and expert payouts. Currently blocked pending business verification.',
                tech: ['Stripe Elements', 'Webhooks', 'Connect'],
                files: ['(planned) lib/services/stripe.ts'],
                status: 'blocked',
                relatedTasks: ['Account setup', 'Webhook implementation']
            },
            'Zoom': {
                title: 'Zoom Video (Planned)',
                description: 'Video conferencing integration for workshops, expert consultations, and live courses. Blocked pending Zoom Marketplace app approval.',
                tech: ['Zoom SDK', 'Meeting API', 'Webhooks'],
                files: ['(planned) lib/services/zoom.ts'],
                status: 'blocked',
                relatedTasks: ['Marketplace application', 'SDK integration']
            },
            'Neo4j': {
                title: 'Neo4j Knowledge Graph',
                description: 'Graph database for AI knowledge management. Stores relationships between concepts, companies, experts, and recommendations for intelligent querying.',
                tech: ['Neo4j Aura', 'Cypher', 'GraphQL'],
                files: ['services/humanglue-agent/**'],
                status: 'in-progress',
                relatedTasks: ['Schema design', 'Query optimization']
            },

            // User Roles
            'SA': {
                title: 'Super Admin (Full)',
                description: 'Platform owner with complete system access. Can manage all organizations, users, billing, system settings, and white-label configuration.',
                tech: ['RBAC', 'Multi-tenant'],
                files: ['app/admin/**', 'middleware.ts'],
                status: 'active',
                relatedTasks: ['Admin dashboard', 'Audit logging']
            },
            'Admin': {
                title: 'Organization Admin',
                description: 'Administrator for a single organization. Manages their org users, content, workshops, and views organization-specific analytics.',
                tech: ['RBAC', 'Org-scoped'],
                files: ['app/admin/**'],
                status: 'active',
                relatedTasks: ['Org settings UI', 'Team management']
            },
            'Instructor': {
                title: 'Instructor Role',
                description: 'Course teachers who can create and manage course content, view enrolled students, and track learning analytics.',
                tech: ['RBAC', 'Course-scoped'],
                files: ['app/instructor/**'],
                status: 'active',
                relatedTasks: ['Course builder', 'Analytics dashboard']
            },
            'Expert': {
                title: 'Expert Role',
                description: 'Consultants available for hire through the expert marketplace. Manage their profile, availability, rates, and client consultations.',
                tech: ['RBAC', 'Marketplace'],
                files: ['app/expert/**'],
                status: 'active',
                relatedTasks: ['Profile pages', 'Booking system']
            },
            'Client': {
                title: 'Client Role',
                description: 'End users who take assessments, view results, book workshops, enroll in courses, and hire experts.',
                tech: ['RBAC', 'User-scoped'],
                files: ['app/(client)/**'],
                status: 'active',
                relatedTasks: ['Dashboard improvements', 'Recommendations']
            },

            // Assessment Flow
            'VAPI': {
                title: 'VAPI Voice Assessment',
                description: 'Voice-powered conversational AI that guides users through maturity assessments. Uses Claude for natural language understanding and adaptive questioning.',
                tech: ['VAPI', 'Claude AI', 'WebRTC'],
                files: ['components/vapi/**', 'lib/services/vapi.ts'],
                status: 'active',
                relatedTasks: ['Question refinement', 'Score calibration']
            },
            'Questions': {
                title: 'Dynamic Questions',
                description: 'AI-driven question flow that adapts based on user responses. Covers 8 dimensions of AI maturity with weighted scoring.',
                tech: ['Claude AI', 'Decision Trees'],
                files: ['lib/assessment/**'],
                status: 'active',
                relatedTasks: ['New question sets', 'Industry customization']
            },
            'Scoring': {
                title: 'Maturity Scoring',
                description: 'Algorithm that calculates AI maturity score (0-10) across multiple dimensions. Generates level classifications and benchmark comparisons.',
                tech: ['Custom Algorithm', 'Benchmarking'],
                files: ['lib/assessment/scoring.ts'],
                status: 'active',
                relatedTasks: ['Score refinement', 'Industry benchmarks']
            },
            'Report': {
                title: 'PDF Report Generation',
                description: 'Automated PDF report generation with assessment results, score breakdowns, recommendations, and action items. Supports white-label branding.',
                tech: ['React-PDF', 'Server-side rendering'],
                files: ['app/api/assessments/[id]/pdf/route.ts'],
                status: 'active',
                relatedTasks: ['Template theming', 'Chart improvements']
            },

            // Generic fallback
            'default': {
                title: 'Platform Component',
                description: 'This component is part of the HumanGlue platform architecture. Click "Ask AI" for more detailed information.',
                tech: ['Next.js', 'React', 'Supabase'],
                files: ['See codebase'],
                status: 'active',
                relatedTasks: ['Documentation']
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', async () => {
            // Restore UI state
            restoreSidebarState();

            // Load all data in parallel
            await Promise.all([
                loadNotesFromSupabase(),
                loadRoadmapItems()
            ]);

            // Render initial view
            loadDiagram('platform');
            renderNotes();
            renderCustomSections();
            updateStats();
            updateLastSaved();
            setupRealtimeSubscription();
        });

        // Load notes from Supabase
        async function loadNotesFromSupabase() {
            try {
                const { data, error } = await supabase
                    .from('project_notes')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                notes = data || [];
                console.log('Loaded', notes.length, 'notes from Supabase');
            } catch (err) {
                console.error('Error loading notes:', err);
                // Fallback to localStorage if Supabase fails
                notes = JSON.parse(localStorage.getItem('hg_pm_notes') || '[]');
            }
        }

        // Setup realtime subscription for collaborative updates
        function setupRealtimeSubscription() {
            realtimeSubscription = supabase
                .channel('project_notes_changes')
                .on('postgres_changes',
                    { event: '*', schema: 'public', table: 'project_notes' },
                    async (payload) => {
                        console.log('Realtime update:', payload.eventType);
                        await loadNotesFromSupabase();
                        renderNotes();
                        updateStats();
                        updateLastSaved();
                    }
                )
                .subscribe();
        }

        // Load diagram
        async function loadDiagram(name, btn) {
            currentDiagram = name;
            const diagram = diagrams[name];

            // Update nav
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            if (btn) btn.classList.add('active');

            // Update title
            document.getElementById('diagramTitle').textContent = diagram.title;
            document.getElementById('diagramSubtitle').textContent = diagram.subtitle;

            // Dispose of panzoom if switching away from mermaid
            if (panzoomInstance) {
                panzoomInstance.dispose();
                panzoomInstance = null;
            }

            // Check for special diagram types
            if (diagram.type === 'interactive-gantt') {
                renderInteractiveGantt();
                return;
            }

            if (diagram.type === 'interactive-gtm') {
                renderGTMStrategy();
                return;
            }

            if (diagram.type === 'interactive-b2c-workshops') {
                renderB2CWorkshops();
                return;
            }

            if (diagram.type === 'kanban') {
                renderKanbanBoard();
                return;
            }

            if (diagram.type === 'mindmap') {
                renderMindMap();
                return;
            }

            // Render mermaid using the render API for Mermaid v10
            const container = document.getElementById('mermaidDiagram');

            try {
                // Generate unique ID for this render
                const id = 'diagram-' + Date.now();
                // Clean up the diagram code - remove leading/trailing whitespace
                const cleanCode = diagram.code.trim();

                // Use mermaid.render() to generate SVG
                const { svg } = await mermaid.render(id, cleanCode);
                container.innerHTML = svg;

                // Initialize panzoom
                if (panzoomInstance) {
                    panzoomInstance.dispose();
                }

                const wrapper = document.querySelector('.diagram-wrapper');
                panzoomInstance = panzoom(wrapper, {
                    maxZoom: 4,
                    minZoom: 0.2,
                    bounds: true,
                    boundsPadding: 0.1
                });

                panzoomInstance.on('transform', () => {
                    const transform = panzoomInstance.getTransform();
                    document.getElementById('zoomLevel').textContent = Math.round(transform.scale * 100) + '%';
                });

                // Add click handlers to nodes with AI context
                setTimeout(() => {
                    document.querySelectorAll('.node, .actor, .messageText, .cluster').forEach(node => {
                        node.style.cursor = 'pointer';
                        node.addEventListener('click', (e) => {
                            e.stopPropagation();
                            e.preventDefault();
                            const text = node.textContent?.trim() || 'Component';
                            // Extract the node ID/name for context lookup
                            const nodeId = extractNodeId(node);
                            showAITooltip(nodeId, text, e.clientX, e.clientY);
                        });
                        // Add hover effect
                        node.addEventListener('mouseenter', () => {
                            node.style.filter = 'brightness(1.2)';
                        });
                        node.addEventListener('mouseleave', () => {
                            node.style.filter = '';
                        });
                    });
                }, 300);

            } catch (err) {
                console.error('Mermaid render error:', err);
                console.error('Diagram code:', diagram.code);
                container.innerHTML = `<div style="color: #EF4444; padding: 20px; text-align: center;">
                    <p style="font-size: 18px; margin-bottom: 10px;"> Error rendering diagram</p>
                    <p style="font-size: 14px; color: #9ca3af;">${err.message || 'Unknown error'}</p>
                </div>`;
            }
        }

        // Mobile toggle functions
        function toggleMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('mobileOverlay');
            const rightPanel = document.querySelector('.right-panel');

            // Close right panel if open
            rightPanel.classList.remove('show');

            sidebar.classList.toggle('show');
            overlay.classList.toggle('show', sidebar.classList.contains('show'));
        }

        function toggleMobileRightPanel() {
            const rightPanel = document.querySelector('.right-panel');
            const overlay = document.getElementById('mobileOverlay');
            const sidebar = document.querySelector('.sidebar');

            // Close sidebar if open
            sidebar.classList.remove('show');

            rightPanel.classList.toggle('show');
            overlay.classList.toggle('show', rightPanel.classList.contains('show'));
        }

        function closeAllPanels() {
            document.querySelector('.sidebar').classList.remove('show');
            document.querySelector('.right-panel').classList.remove('show');
            document.getElementById('mobileOverlay').classList.remove('show');
            updateMobileNavActive('navCanvas');
        }

        // Close sidebar only - used by overlay click so right panel stays open
        function closeSidebarOnly() {
            const sidebar = document.querySelector('.sidebar');
            const rightPanel = document.querySelector('.right-panel');
            const overlay = document.getElementById('mobileOverlay');

            // Only close sidebar if it's open
            if (sidebar.classList.contains('show')) {
                sidebar.classList.remove('show');
                // Hide overlay only if right panel is also not showing
                if (!rightPanel.classList.contains('show')) {
                    overlay.classList.remove('show');
                    updateMobileNavActive('navCanvas');
                }
            }
            // If sidebar wasn't open but right panel is, do nothing - let user keep browsing
        }

        // Mobile bottom navigation functions
        function updateMobileNavActive(activeId) {
            document.querySelectorAll('.mobile-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeItem = document.getElementById(activeId);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }

        function showMobileCanvas() {
            closeAllPanels();
            updateMobileNavActive('navCanvas');
        }

        function showMobileTasks() {
            const rightPanel = document.querySelector('.right-panel');
            const overlay = document.getElementById('mobileOverlay');
            const sidebar = document.querySelector('.sidebar');

            // Close sidebar if open
            sidebar.classList.remove('show');

            // Show tasks panel
            rightPanel.classList.add('show');
            overlay.classList.add('show');

            // Switch to Tasks tab
            switchPanel('tasks');
            updateMobileNavActive('navTasks');
        }

        function showMobileAI() {
            const rightPanel = document.querySelector('.right-panel');
            const overlay = document.getElementById('mobileOverlay');
            const sidebar = document.querySelector('.sidebar');

            // Close sidebar if open
            sidebar.classList.remove('show');

            // Show AI panel
            rightPanel.classList.add('show');
            overlay.classList.add('show');

            // Switch to AI tab
            switchPanel('chat');
            updateMobileNavActive('navAI');
        }

        // Update toggleMobileSidebar to track nav state
        const originalToggleMobileSidebar = toggleMobileSidebar;
        toggleMobileSidebar = function() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('mobileOverlay');
            const rightPanel = document.querySelector('.right-panel');

            // Close right panel if open
            rightPanel.classList.remove('show');

            sidebar.classList.toggle('show');
            overlay.classList.toggle('show', sidebar.classList.contains('show'));

            if (sidebar.classList.contains('show')) {
                updateMobileNavActive('navMenu');
            } else {
                updateMobileNavActive('navCanvas');
            }
        };

        // Zoom controls
        function zoomIn() {
            if (panzoomInstance) {
                panzoomInstance.smoothZoom(window.innerWidth / 2, window.innerHeight / 2, 1.3);
            }
        }

        function zoomOut() {
            if (panzoomInstance) {
                panzoomInstance.smoothZoom(window.innerWidth / 2, window.innerHeight / 2, 0.7);
            }
        }

        function resetZoom() {
            if (panzoomInstance) {
                panzoomInstance.moveTo(0, 0);
                panzoomInstance.zoomAbs(0, 0, 1);
            }
        }

        function fitToScreen() {
            resetZoom();
            if (panzoomInstance) {
                setTimeout(() => panzoomInstance.smoothZoom(window.innerWidth / 2, window.innerHeight / 2, 0.5), 100);
            }
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Tab switching
        function switchTab(tab, btn) {
            document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');

            document.getElementById('notesPanel').style.display = tab === 'notes' ? 'block' : 'none';
            document.getElementById('chatPanel').style.display = tab === 'chat' ? 'flex' : 'none';
        }

        // Note filtering
        function filterNotes(filter, btn) {
            currentFilter = filter;
            document.querySelectorAll('.task-filter').forEach(f => f.classList.remove('active'));
            btn.classList.add('active');
            renderNotes();
        }

        // Stats update
        function updateStats() {
            document.getElementById('statCompleted').textContent = notes.filter(n => n.status === 'completed').length;
            document.getElementById('statProgress').textContent = notes.filter(n => n.status === 'in-progress').length;
            document.getElementById('statTodo').textContent = notes.filter(n => n.status === 'todo').length;
            document.getElementById('statBlocked').textContent = notes.filter(n => n.status === 'blocked').length;
        }

        // Notes rendering
        function renderNotes() {
            const container = document.getElementById('notesList');
            let filteredNotes = notes;

            if (currentFilter !== 'all') {
                filteredNotes = notes.filter(n => n.status === currentFilter);
            }

            // Sort by priority (critical first), then by date
            filteredNotes.sort((a, b) => {
                const priorityOrder = { critical: 0, high: 1, medium: 2, low: 3 };
                const aPriority = priorityOrder[a.priority] ?? 2;
                const bPriority = priorityOrder[b.priority] ?? 2;
                if (aPriority !== bPriority) {
                    return aPriority - bPriority;
                }
                return new Date(b.created_at) - new Date(a.created_at);
            });

            if (filteredNotes.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <p>No ${currentFilter === 'all' ? 'tasks' : currentFilter.replace('_', ' ') + ' tasks'}</p>
                        <p style="font-size: 11px; margin-top: 4px;">Click a diagram node or the button below</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredNotes.map((note) => {
                return `
                <div class="note-card priority-${note.priority || 'medium'}" onclick="editNote('${note.id}')">
                    <div class="note-card-header">
                        <span class="note-card-title">${escapeHtml(note.title)}</span>
                        <span class="note-card-status status-${note.status || 'todo'}">${(note.status || 'todo').replace('_', ' ')}</span>
                    </div>
                    ${note.content ? `<div class="note-card-body">${escapeHtml(note.content).substring(0, 120)}${note.content.length > 120 ? '...' : ''}</div>` : ''}
                    <div class="note-card-meta">
                        <span style="background: rgba(97, 216, 254, 0.1); padding: 2px 6px; border-radius: 4px;">${note.node_reference || note.diagram_view || 'General'}</span>
                        ${note.created_by_name ? `<span>@${escapeHtml(note.created_by_name)}</span>` : ''}
                        <span style="margin-left: auto;">${formatDate(note.created_at)}</span>
                    </div>
                </div>
            `}).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const now = new Date();
            const diff = now - date;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));

            if (days === 0) return 'Today';
            if (days === 1) return 'Yesterday';
            if (days < 7) return `${days}d ago`;
            return date.toLocaleDateString();
        }

        // Note modal
        function openNoteModal(defaultTitle = '') {
            editingNoteId = null;
            document.getElementById('noteModalTitle').textContent = 'Add Task';
            document.getElementById('noteTitle').value = defaultTitle;
            document.getElementById('noteDescription').value = '';
            document.getElementById('noteStatus').value = 'todo';
            document.getElementById('notePriority').value = 'medium';
            document.getElementById('noteComponent').value = currentDiagram;
            document.getElementById('noteAssignee').value = '';
            document.getElementById('deleteNoteBtn').style.display = 'none';
            document.getElementById('noteModal').classList.add('active');
            setTimeout(() => document.getElementById('noteTitle').focus(), 100);
        }

        function editNote(noteId) {
            editingNoteId = noteId;
            const note = notes.find(n => n.id === noteId);
            if (!note) {
                console.error('Note not found:', noteId);
                return;
            }
            document.getElementById('noteModalTitle').textContent = 'Edit Task';
            document.getElementById('noteTitle').value = note.title;
            document.getElementById('noteDescription').value = note.content || '';
            document.getElementById('noteStatus').value = note.status || 'todo';
            document.getElementById('notePriority').value = note.priority || 'medium';
            document.getElementById('noteComponent').value = note.node_reference || note.diagram_view || 'platform';
            document.getElementById('noteAssignee').value = note.created_by_name || '';
            document.getElementById('deleteNoteBtn').style.display = 'block';
            document.getElementById('noteModal').classList.add('active');
        }

        function closeNoteModal() {
            document.getElementById('noteModal').classList.remove('active');
            editingNoteId = null;
        }

        async function saveNote() {
            const title = document.getElementById('noteTitle').value.trim();
            if (!title) {
                alert('Please enter a title');
                return;
            }

            const noteData = {
                title,
                content: document.getElementById('noteDescription').value.trim(),
                status: document.getElementById('noteStatus').value,
                priority: document.getElementById('notePriority').value,
                diagram_view: currentDiagram,
                node_reference: document.getElementById('noteComponent').value,
                created_by_name: document.getElementById('noteAssignee').value.trim() || 'Anonymous'
            };

            try {
                if (editingNoteId) {
                    // Update existing note
                    const { error } = await supabase
                        .from('project_notes')
                        .update(noteData)
                        .eq('id', editingNoteId);

                    if (error) throw error;
                } else {
                    // Create new note
                    const { error } = await supabase
                        .from('project_notes')
                        .insert([noteData]);

                    if (error) throw error;
                }

                // Reload notes from Supabase
                await loadNotesFromSupabase();
                renderNotes();
                updateStats();
                updateLastSaved();
                closeNoteModal();
            } catch (err) {
                console.error('Error saving note:', err);
                alert('Error saving note. Please try again.');
            }
        }

        async function deleteCurrentNote() {
            if (editingNoteId && confirm('Delete this task?')) {
                try {
                    const { error } = await supabase
                        .from('project_notes')
                        .delete()
                        .eq('id', editingNoteId);

                    if (error) throw error;

                    await loadNotesFromSupabase();
                    renderNotes();
                    updateStats();
                    updateLastSaved();
                    closeNoteModal();
                } catch (err) {
                    console.error('Error deleting note:', err);
                    alert('Error deleting note. Please try again.');
                }
            }
        }

        // Settings
        function openSettingsModal() {
            document.getElementById('settingsProjectName').value = settings.projectName || 'HumanGlue Platform';
            document.getElementById('settingsTeam').value = settings.team || '';
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function saveSettings() {
            settings.projectName = document.getElementById('settingsProjectName').value;
            settings.team = document.getElementById('settingsTeam').value;
            localStorage.setItem('hg_pm_settings', JSON.stringify(settings));
            closeSettingsModal();
            updateLastSaved();
        }

        function clearAllNotes() {
            if (confirm('Are you sure you want to delete ALL tasks? This cannot be undone.')) {
                notes = [];
                saveData();
                renderNotes();
                updateStats();
                closeSettingsModal();
            }
        }

        // Data persistence
        function saveData() {
            localStorage.setItem('hg_pm_notes', JSON.stringify(notes));
            updateLastSaved();
        }

        function updateLastSaved() {
            document.getElementById('lastSaved').textContent = new Date().toLocaleTimeString();
        }

        // Import/Export
        function exportNotes() {
            const data = {
                projectName: settings.projectName,
                exportDate: new Date().toISOString(),
                notes: notes,
                stats: {
                    total: notes.length,
                    completed: notes.filter(n => n.status === 'completed').length,
                    inProgress: notes.filter(n => n.status === 'in-progress').length,
                    todo: notes.filter(n => n.status === 'todo').length,
                    blocked: notes.filter(n => n.status === 'blocked').length
                }
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `humanglue-tasks-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importNotes() {
            document.getElementById('importFileInput').click();
        }

        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.notes && Array.isArray(data.notes)) {
                        if (confirm(`Import ${data.notes.length} tasks? This will add to existing tasks.`)) {
                            notes = [...data.notes, ...notes];
                            saveData();
                            renderNotes();
                            updateStats();
                            alert('Import successful!');
                        }
                    } else {
                        alert('Invalid file format');
                    }
                } catch (err) {
                    alert('Error reading file: ' + err.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // Chat functionality
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            addChatMessage(message, 'user');
            input.value = '';

            const typingId = showTypingIndicator();

            if (selectedChatExpert === 'ai') {
                // Use local AI response for project-specific queries
                setTimeout(() => {
                    removeTypingIndicator(typingId);
                    const response = getAIResponse(message);
                    addChatMessage(response, 'assistant', true);
                }, 600 + Math.random() * 600);
            } else {
                // Use Mind Reasoner API for expert responses
                try {
                    const expert = MIND_REASONER_EXPERTS[selectedChatExpert];
                    if (!expert) {
                        removeTypingIndicator(typingId);
                        addChatMessage('Expert not found. Please select a valid expert.', 'assistant');
                        return;
                    }

                    const response = await callMindReasoner(expert.mindId, message);
                    removeTypingIndicator(typingId);

                    // Format the response with expert branding
                    const formattedResponse = formatMindReasonerResponse(expert, response);
                    addChatMessage(formattedResponse, 'assistant', true);
                } catch (error) {
                    console.error('Mind Reasoner error:', error);
                    removeTypingIndicator(typingId);
                    // Fall back to mock response on error
                    const fallbackResponse = getExpertResponse(selectedChatExpert, message);
                    addChatMessage(fallbackResponse + '<br><br><span style="font-size:11px;color:var(--text-muted);"> Using cached response (API unavailable)</span>', 'assistant', true);
                }
            }
        }

        // Call Mind Reasoner API via Netlify function
        async function callMindReasoner(mindId, message) {
            const response = await fetch('/.netlify/functions/simulate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    mindId,
                    message,
                    model: 'mind-reasoner-pro'
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'Mind Reasoner API error');
            }

            return response.json();
        }

        // Format Mind Reasoner response with expert branding
        function formatMindReasonerResponse(expert, response) {
            const content = response.message || response.response || 'I need more context to provide a thoughtful response.';
            const analysis = response.analysis || {};

            let html = `<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                <img src="${expert.image}" alt="${expert.name}" style="width: 32px; height: 32px; border-radius: 50%;">
                <strong style="color: var(--hg-cyan);">${expert.name}</strong>
            </div>`;

            html += `<div style="line-height: 1.6;">${content.replace(/\n/g, '<br>')}</div>`;

            // Add analysis sections if available
            if (analysis.thinking || analysis.feeling || analysis.acting) {
                html += `<div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-subtle);">`;
                if (analysis.thinking) {
                    html += `<div style="margin-bottom: 8px;"><strong style="color: var(--hg-purple);"> Thinking:</strong> <span style="color: var(--text-secondary); font-size: 12px;">${analysis.thinking}</span></div>`;
                }
                if (analysis.feeling) {
                    html += `<div style="margin-bottom: 8px;"><strong style="color: var(--hg-green);"> Feeling:</strong> <span style="color: var(--text-secondary); font-size: 12px;">${analysis.feeling}</span></div>`;
                }
                if (analysis.acting) {
                    html += `<div><strong style="color: var(--hg-cyan);"> Action:</strong> <span style="color: var(--text-secondary); font-size: 12px;">${analysis.acting}</span></div>`;
                }
                html += `</div>`;
            }

            html += `<div style="font-size: 10px; color: var(--text-muted); margin-top: 12px; padding-top: 8px; border-top: 1px solid var(--border-subtle);">
                Powered by <strong>Mind Reasoner</strong>  mind-reasoner-pro
            </div>`;

            return html;
        }

        function getExpertResponse(expertId, query) {
            const projectContext = `
                Project: HumanGlue Platform
                Current Phase: MVP Development
                Components: ${mindMapNodes.map(n => n.label).join(', ')}
                Critical Items: ${mindMapNodes.filter(n => n.priority === 'critical').map(n => n.label).join(', ')}
                Prunable: ${mindMapNodes.filter(n => n.prunable).map(n => n.label).join(', ') || 'None identified'}
                Sprint Tasks: ${sprintTasks.filter(t => t.status === 'progress').map(t => t.title).join(', ')}
            `;

            const expertPersonalities = {
                'steve-jobs': {
                    name: 'Steve Jobs',
                    icon: '',
                    style: 'Direct, challenging, focused on user experience and simplicity.',
                    responses: {
                        default: `Focus. That's what separates great products from merely good ones. Looking at your project - ${mindMapNodes.length} components is a lot. What's the ONE thing that makes HumanGlue irreplaceable?

The question isn't whether you CAN build all of this. It's whether you SHOULD. Start with what matters most to your users. Make it insanely great. Then, and only then, think about adding more.

What does your customer see when they first use HumanGlue? Is it magical? If not, nothing else matters.`,
                        scope: `You're asking about scope? Good. Most founders don't ask that question until it's too late.

Here's my philosophy: Do fewer things better. I see you have components marked as prunable. Why are they still there? Cut them. Today.

The critical path is: Assessment Engine  Reports  Client Portal. Everything else is noise until those are perfect. Are they perfect?`,
                        design: `Design isn't just how it looks - it's how it works. Every pixel, every interaction, every moment of friction... they all matter.

Look at your mind map. Is there elegance in this architecture? Or is it complexity hiding behind a diagram? The best designs feel inevitable, as if they couldn't have been designed any other way.

Show me one user flow. I'll tell you where you're overthinking it.`
                    }
                },
                'paul-graham': {
                    name: 'Paul Graham',
                    icon: '',
                    style: 'Analytical, focused on startup strategy and product-market fit.',
                    responses: {
                        default: `The question I always ask founders: Are you building something people want?

Looking at HumanGlue, your Assessment Engine seems to be the core value prop. But here's what concerns me - how many paying customers do you have RIGHT NOW?

The best indicator of product-market fit isn't a beautiful architecture diagram. It's customers pulling the product out of your hands.

Talk to 10 potential customers this week. Not to sell them - to learn. What exact problem keeps them up at night? Is it really "AI maturity assessment"?`,
                        metrics: `Metrics are the mirror that shows you what's actually happening.

For HumanGlue at your stage, I'd focus on:
1. **Weekly Active Users** - Are people coming back?
2. **Time to First Value** - How fast can someone complete an assessment?
3. **Conversion Rate** - Free  Paid. This is your PMF indicator.
4. **NPS or equivalent** - Would they recommend you?

What are these numbers today? If you don't know, that's problem #1.`,
                        fundraising: `Don't think about fundraising. Think about growth.

Investors fund traction, not ideas. With your current progress, focus on getting to 10 paying customers. Then 50. Then 200.

At each milestone, you'll have more leverage. And here's the counterintuitive part: the less you need money, the easier it is to raise.

What's your current MRR?`
                    }
                },
                'jony-ive': {
                    name: 'Jony Ive',
                    icon: '',
                    style: 'Thoughtful, focused on craftsmanship and emotional design.',
                    responses: {
                        default: `When I look at a product, I think about the human experience. Not the features, not the technology - the moment of use.

Your HumanGlue platform... what does it feel like to use it? Is there joy in the interaction? Does it respect the user's time and intelligence?

I see many components in your architecture. Each one represents cognitive load for your users. The art isn't in what you add - it's in what you leave out while still achieving the essential purpose.

What's the emotional journey you want users to have?`,
                        simplicity: `True simplicity isn't the absence of complexity - it's the conquest of it.

Your mind map shows interconnected systems. That's fine technically. But the user should never feel that complexity. They should only feel clarity.

Consider: What if HumanGlue had only ONE screen? What would it show? Start there. Then add only what's absolutely necessary.

The goal isn't minimal features. It's minimal friction.`,
                        brand: `A brand is a promise. It's what people feel when they think of you.

HumanGlue - the name itself suggests connection, humanity in technology. But does your product deliver on that promise?

Every color choice, every transition, every word of copy... they should all reinforce the same feeling. What is that feeling for HumanGlue?

I'd suggest: Warmth. Clarity. Confidence. Does your current design evoke these?`
                    }
                },
                'peter-thiel': {
                    name: 'Peter Thiel',
                    icon: '',
                    style: 'Contrarian, focused on monopoly creation and zero-to-one innovation.',
                    responses: {
                        default: `The most valuable businesses of the coming decades will be built by entrepreneurs who seek to empower people rather than try to make them obsolete.

Looking at HumanGlue, the question I'd ask: What secret do you know that nobody else does? Every great company is built on a secret - an insight about the world that others don't see.

Your AI maturity assessment... is it a secret? Or is it something everyone already knows they need? The difference between success and failure often lies in that distinction.

What's the zero-to-one insight behind HumanGlue?`,
                        competition: `Competition is for losers. If you're competing, you're already losing.

The goal isn't to be better - it's to be the only one doing what you do. Does HumanGlue have a monopoly on something? Or are you fighting for scraps in a crowded market?

Think about what makes you definitively different. Not 10% better - 10x better. That's where monopoly power comes from.`,
                        strategy: `Start with a small market you can dominate. Amazon started with books. Facebook started with Harvard.

What's your Harvard? What's the smallest market where you can be absolutely essential? Dominate that first, then expand.

The biggest mistake I see founders make is going too broad too early. Narrow focus first. Monopoly second. Expansion third.`
                    }
                }
            };

            const expert = expertPersonalities[expertId];
            if (!expert) return getAIResponse(query);

            // Match query to response type
            const lowerQuery = query.toLowerCase();
            let responseType = 'default';
            if (lowerQuery.includes('scope') || lowerQuery.includes('prune') || lowerQuery.includes('cut')) {
                responseType = 'scope';
            } else if (lowerQuery.includes('design') || lowerQuery.includes('ui') || lowerQuery.includes('ux')) {
                responseType = 'design';
            } else if (lowerQuery.includes('metric') || lowerQuery.includes('kpi') || lowerQuery.includes('measure')) {
                responseType = 'metrics';
            } else if (lowerQuery.includes('raise') || lowerQuery.includes('funding') || lowerQuery.includes('investor')) {
                responseType = 'fundraising';
            } else if (lowerQuery.includes('simple') || lowerQuery.includes('minimal') || lowerQuery.includes('clean')) {
                responseType = 'simplicity';
            } else if (lowerQuery.includes('brand') || lowerQuery.includes('identity') || lowerQuery.includes('feel')) {
                responseType = 'brand';
            } else if (lowerQuery.includes('compet') || lowerQuery.includes('rival') || lowerQuery.includes('market')) {
                responseType = 'competition';
            } else if (lowerQuery.includes('strateg') || lowerQuery.includes('plan') || lowerQuery.includes('focus')) {
                responseType = 'strategy';
            }

            const response = expert.responses[responseType] || expert.responses.default;

            return `<strong style="color: var(--hg-cyan);">${expert.icon} ${expert.name}</strong>
<br><br>
${response}
<br><br>
<div style="font-size: 11px; color: var(--text-muted); border-top: 1px solid var(--border-subtle); padding-top: 8px; margin-top: 8px;">
    <em>Powered by Mind Reasoner</em>
</div>`;
        }

        // Helper for hot buttons
        function askAI(topic) {
            document.getElementById('chatInput').value = topic;
            sendMessage();
            // Switch to chat tab if not active
            switchTab('chat', document.querySelectorAll('.panel-tab')[1]);
        }

        // Create structured action card HTML
        function createActionCard(icon, iconClass, title, content, actions = []) {
            const actionBtns = actions.map(a =>
                `<button class="ai-response-btn ${a.primary ? 'primary' : 'secondary'}" onclick="${a.action}">${a.label}</button>`
            ).join('');

            return `<div class="ai-action-card">
                <div class="ai-action-header">
                    <div class="ai-action-icon ${iconClass}">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            ${icon}
                        </svg>
                    </div>
                    <div class="ai-action-title">${title}</div>
                </div>
                <div class="ai-action-content">${content}</div>
                ${actions.length ? `<div class="ai-response-actions">${actionBtns}</div>` : ''}
            </div>`;
        }

        function addChatMessage(text, role, isStructured = false) {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `chat-message ${role}`;

            // Convert markdown-like formatting
            let html = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/`([^`]+)`/g, '<code style="background: rgba(97,216,254,0.1); padding: 2px 6px; border-radius: 4px;">$1</code>')
                .replace(/```([\s\S]*?)```/g, '<pre style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px; margin: 8px 0; overflow-x: auto; font-size: 12px;">$1</pre>')
                .replace(/\n/g, '<br>');

            // If structured, handle action cards (already HTML)
            if (isStructured && text.includes('ai-action-card')) {
                html = text;
            }

            div.innerHTML = `<div class="chat-message-bubble">${html}</div>`;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function showTypingIndicator() {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = 'chat-message assistant';
            div.id = 'typing-' + Date.now();
            div.innerHTML = `
                <div class="chat-message-bubble">
                    <div class="typing-indicator">
                        <span class="typing-dot"></span>
                        <span class="typing-dot"></span>
                        <span class="typing-dot"></span>
                    </div>
                </div>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            return div.id;
        }

        function removeTypingIndicator(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        // Get comprehensive AI response with structured output
        function getAIResponse(message) {
            const lower = message.toLowerCase();
            const diagram = diagrams[currentDiagram];

            // PROJECT STATUS - Comprehensive overview
            if (lower.includes('project status') || lower.includes('status') || lower.includes('overview')) {
                const todoCount = notes.filter(n => n.status === 'todo').length;
                const inProgressCount = notes.filter(n => n.status === 'in-progress').length;
                const completedCount = notes.filter(n => n.status === 'completed').length;
                const blockedCount = notes.filter(n => n.status === 'blocked').length;

                return `<strong style="color: var(--hg-cyan);"> HumanGlue Project Status</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>',
    'status',
    'Task Summary',
    `<ul style="margin:0;padding-left:16px;">
        <li><strong>${todoCount}</strong> tasks pending</li>
        <li><strong>${inProgressCount}</strong> in progress</li>
        <li><strong>${completedCount}</strong> completed</li>
        <li><strong>${blockedCount}</strong> blocked</li>
    </ul>`,
    [{label: 'Add Task', action: 'openNoteModal()', primary: true}, {label: 'View Tasks', action: "switchTab('tasks', document.querySelector('.panel-tab'))"}]
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>',
    'info',
    'Active Components',
    `<ul style="margin:0;padding-left:16px;">
        <li> Authentication & RBAC</li>
        <li> White-label branding (65%)</li>
        <li> AI Assessment (VAPI)</li>
        <li> Discord Bot (development)</li>
        <li> Payments (awaiting Stripe)</li>
        <li> Video (awaiting Zoom)</li>
    </ul>`,
    [{label: 'View Roadmap', action: "loadDiagram('roadmap', this)"}]
)}`;
            }

            // BLOCKERS - Show current blockers
            if (lower.includes('blocker') || lower.includes('blocked') || lower.includes('issue') || lower.includes('problem')) {
                const blockedTasks = notes.filter(n => n.status === 'blocked');
                const blockerList = blockedTasks.length > 0
                    ? blockedTasks.map(t => `<li>${t.title}</li>`).join('')
                    : '<li>No blocked tasks currently</li>';

                return `<strong style="color: var(--hg-red);"> Current Blockers</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>',
    'blocker',
    'External Blockers',
    `<ul style="margin:0;padding-left:16px;">
        <li><strong>Stripe:</strong> Business verification pending (1-2 weeks)</li>
        <li><strong>Zoom:</strong> Marketplace app review (2-4 weeks)</li>
    </ul>`,
    [{label: 'Stripe Setup', action: "askAI('stripe')"}, {label: 'Zoom Setup', action: "askAI('zoom')"}]
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>',
    'task',
    'Blocked Tasks',
    `<ul style="margin:0;padding-left:16px;">${blockerList}</ul>`,
    blockedTasks.length > 0 ? [{label: 'View Blocked', action: "filterNotes('blocked')"}] : []
)}`;
            }

            // NEXT STEPS - Prioritized next actions
            if (lower.includes('next') || lower.includes('priority') || lower.includes('should') || lower.includes('todo')) {
                return `<strong style="color: var(--hg-green);"> Recommended Next Steps</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>',
    'status',
    'Immediate Priority',
    `<ol style="margin:0;padding-left:16px;">
        <li><strong>Complete white-label migration</strong> - 35 components remaining</li>
        <li><strong>Finish Discord bot</strong> - Community engagement ready</li>
        <li><strong>Start Stripe verification</strong> - Submit documents now</li>
    </ol>`,
    [{label: 'Add to Tasks', action: "openNoteModal('Complete white-label migration')", primary: true}]
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>',
    'info',
    'This Week',
    `<ul style="margin:0;padding-left:16px;">
        <li>Apply for Zoom Marketplace access</li>
        <li>Set up expert profile pages</li>
        <li>Implement push notifications</li>
        <li>Write test coverage for API routes</li>
    </ul>`,
    [{label: 'View Roadmap', action: "loadDiagram('roadmap', this)"}]
)}`;
            }

            // CURRENT DIAGRAM context
            if (lower.includes('current diagram') || lower.includes('this view') || lower.includes('this page')) {
                return `<strong style="color: var(--hg-cyan);"> Current View: ${diagram.title}</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"/>',
    'info',
    diagram.title,
    `<p style="margin:0 0 8px 0;">${diagram.subtitle}</p>
    <p style="margin:0;font-size:11px;color:#6b7280;">Click on any node in the diagram to see detailed context and related tasks. Use the AI tooltip to ask questions or add tasks directly from any component.</p>`,
    [{label: 'Add Note for View', action: `openNoteModal('Task for ${diagram.title}')`, primary: true}]
)}

<p style="font-size:12px;color:#9ca3af;margin-top:8px;"> <strong>Tip:</strong> Click any node in the diagram for AI-powered context!</p>`;
            }

            // TASKS summary
            if (lower.includes('task') || lower.includes('my task') || lower.includes('work')) {
                const highPriority = notes.filter(n => n.priority === 'high' && n.status !== 'completed');
                const inProgress = notes.filter(n => n.status === 'in-progress');

                return `<strong style="color: var(--hg-blue);"> Task Overview</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>',
    'warning',
    `High Priority (${highPriority.length})`,
    highPriority.length > 0
        ? `<ul style="margin:0;padding-left:16px;">${highPriority.slice(0, 3).map(t => `<li>${t.title}</li>`).join('')}</ul>`
        : `<p style="margin:0;">No high priority tasks</p>`,
    [{label: 'View High Priority', action: "filterNotes('high')", primary: true}]
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>',
    'task',
    `In Progress (${inProgress.length})`,
    inProgress.length > 0
        ? `<ul style="margin:0;padding-left:16px;">${inProgress.slice(0, 3).map(t => `<li>${t.title}</li>`).join('')}</ul>`
        : `<p style="margin:0;">No tasks in progress</p>`,
    [{label: 'Add Task', action: 'openNoteModal()', primary: true}, {label: 'View All', action: "switchTab('tasks', document.querySelector('.panel-tab'))"}]
)}`;
            }

            // ARCHITECTURE overview
            if (lower.includes('architecture') || lower.includes('structure') || lower.includes('stack') || lower.includes('tech')) {
                return `<strong style="color: var(--hg-cyan);"> Platform Architecture</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"/>',
    'info',
    'Tech Stack',
    `<ul style="margin:0;padding-left:16px;">
        <li><strong>Frontend:</strong> Next.js 14, React 18, Tailwind CSS</li>
        <li><strong>Backend:</strong> Next.js API Routes, Supabase</li>
        <li><strong>Database:</strong> PostgreSQL (Supabase), Neo4j</li>
        <li><strong>AI:</strong> VAPI Voice, Claude, MindReasoner</li>
        <li><strong>Comms:</strong> Resend, Twilio, Discord.js</li>
    </ul>`,
    [{label: 'Platform View', action: "loadDiagram('platform', this)", primary: true}]
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/>',
    'status',
    'Key Integrations',
    `<ul style="margin:0;padding-left:16px;">
        <li> Supabase Auth & Database</li>
        <li> Resend Email</li>
        <li> Twilio SMS</li>
        <li> VAPI Voice AI</li>
        <li> Stripe Payments</li>
        <li> Zoom Video</li>
    </ul>`,
    [{label: 'Database Schema', action: "loadDiagram('database', this)"}]
)}`;
            }

            // FILES - Codebase structure
            if (lower.includes('file') || lower.includes('folder') || lower.includes('code') || lower.includes('directory')) {
                return `<strong style="color: var(--hg-blue);"> Codebase Structure</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>',
    'info',
    'Key Directories',
    `<ul style="margin:0;padding-left:16px;font-family:monospace;font-size:11px;">
        <li><strong>app/</strong> - Next.js pages & layouts</li>
        <li><strong>components/</strong> - Atomic design UI</li>
        <li><strong>lib/</strong> - Services & utilities</li>
        <li><strong>services/</strong> - Discord bot, agents</li>
        <li><strong>supabase/</strong> - Migrations</li>
    </ul>`
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>',
    'task',
    'Important Files',
    `<ul style="margin:0;padding-left:16px;font-family:monospace;font-size:11px;">
        <li><code>middleware.ts</code> - Auth protection</li>
        <li><code>lib/branding/BrandingContext.tsx</code> - White-label</li>
        <li><code>lib/supabase/client.ts</code> - DB client</li>
        <li><code>app/api/**</code> - API routes</li>
    </ul>`
)}`;
            }

            // Check if asking about a specific component from the current context
            if (hoveredNode && (lower.includes('this') || lower.includes('more') || lower.includes('detail') || lower.includes('explain'))) {
                const context = getComponentContext(hoveredNode);
                return `<strong style="color: var(--hg-cyan);">${context.title}</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>',
    context.status === 'active' ? 'status' : context.status === 'blocked' ? 'blocker' : 'info',
    'Overview',
    `<p style="margin:0 0 8px 0;">${context.description}</p>
    <p style="margin:0;font-size:11px;"><strong>Tech:</strong> ${context.tech.join(', ')}</p>
    <p style="margin:0;font-size:11px;"><strong>Files:</strong> <code>${context.files[0]}</code></p>`,
    [{label: 'Add Task', action: `openNoteModal('Work on ${context.title}')`, primary: true}]
)}`;
            }

            // PRD - Product Requirements Document
            if (lower.includes('prd') || lower.includes('requirements') || lower.includes('product document') || lower.includes('product req')) {
                return `<strong style="color: var(--hg-blue);"> Product Requirements Document</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>',
    'info',
    'Product Vision',
    `<p style="margin:0;"><strong>Vision:</strong> AI-Powered Maturity Assessment & Transformation Platform</p>
    <p style="margin:8px 0 0 0;font-size:11px;">Help organizations measure, understand, and improve their AI readiness through expert-guided assessments, actionable insights, and continuous learning.</p>`
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/>',
    'task',
    'Core Modules',
    `<ul style="margin:0;padding-left:16px;font-size:11px;">
        <li><strong>Assessment Engine</strong>  Complete</li>
        <li><strong>White-Label System</strong>  65%</li>
        <li><strong>Expert Marketplace</strong>  Q2 2026</li>
        <li><strong>Learning Management</strong>  Q2 2026</li>
        <li><strong>Analytics Dashboard</strong>  Q3 2026</li>
    </ul>`,
    [{label: 'View Milestones', action: "askAI('milestones')", primary: true}, {label: 'View Roadmap', action: "loadDiagram('roadmap', this)"}]
)}`;
            }

            // MILESTONES - Project milestones
            if (lower.includes('milestone') || lower.includes('timeline') || lower.includes('goal') || lower.includes('quarter')) {
                return `<strong style="color: var(--hg-green);"> Project Milestones</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>',
    'status',
    'Completed ',
    `<ul style="margin:0;padding-left:16px;font-size:11px;">
        <li>[Dec 2024] Core platform launch</li>
        <li>[Dec 2024] Assessment engine v1</li>
        <li>[Dec 2024] Multi-tenant architecture</li>
        <li>[Dec 2024] 6-role permission system</li>
    </ul>`
)}

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>',
    'warning',
    'Q1 2026 Goals',
    `<ul style="margin:0;padding-left:16px;font-size:11px;">
        <li>[ ] Stripe payment integration</li>
        <li>[ ] Expert payout system</li>
        <li>[ ] Zoom video integration</li>
        <li>[ ] Workshop scheduling</li>
    </ul>`,
    [{label: 'View Roadmap', action: "loadDiagram('roadmap', this)", primary: true}]
)}`;
            }

            // MINDMAP - System visualization
            if (lower.includes('mind') || lower.includes('map') || lower.includes('visualization') || lower.includes('ecosystem')) {
                return `<strong style="color: var(--hg-cyan);"> Platform Mind Map</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>',
    'info',
    'Interactive Visualization',
    `<p style="margin:0;">The Mind Map view shows the HumanGlue platform ecosystem as an interactive, expandable node graph.</p>
    <ul style="margin:8px 0 0 0;padding-left:16px;font-size:11px;">
        <li>Click nodes to expand/collapse children</li>
        <li>Add new nodes from the palette</li>
        <li>Blocked integrations shown with </li>
    </ul>`,
    [{label: 'Open Mind Map', action: "loadDiagram('mindmap', this)", primary: true}]
)}`;
            }

            // SPRINT - Kanban board
            if (lower.includes('sprint') || lower.includes('kanban') || lower.includes('board')) {
                const totalPoints = sprintTasks.reduce((sum, t) => sum + t.points, 0);
                const donePoints = sprintTasks.filter(t => t.status === 'done').reduce((sum, t) => sum + t.points, 0);
                const progressPercent = Math.round((donePoints / totalPoints) * 100);

                return `<strong style="color: var(--hg-cyan);"> Sprint 12 Status</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>',
    'status',
    'Sprint Progress',
    `<p style="margin:0;"><strong>${progressPercent}%</strong> complete (${donePoints}/${totalPoints} story points)</p>
    <ul style="margin:8px 0 0 0;padding-left:16px;font-size:11px;">
        <li><strong>${sprintTasks.filter(t => t.status === 'progress').length}</strong> tasks in progress</li>
        <li><strong>${sprintTasks.filter(t => t.status === 'done').length}</strong> tasks completed</li>
        <li><strong>${sprintTasks.filter(t => t.status === 'todo' || t.status === 'backlog').length}</strong> tasks remaining</li>
    </ul>`,
    [{label: 'Open Sprint Board', action: "loadDiagram('sprint', this)", primary: true}]
)}`;
            }

            // Standard knowledge base responses
            if (lower.includes('stripe') || lower.includes('payment')) return aiKnowledge.stripe;
            if (lower.includes('zoom') || lower.includes('video')) return aiKnowledge.zoom;
            if (lower.includes('white') || lower.includes('label') || lower.includes('brand')) return aiKnowledge['white-label'];
            if (lower.includes('assess')) return aiKnowledge.assessment;
            if (lower.includes('database') || lower.includes('schema') || lower.includes('table') || lower.includes('supabase')) return aiKnowledge.database;
            if (lower.includes('role') || lower.includes('permission') || lower.includes('admin')) return aiKnowledge.roles;
            if (lower.includes('discord') || lower.includes('bot')) return aiKnowledge.discord;

            // Default with action cards
            return `<strong style="color: var(--hg-cyan);"> HumanGlue AI Assistant</strong>

${createActionCard(
    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>',
    'info',
    'I can help with',
    `<ul style="margin:0;padding-left:16px;">
        <li><strong>Architecture</strong> - Platform design & data flow</li>
        <li><strong>Features</strong> - Implementation details</li>
        <li><strong>Integrations</strong> - Stripe, Zoom, VAPI, etc.</li>
        <li><strong>Database</strong> - Schema & queries</li>
        <li><strong>Tasks</strong> - Planning & tracking</li>
    </ul>`,
    [{label: 'Project Status', action: "askAI('project status')", primary: true}, {label: 'Next Steps', action: "askAI('next steps')"}]
)}

<p style="font-size:12px;color:#6b7280;margin-top:8px;">Use the quick buttons below or click on diagram nodes for context!</p>`;
        }

        // Filter notes helper for AI actions
        function filterNotes(filter) {
            currentFilter = filter;
            renderNotes();
            switchTab('tasks', document.querySelector('.panel-tab'));
        }

        // ==========================================
        // AI TOOLTIP FUNCTIONS
        // ==========================================

        // Extract node ID from Mermaid SVG element
        function extractNodeId(node) {
            // Try to get ID from element or parent
            const id = node.id || node.closest('[id]')?.id || '';
            // Extract the meaningful part (e.g., "flowchart-Browser-123" -> "Browser")
            const match = id.match(/flowchart-(\w+)-\d+/) || id.match(/(\w+)/);
            if (match) return match[1];
            // Fallback to text content
            const text = node.textContent?.trim() || '';
            // Try to match known component names
            const knownComponents = Object.keys(componentContext);
            for (const comp of knownComponents) {
                if (text.toLowerCase().includes(comp.toLowerCase())) {
                    return comp;
                }
            }
            return text.split(/[\s\n]/)[0]; // First word
        }

        // Get component context for a node
        function getComponentContext(nodeId) {
            // Try exact match first
            if (componentContext[nodeId]) return componentContext[nodeId];

            // Try case-insensitive match
            const lowerNodeId = nodeId.toLowerCase();
            for (const [key, value] of Object.entries(componentContext)) {
                if (key.toLowerCase() === lowerNodeId) return value;
            }

            // Try partial match in title
            for (const [key, value] of Object.entries(componentContext)) {
                if (value.title.toLowerCase().includes(lowerNodeId)) return value;
            }

            // Return default with custom title
            return {
                ...componentContext.default,
                title: nodeId
            };
        }

        // Show AI tooltip with context
        function showAITooltip(nodeId, text, x, y) {
            hoveredNode = nodeId;
            const context = getComponentContext(nodeId);
            const tooltip = document.getElementById('aiTooltip');

            // Update content
            document.getElementById('aiTooltipTitle').textContent = context.title;

            const statusColors = {
                'active': '#10B981',
                'blocked': '#EF4444',
                'planned': '#3B82F6',
                'in-progress': '#F59E0B'
            };
            const statusText = {
                'active': ' Active',
                'blocked': ' Blocked',
                'planned': ' Planned',
                'in-progress': ' In Progress'
            };

            document.getElementById('aiTooltipContent').innerHTML = `
                <p style="margin-bottom: 12px;">${context.description}</p>
                <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 8px;">
                    ${context.tech.map(t => `<span style="background: rgba(97, 216, 254, 0.1); padding: 2px 8px; border-radius: 4px; font-size: 11px; color: var(--hg-cyan);">${t}</span>`).join('')}
                </div>
                <div style="font-size: 12px; color: #6b7280;">
                    <span style="color: ${statusColors[context.status] || '#9ca3af'}">${statusText[context.status] || context.status}</span>
                     Files: <code style="background: rgba(0,0,0,0.3); padding: 1px 4px; border-radius: 3px;">${context.files[0]}</code>
                </div>
            `;

            // Position tooltip
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const tooltipWidth = 400;
            const tooltipHeight = 250;

            let left = x + 10;
            let top = y + 10;

            // Prevent going off right edge
            if (left + tooltipWidth > viewportWidth - 20) {
                left = x - tooltipWidth - 10;
            }
            // Prevent going off bottom edge
            if (top + tooltipHeight > viewportHeight - 20) {
                top = y - tooltipHeight - 10;
            }

            tooltip.style.left = `${Math.max(10, left)}px`;
            tooltip.style.top = `${Math.max(10, top)}px`;
            tooltip.classList.add('visible');
        }

        function hideAITooltip() {
            document.getElementById('aiTooltip').classList.remove('visible');
        }

        // Ask AI about the current node
        function askAIAboutNode() {
            hideAITooltip();
            // Switch to AI chat tab
            switchTab('chat', document.querySelectorAll('.panel-tab')[1]);
            // Pre-fill with question about the node
            if (hoveredNode) {
                const context = getComponentContext(hoveredNode);
                document.getElementById('chatInput').value = `Tell me more about ${context.title}`;
                document.getElementById('chatInput').focus();
            }
        }

        // Add a task from the current node context
        function addTaskFromNode() {
            hideAITooltip();
            if (hoveredNode) {
                const context = getComponentContext(hoveredNode);
                openNoteModal(context.relatedTasks[0] || `Work on ${context.title}`);
                // Pre-fill component
                setTimeout(() => {
                    document.getElementById('noteDescription').value = `Related to: ${context.title}\n\n${context.description.substring(0, 150)}...`;
                }, 100);
            }
        }

        // Close tooltip when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.ai-tooltip') && !e.target.closest('.node') && !e.target.closest('.cluster')) {
                hideAITooltip();
            }
        });

        // ==========================================
        // ROADMAP MODAL FUNCTIONS
        // ==========================================

        function openRoadmapModal(itemId = null) {
            editingRoadmapId = itemId;

            if (itemId) {
                const item = roadmapItems.find(i => i.id === itemId);
                if (item) {
                    document.getElementById('roadmapModalTitle').textContent = 'Edit Timeline Item';
                    document.getElementById('roadmapTitle').value = item.title;
                    document.getElementById('roadmapQuarter').value = item.quarter;
                    document.getElementById('roadmapDuration').value = item.duration;
                    document.getElementById('roadmapStartDate').value = item.start_date;
                    document.getElementById('roadmapStatus').value = item.status;
                    document.getElementById('roadmapDescription').value = item.description || '';
                    document.getElementById('roadmapDependencies').value = item.dependencies || '';
                    document.getElementById('deleteRoadmapBtn').style.display = 'block';
                }
            } else {
                document.getElementById('roadmapModalTitle').textContent = 'Add Timeline Item';
                document.getElementById('roadmapTitle').value = '';
                document.getElementById('roadmapQuarter').value = 'Q1 2026';
                document.getElementById('roadmapDuration').value = 30;
                document.getElementById('roadmapStartDate').value = '2026-01-01';
                document.getElementById('roadmapStatus').value = 'planned';
                document.getElementById('roadmapDescription').value = '';
                document.getElementById('roadmapDependencies').value = '';
                document.getElementById('deleteRoadmapBtn').style.display = 'none';
            }

            document.getElementById('roadmapModal').classList.add('active');
        }

        function closeRoadmapModal() {
            document.getElementById('roadmapModal').classList.remove('active');
            editingRoadmapId = null;
        }

        async function saveRoadmapItem() {
            const title = document.getElementById('roadmapTitle').value.trim();
            if (!title) {
                alert('Please enter a feature name');
                return;
            }

            const itemData = {
                title,
                quarter: document.getElementById('roadmapQuarter').value,
                duration: parseInt(document.getElementById('roadmapDuration').value) || 30,
                start_date: document.getElementById('roadmapStartDate').value,
                status: document.getElementById('roadmapStatus').value,
                description: document.getElementById('roadmapDescription').value.trim(),
                dependencies: document.getElementById('roadmapDependencies').value.trim()
            };

            try {
                if (editingRoadmapId) {
                    const { error } = await supabase
                        .from('roadmap_items')
                        .update(itemData)
                        .eq('id', editingRoadmapId);
                    if (error) throw error;
                } else {
                    const { error } = await supabase
                        .from('roadmap_items')
                        .insert([itemData]);
                    if (error) throw error;
                }

                await loadRoadmapItems();
                if (currentDiagram === 'roadmap') {
                    renderInteractiveGantt();
                }
                closeRoadmapModal();
            } catch (err) {
                console.error('Error saving roadmap item:', err);
                // Fallback to local storage for demo
                if (editingRoadmapId) {
                    const index = roadmapItems.findIndex(i => i.id === editingRoadmapId);
                    if (index >= 0) {
                        roadmapItems[index] = { ...roadmapItems[index], ...itemData };
                    }
                } else {
                    roadmapItems.push({ id: Date.now().toString(), ...itemData });
                }
                localStorage.setItem('hg_roadmap_items', JSON.stringify(roadmapItems));
                if (currentDiagram === 'roadmap') {
                    renderInteractiveGantt();
                }
                closeRoadmapModal();
            }
        }

        async function deleteRoadmapItem() {
            if (!editingRoadmapId || !confirm('Delete this timeline item?')) return;

            try {
                const { error } = await supabase
                    .from('roadmap_items')
                    .delete()
                    .eq('id', editingRoadmapId);
                if (error) throw error;

                await loadRoadmapItems();
            } catch (err) {
                console.error('Error deleting roadmap item:', err);
                roadmapItems = roadmapItems.filter(i => i.id !== editingRoadmapId);
                localStorage.setItem('hg_roadmap_items', JSON.stringify(roadmapItems));
            }

            if (currentDiagram === 'roadmap') {
                renderInteractiveGantt();
            }
            closeRoadmapModal();
        }

        async function loadRoadmapItems() {
            try {
                const { data, error } = await supabase
                    .from('roadmap_items')
                    .select('*')
                    .order('start_date', { ascending: true });

                if (error) throw error;
                roadmapItems = data || [];
            } catch (err) {
                console.log('Using local roadmap items:', err.message);
                // Fallback to localStorage or default items
                const stored = localStorage.getItem('hg_roadmap_items');
                if (stored) {
                    roadmapItems = JSON.parse(stored);
                } else {
                    // Initialize with default roadmap items
                    roadmapItems = [
                        { id: '1', title: 'Payment System', quarter: 'Q1 2026', start_date: '2026-01-01', duration: 90, status: 'planned', description: 'Stripe integration for subscriptions and payments' },
                        { id: '2', title: 'Stripe Integration', quarter: 'Q1 2026', start_date: '2026-01-01', duration: 30, status: 'planned', description: 'Payment processing setup' },
                        { id: '3', title: 'Video Conferencing', quarter: 'Q1 2026', start_date: '2026-01-15', duration: 90, status: 'planned', description: 'Zoom integration for workshops and consultations' },
                        { id: '4', title: 'Advanced LMS', quarter: 'Q2 2026', start_date: '2026-04-01', duration: 90, status: 'planned', description: 'Full course builder with progress tracking' },
                        { id: '5', title: 'Expert Marketplace', quarter: 'Q2 2026', start_date: '2026-04-15', duration: 90, status: 'planned', description: 'Expert profiles and booking system' },
                        { id: '6', title: 'Advanced Analytics', quarter: 'Q3 2026', start_date: '2026-07-01', duration: 90, status: 'planned', description: 'AI insights and custom report builder' },
                        { id: '7', title: 'Mobile Experience', quarter: 'Q4 2026', start_date: '2026-10-01', duration: 90, status: 'planned', description: 'PWA optimization and native apps' }
                    ];
                }
            }
        }

        // ==========================================
        // GTM STRATEGY RENDERER
        // ==========================================

        function renderGTMStrategy() {
            const container = document.getElementById('mermaidDiagram');
            container.innerHTML = `
                <div class="gtm-page-wrapper">
                    <div class="gtm-container">
                    <!-- Header with Edit Mode Toggle -->
                    <div class="gtm-header">
                        <div class="gtm-title-section">
                            <h1 class="gtm-title">HumanGlue GTM Strategy</h1>
                            <p class="gtm-subtitle">Analog to Automated - 90-Day Execution Plan</p>
                        </div>
                        <div class="gtm-controls">
                            <button class="btn btn-secondary" onclick="askGTMAI()">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                </svg>
                                Ask AI About GTM
                            </button>
                            <div style="font-size: 12px; color: #9ca3af; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Click any section to edit
                            </div>
                        </div>
                    </div>

                    <!-- URGENT: WORKSHOPS SECTION -->
                    <div class="gtm-urgent-card">
                        <div class="gtm-urgent-badge"> IMMEDIATE REVENUE OPPORTUNITY</div>
                        <h2 class="gtm-urgent-title">Workshops: Drive Revenue NOW</h2>
                        <p class="gtm-urgent-description">
                            <strong>We can run these TODAY</strong> to generate immediate revenue and put pressure on the company to perform. Both web and in-person options available.
                        </p>

                        <div class="gtm-workshop-grid">
                            <!-- Web Workshops -->
                            <div class="gtm-workshop-card web">
                                <div class="gtm-workshop-header">
                                    <div class="gtm-workshop-icon web"></div>
                                    <div>
                                        <h3 class="gtm-workshop-title web">Web Workshops</h3>
                                        <div class="gtm-workshop-meta">Virtual  Scalable</div>
                                    </div>
                                </div>
                                <div class="gtm-editable" contenteditable="false" data-section="workshop-web">
                                    <strong class="gtm-pricing web">Pricing: $2,500 - $5,000</strong><br><br>
                                    <strong>3-Hour AI Strategy Workshop:</strong><br>
                                     The 5-stage AI maturity model<br>
                                     Common mistakes at each stage<br>
                                     30-day quick wins<br>
                                     ROI calculation framework<br>
                                     Real case studies<br><br>
                                    <strong>Target:</strong> CTOs, VPs, transformation teams<br>
                                    <strong>Capacity:</strong> Up to 50 participants<br>
                                    <strong>Tools:</strong> Zoom, Miro, follow-up materials
                                </div>
                                <button onclick="copyWorkshopTemplate('web')" class="btn btn-secondary gtm-btn-full">
                                     Copy Workshop Outline
                                </button>
                            </div>

                            <!-- In-Person Workshops -->
                            <div class="gtm-workshop-card inperson">
                                <div class="gtm-workshop-header">
                                    <div class="gtm-workshop-icon inperson"></div>
                                    <div>
                                        <h3 class="gtm-workshop-title inperson">In-Person Workshops</h3>
                                        <div class="gtm-workshop-meta">On-site  Premium</div>
                                    </div>
                                </div>
                                <div class="gtm-editable" contenteditable="false" data-section="workshop-inperson">
                                    <strong class="gtm-pricing inperson">Pricing: $10,000 - $15,000</strong><br><br>
                                    <strong>Full-Day Implementation Workshop:</strong><br>
                                     Hands-on AI tool setup<br>
                                     Live process mapping<br>
                                     Custom use case development<br>
                                     Team collaboration exercises<br>
                                     90-day roadmap creation<br><br>
                                    <strong>Target:</strong> Enterprise teams 10-50 people<br>
                                    <strong>Includes:</strong> Travel, materials, 30-day follow-up<br>
                                    <strong>Location:</strong> Client site or workshop venue
                                </div>
                                <button onclick="copyWorkshopTemplate('inperson')" class="btn btn-secondary gtm-btn-full">
                                     Copy Workshop Outline
                                </button>
                            </div>
                        </div>

                        <!-- Workshop Action Items -->
                        <div class="gtm-actions-container">
                            <h4 class="gtm-actions-title">THIS WEEK'S ACTION ITEMS:</h4>
                            <div class="gtm-actions-grid">
                                <div class="gtm-action-card">
                                    <strong class="gtm-action-day">Day 1-2:</strong>
                                    <div class="gtm-action-tasks">
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-1-1" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Finalize workshop deck</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-1-2" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Create registration page</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-1-3" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Draft outreach email</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-1-4" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">List 20 target companies</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="gtm-action-card">
                                    <strong class="gtm-action-day">Day 3-4:</strong>
                                    <div class="gtm-action-tasks">
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-2-1" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Send 15 personalized emails</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-2-2" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Post on LinkedIn</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-2-3" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Set up Zoom/venue</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-2-4" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Book first workshop date</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="gtm-action-card">
                                    <strong class="gtm-action-day">Day 5-7:</strong>
                                    <div class="gtm-action-tasks">
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-3-1" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Follow up with interested leads</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-3-2" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Confirm first booking</span>
                                        </div>
                                        <div class="gtm-task-item">
                                            <input type="checkbox" class="gtm-checkbox" data-task-id="task-3-3" onchange="handleGTMCheckbox(this)">
                                            <span class="gtm-task-text">Prepare materials</span>
                                        </div>
                                        <div class="gtm-task-item" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);">
                                            <strong style="color: var(--hg-amber);">GOAL: 1 WORKSHOP BOOKED </strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Tabs - Sticky -->
                    <div class="gtm-tabs gtm-tabs-sticky">
                        <button class="gtm-tab active" onclick="switchGTMTab('overview')" data-tab="overview"> Overview</button>
                        <button class="gtm-tab" onclick="switchGTMTab('phases')" data-tab="phases"> 90-Day Phases</button>
                        <button class="gtm-tab" onclick="switchGTMTab('tracker')" data-tab="tracker"> Daily Tasks</button>
                        <button class="gtm-tab" onclick="switchGTMTab('communication')" data-tab="communication"> Templates</button>
                        <button class="gtm-tab" onclick="switchGTMTab('metrics')" data-tab="metrics"> Metrics</button>
                        <button class="gtm-tab" onclick="switchGTMTab('gantt')" data-tab="gantt"> Gantt Chart</button>
                    </div>

                    <!-- Tab Content -->
                    <div id="gtmTabContent"></div>
                    </div><!-- gtm-container -->
                </div><!-- gtm-page-wrapper -->
            `;

            // Initialize with overview tab
            switchGTMTab('overview');

            // Load saved task states from localStorage
            setTimeout(() => {
                loadGTMTaskStates();
                updateGTMProgress();
            }, 100);
        }


        // B2C Workshops Execution Roadmap Renderer
        function renderB2CWorkshops() {
            const container = document.getElementById('mermaidDiagram');

            container.innerHTML = `
                <div class="gtm-page-wrapper">
                    <div class="gtm-container">
                        <!-- Header with Controls -->
                        <div class="gtm-header">
                            <div class="gtm-title-section">
                                <h1 class="gtm-title">B2C Workshop Launch Roadmap</h1>
                                <p class="gtm-subtitle">150-Day Execution Plan  Build  Market  Sell</p>
                            </div>
                            <div class="gtm-controls">
                                <button class="btn btn-secondary" onclick="toggleB2CEditMode()">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                    </svg>
                                    Edit Mode
                                </button>
                                <button class="btn btn-primary" onclick="showB2CGantt()">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                    </svg>
                                    View Gantt Chart
                                </button>
                                <div class="gtm-progress-container">
                                    <div class="gtm-progress-text">
                                        <span id="b2c-progress">0%</span> Complete
                                    </div>
                                    <div class="gtm-progress-bar">
                                        <div class="gtm-progress-fill" id="b2c-progress-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Navigation Tabs - Sticky -->
                        <div class="gtm-tabs gtm-tabs-sticky">
                            <button class="gtm-tab active" onclick="switchB2CTab('roadmap')" data-tab="roadmap"> Roadmap</button>
                            <button class="gtm-tab" onclick="switchB2CTab('products')" data-tab="products"> Products</button>
                            <button class="gtm-tab" onclick="switchB2CTab('build')" data-tab="build"> Build</button>
                            <button class="gtm-tab" onclick="switchB2CTab('market')" data-tab="market"> Market</button>
                            <button class="gtm-tab" onclick="switchB2CTab('sell')" data-tab="sell"> Sell</button>
                            <button class="gtm-tab" onclick="switchB2CTab('gantt')" data-tab="gantt"> Gantt</button>
                        </div>

                        <!-- Tab Content -->
                        <div id="b2cTabContent"></div>
                    </div><!-- gtm-container -->
                </div><!-- gtm-page-wrapper -->
            `;

            // Initialize with roadmap tab
            switchB2CTab('roadmap');

            // Load saved task states from localStorage
            setTimeout(() => {
                loadB2CTaskStates();
                updateB2CProgress();
            }, 100);
        }

        // B2C Tab Switching
        function switchB2CTab(tabName) {
            // Update active tab
            document.querySelectorAll('.gtm-tab[data-tab]').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabName);
            });

            const content = document.getElementById('b2cTabContent');

            if (tabName === 'roadmap') {
                content.innerHTML = renderB2CRoadmapContent();
            } else if (tabName === 'products') {
                content.innerHTML = renderB2CProductsContent();
            } else if (tabName === 'build') {
                content.innerHTML = renderB2CBuildContent();
            } else if (tabName === 'market') {
                content.innerHTML = renderB2CMarketContent();
            } else if (tabName === 'sell') {
                content.innerHTML = renderB2CSellContent();
            } else if (tabName === 'gantt') {
                content.innerHTML = renderB2CGanttContent();
            }

            // Re-bind checkbox handlers
            setTimeout(() => {
                loadB2CTaskStates();
                updateB2CProgress();
            }, 50);
        }

        // Render B2C Roadmap Content (original phases)
        function renderB2CRoadmapContent() {
            return `
                <div class="gtm-content">
                        <!-- PHASE 1: Foundation & Planning (Week 1-2) -->
                        <div class="gtm-phase">
                            <div class="gtm-phase-header">
                                <div class="gtm-phase-title"> PHASE 1: Foundation & Planning</div>
                                <div class="gtm-phase-meta">Week 1-2 | Foundation</div>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Week 1: Workshop Strategy & Content Design</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-1-1" onchange="handleB2CCheckbox(this)">
                                        <span>Define 3-5 workshop topics based on HumanGlue components (Assessment, Data Strategy, Change Management, ROI Modeling, Automation)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-1-2" onchange="handleB2CCheckbox(this)">
                                        <span>Create workshop curriculum outline for each topic: learning objectives, modules, exercises, deliverables</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-1-3" onchange="handleB2CCheckbox(this)">
                                        <span>Design workshop format: 90-minute live sessions with 20-min presentation, 40-min hands-on, 30-min Q&A</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-1-4" onchange="handleB2CCheckbox(this)">
                                        <span>Set pricing strategy: Individual ($99-199), Small team 3-5 ($399), Large team 6-10 ($699)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-1-5" onchange="handleB2CCheckbox(this)">
                                        <span>Create workshop calendar: Plan 2 workshops per month, alternating beginner/intermediate topics</span>
                                    </li>
                                </ul>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Week 2: Content Creation & Materials</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-2-1" onchange="handleB2CCheckbox(this)">
                                        <span>Build slide decks for first 2 workshops (30-40 slides each): Intro, Core concepts, Case studies, Exercises, Wrap-up</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-2-2" onchange="handleB2CCheckbox(this)">
                                        <span>Create workshop workbooks (PDF templates): Pre-workshop questionnaire, exercise worksheets, action plan template</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-2-3" onchange="handleB2CCheckbox(this)">
                                        <span>Design hands-on exercises: Real-world scenarios, group activities, individual assessments</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-2-4" onchange="handleB2CCheckbox(this)">
                                        <span>Prepare bonus resources: Templates, checklists, case study library, recommended reading</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-2-5" onchange="handleB2CCheckbox(this)">
                                        <span>Record 2-3 minute promotional videos for each workshop showcasing value and outcomes</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- PHASE 2: Platform Setup & Testing (Week 3-4) -->
                        <div class="gtm-phase">
                            <div class="gtm-phase-header">
                                <div class="gtm-phase-title"> PHASE 2: Platform Setup & Infrastructure</div>
                                <div class="gtm-phase-meta">Week 3-4 | Technical Setup</div>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Week 3: Platform & Registration Setup</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-3-1" onchange="handleB2CCheckbox(this)">
                                        <span>Choose workshop platform: Zoom (live sessions), Teachable/Thinkific (recordings & materials)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-3-2" onchange="handleB2CCheckbox(this)">
                                        <span>Set up payment processing: Stripe for payments, automated invoicing, refund policy</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-3-3" onchange="handleB2CCheckbox(this)">
                                        <span>Create registration landing pages for each workshop with compelling copy, testimonials (if available), pricing</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-3-4" onchange="handleB2CCheckbox(this)">
                                        <span>Build automated email sequences: Registration confirmation, 7-day reminder, 1-day reminder, post-workshop follow-up</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-3-5" onchange="handleB2CCheckbox(this)">
                                        <span>Set up analytics tracking: Registration conversions, attendance rates, post-workshop engagement</span>
                                    </li>
                                </ul>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Week 4: Beta Testing & Refinement</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-4-1" onchange="handleB2CCheckbox(this)">
                                        <span>Recruit 10-15 beta testers (colleagues, customers, network) for free pilot workshop</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-4-2" onchange="handleB2CCheckbox(this)">
                                        <span>Run beta workshop and test: Content flow, timing, tech setup, engagement level, exercise effectiveness</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-4-3" onchange="handleB2CCheckbox(this)">
                                        <span>Collect detailed feedback via survey: Content clarity, pacing, value delivered, what to improve</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-4-4" onchange="handleB2CCheckbox(this)">
                                        <span>Refine content based on feedback: Update slides, adjust timing, improve exercises, add missing elements</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-4-5" onchange="handleB2CCheckbox(this)">
                                        <span>Request testimonials and video reviews from beta participants for marketing</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- PHASE 3: Marketing & Launch (Week 5-6) -->
                        <div class="gtm-phase">
                            <div class="gtm-phase-header">
                                <div class="gtm-phase-title"> PHASE 3: Marketing & Launch</div>
                                <div class="gtm-phase-meta">Week 5-6 | Go-to-Market</div>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Week 5: Marketing Campaign Setup</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-5-1" onchange="handleB2CCheckbox(this)">
                                        <span>Build email list: Import contacts, create lead magnet (free mini-assessment), set up opt-in forms</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-5-2" onchange="handleB2CCheckbox(this)">
                                        <span>Create LinkedIn content calendar: 3 posts/week for 4 weeks promoting workshop value, case studies, testimonials</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-5-3" onchange="handleB2CCheckbox(this)">
                                        <span>Design social media assets: Workshop graphics, quote cards, teaser videos (15-30 sec each)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-5-4" onchange="handleB2CCheckbox(this)">
                                        <span>Set up paid ads: LinkedIn/Facebook ads targeting professionals in AI/transformation roles, budget $500/month</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-5-5" onchange="handleB2CCheckbox(this)">
                                        <span>Partner outreach: Contact 5-10 complementary businesses for co-marketing opportunities</span>
                                    </li>
                                </ul>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Week 6: Launch Campaign Execution</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-6-1" onchange="handleB2CCheckbox(this)">
                                        <span>Launch email campaign: Announcement email to full list, early bird pricing (20% off for first 20 registrations)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-6-2" onchange="handleB2CCheckbox(this)">
                                        <span>Daily social posting: Share countdown, testimonials, behind-the-scenes content, value highlights</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-6-3" onchange="handleB2CCheckbox(this)">
                                        <span>Host free webinar preview: 30-minute taste of workshop content to drive registrations</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-6-4" onchange="handleB2CCheckbox(this)">
                                        <span>Personal outreach: Email 50 warm contacts with personalized invite and exclusive discount code</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-6-5" onchange="handleB2CCheckbox(this)">
                                        <span>Goal: 15-30 registrations for first workshop</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- PHASE 4: Delivery & Operations (Ongoing) -->
                        <div class="gtm-phase">
                            <div class="gtm-phase-header">
                                <div class="gtm-phase-title"> PHASE 4: Delivery & Operations</div>
                                <div class="gtm-phase-meta">Ongoing | Execution</div>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Workshop Delivery Checklist (Per Workshop)</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-1" onchange="handleB2CCheckbox(this)">
                                        <span><strong>T-7 days:</strong> Send welcome email with pre-workshop questionnaire, calendar invite, preparation materials</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-2" onchange="handleB2CCheckbox(this)">
                                        <span><strong>T-1 day:</strong> Send reminder email with Zoom link, agenda, what to bring (notebook, specific tools)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-3" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Workshop Day -30 min:</strong> Tech check - test Zoom, slides, screen sharing, breakout rooms</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-4" onchange="handleB2CCheckbox(this)">
                                        <span><strong>During Workshop:</strong> Record session, engage participants, run exercises, capture Q&A for future content</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-5" onchange="handleB2CCheckbox(this)">
                                        <span><strong>T+2 hours:</strong> Send thank you email with recording, resources, homework, feedback survey</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-6" onchange="handleB2CCheckbox(this)">
                                        <span><strong>T+3 days:</strong> Send follow-up with additional resources, upsell offer (1-on-1 consulting, next workshop)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-7-7" onchange="handleB2CCheckbox(this)">
                                        <span><strong>T+7 days:</strong> Request testimonials and referrals from satisfied participants</span>
                                    </li>
                                </ul>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Monthly Operations Rhythm</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-8-1" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Week 1:</strong> Launch registration for next month's workshops (2 workshops scheduled)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-8-2" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Week 2:</strong> Deliver Workshop #1, process feedback, send recordings, upsell offers</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-8-3" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Week 3:</strong> Prepare for Workshop #2, update content based on Week 2 feedback</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-8-4" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Week 4:</strong> Deliver Workshop #2, monthly metrics review, plan next month's topics</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-8-5" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Ongoing:</strong> Build email list, create content library from recordings, refine offerings based on data</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- PHASE 5: Scale & Optimize (Month 3+) -->
                        <div class="gtm-phase">
                            <div class="gtm-phase-header">
                                <div class="gtm-phase-title"> PHASE 5: Scale & Optimize</div>
                                <div class="gtm-phase-meta">Month 3+ | Growth</div>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Scaling Strategies</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-9-1" onchange="handleB2CCheckbox(this)">
                                        <span>Convert live workshops to on-demand courses: Edit recordings, add modules, create self-serve version at $49-99</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-9-2" onchange="handleB2CCheckbox(this)">
                                        <span>Create workshop bundles: "AI Transformation Mastery" - 3 workshops for $399 (save 20%)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-9-3" onchange="handleB2CCheckbox(this)">
                                        <span>Build private community: Slack/Discord for workshop alumni, monthly office hours, peer learning</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-9-4" onchange="handleB2CCheckbox(this)">
                                        <span>Launch certification program: Advanced track with assessments, projects, certificate upon completion - $999</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-9-5" onchange="handleB2CCheckbox(this)">
                                        <span>Partner with companies for corporate training: Custom workshops for teams 10-50 people, $5K-15K per engagement</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-9-6" onchange="handleB2CCheckbox(this)">
                                        <span>Build referral program: Give $25, Get $25 for each referral who attends workshop</span>
                                    </li>
                                </ul>
                            </div>

                            <div class="gtm-section">
                                <h3 class="gtm-section-title">Key Metrics to Track</h3>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-10-1" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Registration Rate:</strong> Website visitors  Registrations (Target: 5-10%)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-10-2" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Attendance Rate:</strong> Registrations  Actual attendees (Target: 60-70%)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-10-3" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Satisfaction Score:</strong> Post-workshop NPS (Target: 8+/10)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-10-4" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Revenue per Workshop:</strong> Average revenue (Target: $1,500-3,000 per workshop)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-10-5" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Repeat Rate:</strong> Attendees who take 2+ workshops (Target: 30-40%)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="b2c-10-6" onchange="handleB2CCheckbox(this)">
                                        <span><strong>Referral Rate:</strong> Attendees who refer others (Target: 20%)</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render B2C Products Content
        function renderB2CProductsContent() {
            return `
                <div class="gtm-content">
                    <div class="gtm-phase">
                        <div class="gtm-phase-header">
                            <div class="gtm-phase-title"> Workshop Products Portfolio</div>
                            <div class="gtm-phase-meta">6 Core Workshops | Beginner to Advanced</div>
                        </div>

                        <!-- Product 1: AI Maturity Assessment Basics -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Workshop 1: AI Maturity Assessment Basics</h3>
                            <div class="gtm-editable-task" contenteditable="false" data-section="product-1">
                                <strong>Target Audience:</strong> Business leaders new to AI transformation<br>
                                <strong>Duration:</strong> 90 minutes (20min presentation + 40min hands-on + 30min Q&A)<br>
                                <strong>Pricing:</strong> Individual $99 | Team 3-5 $299 | Team 6-10 $499<br><br>

                                <strong>Learning Objectives:</strong><br>
                                 Understand the 5-stage AI maturity model (Aware  Basic  Intermediate  Advanced  Optimized)<br>
                                 Identify your organization's current maturity level<br>
                                 Recognize common mistakes at each stage<br>
                                 Map out 30-day quick wins based on your level<br><br>

                                <strong>Key Topics:</strong><br>
                                 What is AI maturity and why it matters<br>
                                 The 5 maturity levels explained with examples<br>
                                 Self-assessment exercise (interactive)<br>
                                 Common pitfalls to avoid<br>
                                 Building your 30-day action plan<br><br>

                                <strong>Deliverables:</strong><br>
                                 Maturity assessment scorecard<br>
                                 30-day quick wins template<br>
                                 Case study library (5 real examples)<br>
                                 Access to recording for 30 days
                            </div>
                        </div>

                        <!-- Product 2: Data Strategy Foundations -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Workshop 2: Data Strategy Foundations</h3>
                            <div class="gtm-editable-task" contenteditable="false" data-section="product-2">
                                <strong>Target Audience:</strong> Data leaders, analysts, transformation teams<br>
                                <strong>Duration:</strong> 90 minutes<br>
                                <strong>Pricing:</strong> Individual $129 | Team 3-5 $349 | Team 6-10 $599<br><br>

                                <strong>Learning Objectives:</strong><br>
                                 Map your current data landscape and identify silos<br>
                                 Design a modern data architecture roadmap<br>
                                 Understand data governance fundamentals<br>
                                 Calculate data ROI and build business cases<br><br>

                                <strong>Key Topics:</strong><br>
                                 Data architecture patterns for AI readiness<br>
                                 Breaking down data silos<br>
                                 Data quality assessment frameworks<br>
                                 Real-time vs. batch processing decisions<br>
                                 Building a data governance framework<br><br>

                                <strong>Deliverables:</strong><br>
                                 Data landscape mapping template<br>
                                 Architecture decision framework<br>
                                 Data governance checklist<br>
                                 ROI calculator spreadsheet
                            </div>
                        </div>

                        <!-- Product 3: Change Management for AI -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Workshop 3: Change Management for AI Adoption</h3>
                            <div class="gtm-editable-task" contenteditable="false" data-section="product-3">
                                <strong>Target Audience:</strong> HR leaders, change managers, executives<br>
                                <strong>Duration:</strong> 90 minutes<br>
                                <strong>Pricing:</strong> Individual $149 | Team 3-5 $399 | Team 6-10 $699<br><br>

                                <strong>Learning Objectives:</strong><br>
                                 Predict and address organizational resistance<br>
                                 Build stakeholder buy-in at all levels<br>
                                 Create communication plans for AI initiatives<br>
                                 Measure cultural readiness for AI<br><br>

                                <strong>Key Topics:</strong><br>
                                 Understanding resistance patterns<br>
                                 Stakeholder mapping and engagement<br>
                                 Creating psychological safety for AI experiments<br>
                                 Communication strategies that work<br>
                                 Measuring adoption and cultural shift<br><br>

                                <strong>Deliverables:</strong><br>
                                 Stakeholder mapping canvas<br>
                                 Communication plan template<br>
                                 Cultural readiness assessment<br>
                                 Resistance response playbook
                            </div>
                        </div>

                        <!-- Product 4-6 Summary Cards -->
                        <div class="gtm-actions-container">
                            <div class="gtm-actions-grid">
                                <div class="gtm-action-card">
                                    <strong class="gtm-action-day">Workshop 4:</strong>
                                    <div class="gtm-action-tasks">
                                        <strong>ROI Modeling for AI Initiatives</strong><br>
                                        <small style="color: #9ca3af;">$149 | 90min | CFOs, Finance teams</small><br>
                                        Build compelling business cases, calculate TCO, forecast ROI
                                    </div>
                                </div>
                                <div class="gtm-action-card">
                                    <strong class="gtm-action-day">Workshop 5:</strong>
                                    <div class="gtm-action-tasks">
                                        <strong>Process Automation Discovery</strong><br>
                                        <small style="color: #9ca3af;">$129 | 90min | Operations leaders</small><br>
                                        Identify automation opportunities, prioritize by impact
                                    </div>
                                </div>
                                <div class="gtm-action-card">
                                    <strong class="gtm-action-day">Workshop 6:</strong>
                                    <div class="gtm-action-tasks">
                                        <strong>Skills Gap Analysis & Training</strong><br>
                                        <small style="color: #9ca3af;">$149 | 90min | HR, L&D teams</small><br>
                                        Assess current skills, design upskilling programs
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render B2C Build Content
        function renderB2CBuildContent() {
            return `
                <div class="gtm-content">
                    <div class="gtm-phase">
                        <div class="gtm-phase-header">
                            <div class="gtm-phase-title"> Build Schedule: Days 1-90</div>
                            <div class="gtm-phase-meta">Content Creation  Materials  Systems</div>
                        </div>

                        <!-- Days 1-30: Workshops 1-2 -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Days 1-30: Build Workshops 1-2</h3>
                            <div class="gtm-urgent-card">
                                <div class="gtm-urgent-badge"> Workshop 1: AI Maturity Assessment Basics</div>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-1-1" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 1-3:</strong> Create slide deck (30-40 slides): Title, agenda, intro to AI maturity, 5-level model, case studies, exercises, Q&A</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-1-2" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 4-5:</strong> Design interactive exercises: Self-assessment scorecard, maturity level quiz, gap analysis worksheet</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-1-3" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 6-7:</strong> Build workbook PDF: Pre-workshop questionnaire, note-taking templates, action plan worksheet, resources list</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-1-4" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 8-10:</strong> Compile case study library: 5 real-world examples with before/after metrics, challenges, solutions, results</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-1-5" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 11-12:</strong> Record 2-min promotional video: What attendees will learn, who should attend, testimonial snippets</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-1-6" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 13-15:</strong> Run pilot workshop with 10 beta testers, collect feedback, iterate content</span>
                                    </li>
                                </ul>

                                <div class="gtm-urgent-badge" style="margin-top: 20px;"> Workshop 2: Data Strategy Foundations</div>
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-2-1" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 16-18:</strong> Create slide deck covering data architecture, silos, governance, ROI</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-2-2" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 19-20:</strong> Build data landscape mapping template (Miro/Figma)</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-2-3" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 21-22:</strong> Create ROI calculator spreadsheet with formulas</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-2-4" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 23-25:</strong> Design hands-on exercise: Live data architecture design session</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-2-5" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 26-27:</strong> Record promo video and gather data-specific case studies</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <input type="checkbox" class="gtm-checkbox" data-task-id="build-2-6" onchange="handleB2CCheckbox(this)">
                                        <span class="gtm-editable-task" contenteditable="false"><strong>Day 28-30:</strong> Beta test Workshop 2, refine based on feedback</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Days 31-60: Workshops 3-4 -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Days 31-60: Build Workshops 3-4</h3>
                            <p style="color: #9ca3af; margin-bottom: 16px;">Repeat build process for Change Management (Days 31-45) and ROI Modeling (Days 46-60) workshops</p>
                            <ul class="gtm-task-list">
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="build-3-1" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Build Workshop 3: Change Management (Days 31-45)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="build-3-2" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Build Workshop 4: ROI Modeling (Days 46-60)</span>
                                </li>
                            </ul>
                        </div>

                        <!-- Days 61-90: Workshops 5-6 -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Days 61-90: Build Workshops 5-6</h3>
                            <ul class="gtm-task-list">
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="build-4-1" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Build Workshop 5: Process Automation (Days 61-75)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="build-4-2" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Build Workshop 6: Skills Gap Analysis (Days 76-90)</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render B2C Market Content
        function renderB2CMarketContent() {
            return `
                <div class="gtm-content">
                    <div class="gtm-phase">
                        <div class="gtm-phase-header">
                            <div class="gtm-phase-title"> Marketing Schedule: Days 91-120</div>
                            <div class="gtm-phase-meta">Launch  Promote  Scale</div>
                        </div>

                        <!-- Marketing Week 1 -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Days 91-97: Marketing Foundation</h3>
                            <ul class="gtm-task-list">
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-1" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 91:</strong> Create landing pages for all 6 workshops using Carrd/Webflow</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-2" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 92:</strong> Set up email sequences in Mailchimp/ConvertKit (welcome, reminders, follow-ups)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-3" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 93:</strong> Design social media graphics (10 templates for LinkedIn/Twitter)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-4" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 94:</strong> Write LinkedIn thought leadership posts (5 posts on AI maturity)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-5" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 95:</strong> Create lead magnet: Free "AI Maturity Self-Assessment PDF"</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-6" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 96:</strong> Set up Google/LinkedIn ads (budget: $500/month)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-1-7" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Day 97:</strong> Launch email campaign to existing contacts (target: 500 sends)</span>
                                </li>
                            </ul>
                        </div>

                        <!-- Marketing Weeks 2-4 -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Days 98-120: Active Promotion</h3>
                            <ul class="gtm-task-list">
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-2-1" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Post daily on LinkedIn (3-4 posts/week) with workshop teasers</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-2-2" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Run weekly webinars: 30-min preview of Workshop 1 to drive registrations</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-2-3" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Partner outreach: Contact 10 complementary businesses for co-marketing</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-2-4" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Content marketing: Publish 2 blog posts/week on Medium/LinkedIn</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-2-5" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Email nurture: Send value-focused emails to leads (no hard sell)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="market-2-6" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false"><strong>Goal:</strong> 50+ workshop registrations by Day 120</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render B2C Sell Content
        function renderB2CSellContent() {
            return `
                <div class="gtm-content">
                    <div class="gtm-phase">
                        <div class="gtm-phase-header">
                            <div class="gtm-phase-title"> Sales Strategy: Days 121-150</div>
                            <div class="gtm-phase-meta">Deliver  Upsell  Scale</div>
                        </div>

                        <!-- Sales Process -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Workshop Delivery & Upsell (Days 121-150)</h3>
                            <ul class="gtm-task-list">
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-1-1" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Deliver 2 workshops per week (8 total over 4 weeks)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-1-2" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Send post-workshop survey within 2 hours (NPS + testimonial request)</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-1-3" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Upsell offer in Day+3 email: Next workshop at 20% discount</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-1-4" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Pitch 1-on-1 consulting ($200-500/hr) to top 20% of attendees</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-1-5" onchange="handleB2CCheckbox(this)">
                                    <span class="gtm-editable-task" contenteditable="false">Launch workshop bundle: All 6 workshops for $599 (save 30%)</span>
                                </li>
                            </ul>
                        </div>

                        <!-- Objection Handling -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Common Objections & Responses</h3>
                            <div class="gtm-workshop-grid">
                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div>
                                            <h3 class="gtm-workshop-title web">Too Expensive</h3>
                                        </div>
                                    </div>
                                    <div class="gtm-editable-task" contenteditable="false">
                                        <strong>Objection:</strong> "$99 is too much for a workshop"<br><br>
                                        <strong>Response:</strong> "I understand budget constraints. Let me break down the ROI:<br>
                                         You'll identify 30-day quick wins worth $10K+ in time savings<br>
                                         Avoid costly mistakes we've seen companies make ($50K+ wasted)<br>
                                         Get frameworks that typically require $5K+ consulting<br>
                                         Plus, we have a money-back guarantee if you don't find value"<br><br>
                                        <strong>Offer:</strong> Payment plan option ($50/month x 2)
                                    </div>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon inperson"></div>
                                        <div>
                                            <h3 class="gtm-workshop-title inperson">No Time</h3>
                                        </div>
                                    </div>
                                    <div class="gtm-editable-task" contenteditable="false">
                                        <strong>Objection:</strong> "Too busy to attend right now"<br><br>
                                        <strong>Response:</strong> "That's exactly why you need this. The workshop will help you:<br>
                                         Identify time wasters you can eliminate TODAY<br>
                                         Automate repetitive tasks (save 5-10 hrs/week)<br>
                                         Prioritize what actually moves the needle<br>
                                         It's 90 minutes that saves you 100+ hours over the next month"<br><br>
                                        <strong>Offer:</strong> Recording access if can't attend live
                                    </div>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div>
                                            <h3 class="gtm-workshop-title web">Not Ready</h3>
                                        </div>
                                    </div>
                                    <div class="gtm-editable-task" contenteditable="false">
                                        <strong>Objection:</strong> "We're not ready for AI yet"<br><br>
                                        <strong>Response:</strong> "This is FOR people not ready! That's the point:<br>
                                         We start where YOU are (awareness level)<br>
                                         No technical background needed<br>
                                         Learn the basics before making expensive commitments<br>
                                         See if AI even makes sense for you (might save you $100K+)"<br><br>
                                        <strong>Offer:</strong> Free 15-min pre-call to assess fit
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue Targets -->
                        <div class="gtm-section">
                            <h3 class="gtm-section-title">Revenue Targets (Days 121-150)</h3>
                            <ul class="gtm-task-list">
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-2-1" onchange="handleB2CCheckbox(this)">
                                    <span><strong>Workshop Revenue:</strong> 50 attendees  $129 avg = $6,450</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-2-2" onchange="handleB2CCheckbox(this)">
                                    <span><strong>Bundle Sales:</strong> 5 bundles  $599 = $2,995</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-2-3" onchange="handleB2CCheckbox(this)">
                                    <span><strong>1-on-1 Consulting:</strong> 3 clients  $1,500 = $4,500</span>
                                </li>
                                <li class="gtm-task-item">
                                    <input type="checkbox" class="gtm-checkbox" data-task-id="sell-2-4" onchange="handleB2CCheckbox(this)">
                                    <span><strong>TOTAL TARGET:</strong> $13,945 in first 30 days of selling</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render B2C Gantt Chart Content
        function renderB2CGanttContent() {
            return `
                <div class="gtm-content">
                    <div class="gantt-container">
                        <h2 style="color: #06B6D4; margin-bottom: 24px;">B2C Workshop Timeline: 150-Day Gantt Chart</h2>

                        <!-- Gantt Chart -->
                        <div class="gantt-chart">
                            <!-- Header -->
                            <div class="gantt-header">
                                <div class="gantt-task-label">Task</div>
                                <div class="gantt-timeline">
                                    <div class="gantt-month">Month 1</div>
                                    <div class="gantt-month">Month 2</div>
                                    <div class="gantt-month">Month 3</div>
                                    <div class="gantt-month">Month 4</div>
                                    <div class="gantt-month">Month 5</div>
                                </div>
                            </div>

                            <!-- Phase 1: Build Workshop 1-2 -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Build Workshop 1-2</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 1-30</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar in-progress"
                                         style="left: 0%; width: 20%; background: #06B6D4;"
                                         data-details="Days 1-30: Create 'Find Your Purpose' and 'Master Your Time' workshops. Includes curriculum design, slide decks, participant workbooks, and beta testing.">
                                        Workshop 1-2
                                    </div>
                                </div>
                            </div>

                            <!-- Phase 2: Build Workshop 3-4 -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Build Workshop 3-4</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 31-60</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 20%; width: 20%; background: #8B5CF6;"
                                         data-details="Days 31-60: Create 'Build Confidence' and 'Emotional Intelligence' workshops. Full content development plus soft launch preparation.">
                                        Workshop 3-4
                                    </div>
                                </div>
                            </div>

                            <!-- Phase 3: Build Workshop 5-6 -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Build Workshop 5-6</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 61-90</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 40%; width: 20%; background: #10B981;"
                                         data-details="Days 61-90: Create 'Stress Management' and 'Life Balance' workshops. Complete 6-workshop portfolio with professional branding.">
                                        Workshop 5-6
                                    </div>
                                </div>
                            </div>

                            <!-- Phase 4: Marketing Campaign -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Marketing Campaign</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 91-120</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 60%; width: 20%; background: #F59E0B;"
                                         data-details="Days 91-120: Launch comprehensive marketing across social media, email campaigns, partnerships, and community outreach. Target 50+ registrations.">
                                        Marketing
                                    </div>
                                </div>
                            </div>

                            <!-- Phase 5: Sales & Delivery -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Sales & Delivery</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 121-150</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 80%; width: 20%; background: #EF4444;"
                                         data-details="Days 121-150: Deliver first cohort of workshops, gather testimonials, refine delivery model. Target $13K+ revenue with proven scalability.">
                                        Delivery
                                    </div>
                                </div>
                            </div>

                            <!-- Ongoing: Optimization -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Ongoing Optimization</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 91-150+</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 60%; width: 40%; background: rgba(139, 92, 246, 0.5); border: 2px dashed #8B5CF6;"
                                         data-details="Days 91-150+: Continuous improvement of content, marketing automation, customer feedback integration, and operational efficiency.">
                                        Optimize
                                    </div>
                                </div>
                            </div>

                            <!-- Interactive Legend -->
                            <div class="gantt-legend">
                                <div class="gantt-legend-item">
                                    <div class="gantt-legend-color" style="background: #06B6D4;"></div>
                                    <span>Content Creation</span>
                                </div>
                                <div class="gantt-legend-item">
                                    <div class="gantt-legend-color" style="background: #8B5CF6;"></div>
                                    <span>Development</span>
                                </div>
                                <div class="gantt-legend-item">
                                    <div class="gantt-legend-color" style="background: #10B981;"></div>
                                    <span>Portfolio Complete</span>
                                </div>
                                <div class="gantt-legend-item">
                                    <div class="gantt-legend-color" style="background: #F59E0B;"></div>
                                    <span>Marketing & Outreach</span>
                                </div>
                                <div class="gantt-legend-item">
                                    <div class="gantt-legend-color" style="background: #EF4444;"></div>
                                    <span>Launch & Revenue</span>
                                </div>
                                <div class="gantt-legend-item">
                                    <div class="gantt-legend-color" style="background: linear-gradient(135deg, #F59E0B, #D97706); animation: pulse 2s infinite;"></div>
                                    <span>In Progress</span>
                                </div>
                            </div>
                        </div>

                        <!-- Milestones -->
                        <div class="gtm-phase" style="margin-top: 32px;">
                            <div class="gtm-phase-header">
                                <div class="gtm-phase-title"> Key Milestones</div>
                            </div>
                            <div class="gtm-section">
                                <ul class="gtm-task-list">
                                    <li class="gtm-task-item">
                                        <span><strong>Day 15:</strong> Workshop 1 beta tested </span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <span><strong>Day 30:</strong> Workshops 1-2 complete and ready</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <span><strong>Day 60:</strong> All 4 core workshops complete</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <span><strong>Day 90:</strong> Full portfolio (6 workshops) ready to sell</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <span><strong>Day 120:</strong> 50+ registrations achieved, marketing engine running</span>
                                    </li>
                                    <li class="gtm-task-item">
                                        <span><strong>Day 150:</strong> $13K+ revenue, proven delivery model, ready to scale</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Toggle B2C Edit Mode
        function toggleB2CEditMode() {
            const editables = document.querySelectorAll('.gtm-editable-task');
            editables.forEach(el => {
                const isEditable = el.getAttribute('contenteditable') === 'true';
                el.setAttribute('contenteditable', !isEditable);
                el.style.border = !isEditable ? '1px dashed #06B6D4' : 'none';
                el.style.padding = !isEditable ? '8px' : '0';
            });

            const btn = event.target.closest('button');
            if (btn) {
                btn.textContent = editables[0].getAttribute('contenteditable') === 'true' ? ' Save' : ' Edit Mode';
            }
        }

        // Show B2C Gantt (switch to gantt tab)
        function showB2CGantt() {
            switchB2CTab('gantt');
        }

        // Handle B2C Workshop checkbox changes
        function handleB2CCheckbox(checkbox) {
            const taskItem = checkbox.closest('.gtm-task-item');
            if (taskItem) {
                taskItem.classList.toggle('completed', checkbox.checked);

                // Save state to localStorage
                saveB2CTaskState(checkbox.dataset.taskId, checkbox.checked);
                updateB2CProgress();
            }
        }

        // Save B2C task state to localStorage
        function saveB2CTaskState(taskId, checked) {
            const states = JSON.parse(localStorage.getItem('hg_b2c_tasks') || '{}');
            states[taskId] = checked;
            localStorage.setItem('hg_b2c_tasks', JSON.stringify(states));
        }

        // Load B2C task states from localStorage
        function loadB2CTaskStates() {
            const states = JSON.parse(localStorage.getItem('hg_b2c_tasks') || '{}');
            Object.keys(states).forEach(taskId => {
                const checkbox = document.querySelector(`[data-task-id="${taskId}"]`);
                if (checkbox) {
                    checkbox.checked = states[taskId];
                    const taskItem = checkbox.closest('.gtm-task-item');
                    if (taskItem) {
                        taskItem.classList.toggle('completed', states[taskId]);
                    }
                }
            });
        }

        // Update B2C progress bar
        function updateB2CProgress() {
            const checkboxes = document.querySelectorAll('[data-task-id^="b2c-"]');
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const total = checkboxes.length;
            const percentage = total > 0 ? Math.round((checked / total) * 100) : 0;

            const progressBar = document.getElementById('b2c-progress-bar');
            const progressText = document.getElementById('b2c-progress');

            if (progressBar) progressBar.style.width = percentage + '%';
            if (progressText) progressText.textContent = percentage + '%';
        }

        // Toast notification system
        function showToast(message, duration = 3000) {
            const toast = document.createElement('div');
            toast.className = 'gtm-toast';
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // Handle checkbox changes
        function handleGTMCheckbox(checkbox) {
            const taskItem = checkbox.closest('.gtm-task-item');
            if (taskItem) {
                taskItem.classList.toggle('completed', checkbox.checked);

                // Save state to localStorage
                const taskId = checkbox.dataset.taskId;
                if (taskId) {
                    const completed = JSON.parse(localStorage.getItem('gtm_tasks_completed') || '{}');
                    completed[taskId] = checkbox.checked;
                    localStorage.setItem('gtm_tasks_completed', JSON.stringify(completed));
                }

                // Update progress
                updateGTMProgress();
            }
        }

        // Update progress indicators
        function updateGTMProgress() {
            const allCheckboxes = document.querySelectorAll('.gtm-checkbox');
            const checkedCheckboxes = document.querySelectorAll('.gtm-checkbox:checked');
            const progress = allCheckboxes.length > 0 ? (checkedCheckboxes.length / allCheckboxes.length) * 100 : 0;

            // Update main progress bar
            const progressBar = document.getElementById('gtmProgressBar');
            const progressText = document.getElementById('gtmOverallProgress');
            const completedCount = document.getElementById('gtmCompletedCount');
            const totalCount = document.getElementById('gtmTotalCount');

            if (progressBar) progressBar.style.width = `${progress}%`;
            if (progressText) progressText.textContent = `${Math.round(progress)}%`;
            if (completedCount) completedCount.textContent = checkedCheckboxes.length;
            if (totalCount) totalCount.textContent = allCheckboxes.length;

            // Update other progress fills
            document.querySelectorAll('.gtm-progress-fill:not(#gtmProgressBar)').forEach(bar => {
                bar.style.width = `${progress}%`;
            });
        }

        // Toggle expandable sections
        function toggleGTMExpandable(element) {
            element.classList.toggle('expanded');
        }

        // Load saved task states
        function loadGTMTaskStates() {
            const completed = JSON.parse(localStorage.getItem('gtm_tasks_completed') || '{}');
            Object.entries(completed).forEach(([taskId, isCompleted]) => {
                const checkbox = document.querySelector(`[data-task-id="${taskId}"]`);
                if (checkbox && isCompleted) {
                    checkbox.checked = true;
                    handleGTMCheckbox(checkbox);
                }
            });
        }

        // GTM Tab Switching
        function switchGTMTab(tabName) {
            // Update tab buttons using CSS classes
            document.querySelectorAll('.gtm-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }

            // Load tab content
            const contentDiv = document.getElementById('gtmTabContent');
            switch(tabName) {
                case 'overview':
                    contentDiv.innerHTML = getGTMOverviewContent();
                    break;
                case 'phases':
                    contentDiv.innerHTML = getGTMPhasesContent();
                    break;
                case 'tracker':
                    contentDiv.innerHTML = getGTMTrackerContent();
                    break;
                case 'communication':
                    contentDiv.innerHTML = getGTMCommunicationContent();
                    break;
                case 'metrics':
                    contentDiv.innerHTML = getGTMMetricsContent();
                    break;
                case 'gantt':
                    contentDiv.innerHTML = getGTMGanttContent();
                    break;
            }
        }

        // AI Assistant integration for GTM
        function askGTMAI() {
            // Switch to AI chat tab
            switchTab('chat', document.querySelectorAll('.panel-tab')[1]);
            // Pre-fill with GTM question
            const chatInput = document.getElementById('chatInput');
            chatInput.value = 'Tell me about the GTM strategy and how to get started with workshops';
            chatInput.focus();
            // Trigger AI response with GTM context
            setTimeout(() => {
                handleAIChat('gtm');
            }, 100);
        }

        // Content generators for each tab
        function getGTMOverviewContent() {
            return `
                <div class="gtm-content">
                    <h2 class="gtm-section-title">The Maturity Continuum</h2>

                    <div class="gtm-stage-grid">
                        ${['ANALOG', 'EXPLORING', 'IMPLEMENTING', 'SCALING', 'AUTOMATED'].map((stage, i) => {
                            const colors = ['#EF4444', '#F59E0B', '#F59E0B', '#10B981', '#3B82F6'];
                            const icons = ['', '', '', '', ''];
                            const scores = ['0-2', '3-4', '5-6', '7-8', '9-10'];
                            const solutions = ['White-Glove Consulting', 'Workshops + Experts', 'Courses + Templates', 'Self-Service Platform', 'Enterprise + API'];
                            const prices = ['$5K-$15K', '$3K-$8K', '$2K-$5K', '$500-$2K/mo', '$5K-$20K/mo'];
                            const stages = ['analog', 'exploring', 'implementing', 'scaling', 'automated'];

                            return `
                                <div class="gtm-stage-card gtm-editable ${stages[i]}" contenteditable="false" data-section="stage-${i}">
                                    <div class="gtm-stage-icon">${icons[i]}</div>
                                    <h3 class="gtm-stage-name">${stage}</h3>
                                    <div class="gtm-stage-score">Score ${scores[i]}</div>
                                    <div class="gtm-stage-solution">${solutions[i]}</div>
                                    <div class="gtm-stage-price">${prices[i]}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>

                    <div class="gtm-content-grid">
                        <div class="gtm-info-card">
                            <h3 class="gtm-card-title">Core Value Proposition</h3>
                            <div class="gtm-editable gtm-card-content" contenteditable="false" data-section="value-prop">
                                Most companies know they need AI, but they're stuck. We provide a clear roadmap from wherever you are to AI excellence through:<br><br>
                                 <strong>Assessment:</strong> Understand current AI maturity (0-10 score)<br>
                                 <strong>Roadmap:</strong> Get personalized plan for next level<br>
                                 <strong>Implementation:</strong> Choose DIY, guided, or done-for-you<br>
                                 <strong>Results:</strong> Measurable improvement in 90 days
                            </div>
                        </div>

                        <div class="gtm-info-card">
                            <h3 class="gtm-card-title">Target Outcomes</h3>
                            <p class="gtm-card-subtitle">Companies increase AI maturity by 2-3 levels in 90 days:</p>
                            <div class="gtm-stats-grid">
                                ${[
                                    { value: '10-15', label: 'Hours saved/week' },
                                    { value: '30-40%', label: 'Reduced waste' },
                                    { value: '3x', label: 'Faster launches' },
                                    { value: '4x', label: 'Average ROI' }
                                ].map(stat => `
                                    <div class="gtm-stat-card">
                                        <div class="gtm-stat-value">${stat.value}</div>
                                        <div class="gtm-stat-label">${stat.label}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getGTMPhasesContent() {
            return `
                <div class="gtm-content">
                    <h2 class="gtm-section-title">90-Day Execution Plan</h2>
                    <p class="gtm-section-subtitle">Three phases to validated revenue</p>

                    <div class="gtm-phase-grid">
                        ${[
                            {
                                title: 'Phase 1: Foundation',
                                months: 'M1-M3',
                                target: 'Analog & Exploring (0-4)',
                                items: ['Launch free assessment', 'Expert-led workshops', 'Case studies & thought leadership', 'Partner with consultancies'],
                                goal: '50 assessments  10 engagements  $75K',
                                phase: 'foundation',
                                section: 'phase-1'
                            },
                            {
                                title: 'Phase 2: Scale',
                                months: 'M4-M8',
                                target: 'Implementing (5-6)',
                                items: ['Launch course library', 'Template marketplace', 'Monthly group workshops', 'Community forum'],
                                goal: '200 enrollments  30 workshops  $150K',
                                phase: 'scale',
                                section: 'phase-2'
                            },
                            {
                                title: 'Phase 3: Automation',
                                months: 'M9-M12',
                                target: 'Scaling & Automated (7-10)',
                                items: ['SaaS platform launch', 'AI recommendation engine', 'No-code workflow builder', 'Enterprise API'],
                                goal: '100 subscribers  70% self-serve  $250K MRR',
                                phase: 'automation',
                                section: 'phase-3'
                            }
                        ].map(phase => `
                            <div class="gtm-phase-card gtm-editable ${phase.phase}" contenteditable="false" data-section="${phase.section}">
                                <div class="gtm-phase-header">
                                    <h3 class="gtm-phase-title">${phase.title}</h3>
                                    <span class="gtm-phase-badge ${phase.phase}">${phase.months}</span>
                                </div>
                                <p class="gtm-phase-target">Target: ${phase.target}</p>
                                <ul class="gtm-phase-items">
                                    ${phase.items.map(item => `<li> ${item}</li>`).join('')}
                                </ul>
                                <div class="gtm-phase-goal">
                                    Goal: ${phase.goal}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function getGTMTrackerContent() {
            return `
                <div class="gtm-content">
                    <h2 class="gtm-section-title">Day-by-Day Execution Plan</h2>
                    <p class="gtm-section-subtitle">Detailed daily action items for the first 90 days</p>

                    <!-- Overall Progress -->
                    <div class="gtm-info-card" style="margin-bottom: 24px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h3 class="gtm-card-title">Overall Progress</h3>
                            <span id="gtmOverallProgress" style="color: var(--hg-cyan); font-weight: 600;">0%</span>
                        </div>
                        <div class="gtm-progress-bar" style="height: 8px;">
                            <div class="gtm-progress-fill" id="gtmProgressBar" style="width: 0%;"></div>
                        </div>
                        <p style="margin-top: 8px; font-size: 12px; color: #9ca3af;">
                            <span id="gtmCompletedCount">0</span> of <span id="gtmTotalCount">0</span> tasks completed
                        </p>
                    </div>

                    <div class="gtm-timeline-container">
                        ${getDailyTasks().map((day, index) => `
                            <div class="gtm-week-item gtm-expandable ${index < 7 ? 'expanded' : ''}" onclick="toggleGTMExpandable(this)">
                                <div class="gtm-week-line"></div>
                                <div class="gtm-week-dot" style="background: ${day.priority === 'high' ? 'var(--hg-amber)' : day.priority === 'medium' ? 'var(--hg-blue)' : 'var(--hg-cyan)'}"></div>
                                <div class="gtm-expandable-header">
                                    <div>
                                        <h4 class="gtm-week-title">Day ${day.day}: ${day.title}</h4>
                                        <p class="gtm-week-meta">${day.phase}  ${day.focus}</p>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <span style="font-size: 11px; color: ${day.priority === 'high' ? 'var(--hg-amber)' : '#9ca3af'}; text-transform: uppercase;">
                                            ${day.priority} priority
                                        </span>
                                        <span class="gtm-expand-icon"></span>
                                    </div>
                                </div>
                                <div class="gtm-expandable-content">
                                    ${day.description ? `<p style="margin-bottom: 12px; color: #d1d5db; font-size: 13px;">${day.description}</p>` : ''}
                                    <div class="gtm-week-tasks">
                                        ${day.tasks.map((task, i) => `
                                            <div class="gtm-task-item">
                                                <input type="checkbox" class="gtm-checkbox" data-task-id="day-${day.day}-${i}" onchange="handleGTMCheckbox(this)">
                                                <span class="gtm-task-text">${task}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                    ${day.deliverables ? `
                                        <div style="margin-top: 12px; padding: 12px; background: rgba(97, 216, 254, 0.1); border-left: 3px solid var(--hg-cyan); border-radius: 4px;">
                                            <strong style="color: var(--hg-cyan); font-size: 12px;"> DELIVERABLES:</strong><br>
                                            <span style="font-size: 13px; color: #d1d5db;">${day.deliverables}</span>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <!-- Keyboard Shortcuts Hint -->
                    <div style="margin-top: 24px; padding: 16px; background: rgba(255, 255, 255, 0.02); border-radius: 8px; font-size: 12px; color: #9ca3af;">
                        <strong> Controls:</strong><br>
                         <strong>Click any section</strong> to edit inline  <strong>Ctrl/Cmd + Enter</strong> to save<br>
                         <strong>Scroll</strong> to pan  <strong>Ctrl + Scroll</strong> or <strong>Shift + Scroll</strong> to zoom<br>
                         <strong>Click & drag</strong> to pan  <strong>Two-finger pinch</strong> to zoom (touchscreen)<br>
                         Click day headers to <strong>expand/collapse</strong> tasks
                    </div>
                </div>
            `;
        }

        function getGTMCommunicationContent() {
            return `
                <div class="gtm-content">
                    <h2 class="gtm-section-title">Communication Scripts & Templates</h2>
                    <p class="gtm-section-subtitle">Copy-paste ready templates for every stage</p>

                    ${[
                        {
                            title: 'Cold Outreach Email',
                            section: 'email-cold',
                            content: `Subject: Quick question about [Company]'s AI strategy\n\nHi [Name],\n\nI've been following [Company] and noticed [specific observation].\n\nQuick question: Have you assessed where your organization stands on AI readiness?\n\nI'm working with companies in [industry] to benchmark their AI maturity. Most are surprised to learn they're either further ahead (missing quick wins) or behind (at risk vs competitors).\n\nWould you be open to a free 10-minute AI Maturity Assessment? You'll get:\n- Your AI maturity score (0-10 scale)\n- Comparison to industry benchmarks\n- 3 specific next steps for your level\n\nNo sales pitch - just useful insights. Game?\n\n[Your Name]\n[Calendar Link]\n\nP.S. This typically takes 10 minutes and most people find it eye-opening.`
                        },
                        {
                            title: 'Assessment Results Follow-Up',
                            section: 'email-results',
                            content: `Subject: Your AI Maturity Results: [Score]/10 - [Company Name]\n\nHi [Name],\n\nThanks for taking the AI Maturity Assessment! Here are your results:\n\n Your Score: [X]/10\n\nWhat This Means:\nYou're at the [STAGE] level.\n\nCompanies at this level typically:\n- [Challenge 1 based on their score]\n- [Challenge 2 based on their score]\n- [Challenge 3 based on their score]\n\nGood News: [Specific strength based on answers]\nOpportunity: [Specific gap to close for next level]\n\nYour Personalized Next Steps:\n1. [Specific action 1]\n2. [Specific action 2]\n3. [Specific action 3]\n\nWant to discuss? I'd be happy to jump on a 15-minute call to:\n- Explain what companies at [X+1] level are doing differently\n- Share roadmap for getting from [X] to [X+2] in 90 days\n\n[Calendar Link]\n\nBest,\n[Your Name]\n\nP.S. Based on your score, I think [specific workshop/service] would be perfect.`
                        },
                        {
                            title: 'Workshop Invitation',
                            section: 'email-workshop',
                            content: `Subject: [Free Workshop] AI Implementation Playbook for [Industry]\n\nHi [Name],\n\nI'm hosting a free 90-minute workshop next [Date/Time]:\n\n"From Confusion to Clarity: The AI Implementation Playbook for [Industry]"\n\nWhat You'll Learn:\n The 5-stage AI maturity model (where you are now)\n Common mistakes at each stage (and how to avoid them)\n 30-day quick wins you can implement immediately\n How to calculate ROI on AI investments\n Real case studies from [Industry] companies\n\nWho Should Attend:\n- CTOs/VPs tired of AI experiments that go nowhere\n- Teams that started with ChatGPT but don't know what's next\n- Leaders who need to prove ROI on AI initiatives\n\nBonus: Attendees get a free personalized AI roadmap ($500 value)\n\n[Registration Link]\n\nLimited to 15 people for Q&A quality.\n\nSee you there?\n[Your Name]`
                        }
                    ].map(template => `
                        <div class="gtm-template-card">
                            <div class="gtm-template-header">
                                <h3 class="gtm-template-title">${template.title}</h3>
                                <button onclick="copyToClipboard('${template.section}')" class="btn btn-secondary gtm-copy-btn">
                                     Copy
                                </button>
                            </div>
                            <div class="gtm-editable gtm-template-content" contenteditable="false" data-section="${template.section}" id="${template.section}">
${template.content}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getGTMMetricsContent() {
            return `
                <div class="gtm-content">
                    <h2 class="gtm-section-title">Key Metrics & Goals</h2>
                    <p class="gtm-section-subtitle">Track progress against quarterly targets</p>

                    <div class="gtm-metrics-grid">
                        ${[
                            { label: 'Assessments', current: '0', goal: '50 by M3' },
                            { label: 'Sales Calls', current: '0', goal: '20 by M3' },
                            { label: 'Customers', current: '0', goal: '5 by M3' },
                            { label: 'Revenue', current: '$0', goal: '$15K by M3' }
                        ].map(metric => `
                            <div class="gtm-metric-card gtm-editable" contenteditable="false" data-section="metric-${metric.label.toLowerCase()}">
                                <div class="gtm-metric-label">${metric.label}</div>
                                <div class="gtm-metric-value">${metric.current}</div>
                                <div class="gtm-metric-goal">${metric.goal}</div>
                                <div class="gtm-metric-progress">
                                    <div class="gtm-metric-progress-bar" style="width: 0%;"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="gtm-content-grid">
                        <div class="gtm-info-card gtm-editable" contenteditable="false" data-section="quarterly-milestones">
                            <h3 class="gtm-card-title">Quarterly Milestones</h3>
                            ${[
                                { title: 'Q1 Target', amount: '$15-25K', details: '5-10 customers  50+ assessments', quarter: 'q1' },
                                { title: 'Q2 Target', amount: '$50-75K', details: '15-25 customers  Platform beta', quarter: 'q2' },
                                { title: 'Year End Target', amount: '$450K', details: '70% services  30% platform', quarter: 'year' }
                            ].map(q => `
                                <div class="gtm-milestone-card ${q.quarter}">
                                    <div class="gtm-milestone-title">${q.title}</div>
                                    <div class="gtm-milestone-amount">${q.amount}</div>
                                    <div class="gtm-milestone-details">${q.details}</div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="gtm-info-card gtm-editable" contenteditable="false" data-section="revenue-model">
                            <h3 class="gtm-card-title">Revenue Model Evolution</h3>
                            ${[
                                { year: 'Year 1: $450K', services: 70, platform: 30, breakdown: 'Consulting: $200K  Workshops: $150K  Platform: $100K' },
                                { year: 'Year 2: $1.05M', services: 40, platform: 60, breakdown: 'Consulting: $250K  Workshops: $200K  Platform: $600K' },
                                { year: 'Year 3: $1.95M', services: 20, platform: 80, breakdown: 'Consulting: $300K  Workshops: $150K  Platform: $1.5M' }
                            ].map(y => `
                                <div class="gtm-revenue-item">
                                    <div class="gtm-revenue-header">
                                        <span class="gtm-revenue-year">${y.year}</span>
                                        <span class="gtm-revenue-split">${y.services}% Services  ${y.platform}% Platform</span>
                                    </div>
                                    <div class="gtm-revenue-bar">
                                        <div class="gtm-revenue-fill" style="width: ${y.platform}%;">
                                            ${y.year.split(': ')[1]}
                                        </div>
                                    </div>
                                    <div class="gtm-revenue-breakdown">${y.breakdown}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function getGTMGanttContent() {
            return `
                <div class="gtm-content">
                    <div class="gantt-container">
                        <h2 style="color: #06B6D4; margin-bottom: 16px;">90-Day GTM Timeline: Gantt Chart</h2>
                        <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 24px;">
                            Visual roadmap from foundation to quarterly review  12 weeks  Revenue target: $15-25K
                        </p>

                        <div class="gantt-chart">
                            <!-- Header -->
                            <div class="gantt-header">
                                <div class="gantt-task-label">Phase</div>
                                <div class="gantt-timeline">
                                    <div class="gantt-month">Month 1</div>
                                    <div class="gantt-month">Month 2</div>
                                    <div class="gantt-month">Month 3</div>
                                </div>
                            </div>

                            <!-- Week 1: Foundation -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 1: Foundation</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 1-7</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 0%; width: 7.78%; background: #06B6D4;"
                                         data-details="Days 1-7: Define target, build assessment MVP, create workshop deck">
                                        Setup
                                    </div>
                                </div>
                            </div>

                            <!-- Week 2: Outreach -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 2: Outreach</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 8-14</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar in-progress"
                                         style="left: 7.78%; width: 7.78%; background: #8B5CF6;"
                                         data-details="Days 8-14: Launch outreach, discovery calls, content marketing">
                                        Sales
                                    </div>
                                </div>
                            </div>

                            <!-- Week 3: Closing -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 3: Closing</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 15-21</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 15.56%; width: 7.78%; background: #10B981;"
                                         data-details="Days 15-21: Close first deal  Target: $2.5-5K  Prep workshop delivery">
                                        First Deal
                                    </div>
                                </div>
                            </div>

                            <!-- Week 4: Delivery -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 4: Delivery</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 22-28</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 23.33%; width: 7.78%; background: #F59E0B;"
                                         data-details="Days 22-28: Deliver first workshop  Collect testimonials  Generate referrals">
                                        Workshop 1
                                    </div>
                                </div>
                            </div>

                            <!-- Week 5: Scale -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 5: Scale</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 29-35</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 31.11%; width: 7.78%; background: #EF4444;"
                                         data-details="Days 29-35: Host webinar  Follow up warm leads  Scale outreach">
                                        Webinar
                                    </div>
                                </div>
                            </div>

                            <!-- Week 6: Delivery -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 6: Delivery</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 36-42</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 38.89%; width: 7.78%; background: #F59E0B;"
                                         data-details="Days 36-42: Deliver more workshops  Build case studies  Document processes">
                                        Workshop 2
                                    </div>
                                </div>
                            </div>

                            <!-- Week 7: Growth -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 7: Growth</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 43-49</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 46.67%; width: 7.78%; background: #8B5CF6;"
                                         data-details="Days 43-49: Scale outreach to 25+ prospects  Run discovery calls  Close deals">
                                        Scale Sales
                                    </div>
                                </div>
                            </div>

                            <!-- Week 8: Productization -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 8: Productization</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 50-56</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 54.44%; width: 7.78%; background: #06B6D4;"
                                         data-details="Days 50-56: Create pricing tiers  Build service menu  Standardize proposals">
                                        Standardize
                                    </div>
                                </div>
                            </div>

                            <!-- Week 9: Course Creation -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 9: Course Creation</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 57-63</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 62.22%; width: 7.78%; background: #10B981;"
                                         data-details="Days 57-63: Plan course  Record 6 modules  Setup platform  Beta test">
                                        Build Course
                                    </div>
                                </div>
                            </div>

                            <!-- Week 10: Launch -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 10: Launch</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 64-70</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 70%; width: 7.78%; background: #EF4444;"
                                         data-details="Days 64-70: Launch course  Run promotion  Target: 20-30 enrollments">
                                        Launch Course
                                    </div>
                                </div>
                            </div>

                            <!-- Week 11: Community -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 11: Community</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 71-77</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 77.78%; width: 7.78%; background: #8B5CF6;"
                                         data-details="Days 71-77: Setup community  Host office hours  Launch newsletter">
                                        Engage
                                    </div>
                                </div>
                            </div>

                            <!-- Week 12: Review -->
                            <div class="gantt-row expandable" onclick="this.classList.toggle('expanded')">
                                <div class="gantt-task-label">
                                    <strong>Week 12: Review</strong>
                                    <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Days 78-84</div>
                                </div>
                                <div class="gantt-timeline">
                                    <div class="gantt-bar"
                                         style="left: 85.56%; width: 7.78%; background: #F59E0B;"
                                         data-details="Days 78-84: Q1 metrics review  Plan Q2  Target: $15-25K achieved">
                                        Q1 Review
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Interactive Legend -->
                        <div class="gantt-legend">
                            <div class="gantt-legend-item">
                                <div class="gantt-legend-color" style="background: #06B6D4;"></div>
                                <span>Foundation & Setup</span>
                            </div>
                            <div class="gantt-legend-item">
                                <div class="gantt-legend-color" style="background: #8B5CF6;"></div>
                                <span>Sales & Outreach</span>
                            </div>
                            <div class="gantt-legend-item">
                                <div class="gantt-legend-color" style="background: #10B981;"></div>
                                <span>Milestones & Wins</span>
                            </div>
                            <div class="gantt-legend-item">
                                <div class="gantt-legend-color" style="background: #F59E0B;"></div>
                                <span>Delivery & Operations</span>
                            </div>
                            <div class="gantt-legend-item">
                                <div class="gantt-legend-color" style="background: #EF4444;"></div>
                                <span>Launch & Growth</span>
                            </div>
                            <div class="gantt-legend-item">
                                <div class="gantt-legend-color" style="background: linear-gradient(135deg, #F59E0B, #D97706); animation: pulse 2s infinite;"></div>
                                <span>In Progress</span>
                            </div>
                        </div>

                        <!-- Key Milestones -->
                        <div style="margin-top: 32px;">
                            <h3 style="color: #06B6D4; margin-bottom: 16px;"> Key Milestones</h3>
                            <div class="gtm-workshop-grid">
                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div><h3 class="gtm-workshop-title web">Week 3: First Deal</h3></div>
                                    </div>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 14px;">
                                        Close first paid workshop engagement. Target: $2,500-5,000
                                    </p>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div><h3 class="gtm-workshop-title web">Week 4: Delivery</h3></div>
                                    </div>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 14px;">
                                        Deliver first workshop successfully. Collect testimonials and referrals
                                    </p>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div><h3 class="gtm-workshop-title web">Week 8: Productization</h3></div>
                                    </div>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 14px;">
                                        Standardize offerings into clear pricing tiers. Create service menu
                                    </p>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div><h3 class="gtm-workshop-title web">Week 10: Launch</h3></div>
                                    </div>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 14px;">
                                        Launch online course. Target: 20-30 enrollments at $299-799 each
                                    </p>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div><h3 class="gtm-workshop-title web">Week 12: Q1 Target</h3></div>
                                    </div>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 14px;">
                                        Achieve $15-25K revenue. 5-10 customers. 50+ assessments completed
                                    </p>
                                </div>

                                <div class="gtm-workshop-card web">
                                    <div class="gtm-workshop-header">
                                        <div class="gtm-workshop-icon web"></div>
                                        <div><h3 class="gtm-workshop-title web">Ongoing: Pipeline</h3></div>
                                    </div>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 14px;">
                                        Build Q2 pipeline for $50-75K target. Focus on repeatability and scale
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue Projection -->
                        <div style="margin-top: 32px;">
                            <h3 style="color: #06B6D4; margin-bottom: 16px;"> Revenue Projection by Week</h3>
                            <div class="gantt-chart" style="padding: 20px;">
                                <div class="gantt-row" style="margin-bottom: 12px;">
                                    <div style="color: rgba(255,255,255,0.9); min-width: 200px;">Weeks 1-3: Foundation</div>
                                    <div style="flex: 1; background: rgba(6, 182, 212, 0.1); border-radius: 4px; padding: 8px;">
                                        <div style="background: #06B6D4; width: 0%; height: 20px; border-radius: 4px;"></div>
                                        <div style="color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 4px;">$0 (Building)</div>
                                    </div>
                                </div>
                                <div class="gantt-row" style="margin-bottom: 12px;">
                                    <div style="color: rgba(255,255,255,0.9); min-width: 200px;">Weeks 4-6: First Deals</div>
                                    <div style="flex: 1; background: rgba(139, 92, 246, 0.1); border-radius: 4px; padding: 8px;">
                                        <div style="background: #8B5CF6; width: 30%; height: 20px; border-radius: 4px;"></div>
                                        <div style="color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 4px;">$5-8K (2-3 workshops)</div>
                                    </div>
                                </div>
                                <div class="gantt-row" style="margin-bottom: 12px;">
                                    <div style="color: rgba(255,255,255,0.9); min-width: 200px;">Weeks 7-9: Scaling</div>
                                    <div style="flex: 1; background: rgba(16, 185, 129, 0.1); border-radius: 4px; padding: 8px;">
                                        <div style="background: #10B981; width: 50%; height: 20px; border-radius: 4px;"></div>
                                        <div style="color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 4px;">$8-12K (More workshops + consulting)</div>
                                    </div>
                                </div>
                                <div class="gantt-row">
                                    <div style="color: rgba(255,255,255,0.9); min-width: 200px;">Weeks 10-12: Course Launch</div>
                                    <div style="flex: 1; background: rgba(245, 158, 11, 0.1); border-radius: 4px; padding: 8px;">
                                        <div style="background: #F59E0B; width: 80%; height: 20px; border-radius: 4px;"></div>
                                        <div style="color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 4px;">$15-25K total (Cumulative Q1 target)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Detailed daily tasks for 90-day GTM plan
        function getDailyTasks() {
            return [
                // WEEK 1: Setup & Foundation
                { day: 1, title: "Define Your Target", phase: "Week 1: Foundation", focus: "Customer Research", priority: "high",
                  description: "Start by getting crystal clear on who you're serving. The more specific, the better.",
                  tasks: [
                    "Interview 3-5 companies in your target industry",
                    "Document their biggest AI pain points",
                    "Create ICP (Ideal Customer Profile) doc - company size, industry, decision makers",
                    "List 10 companies that match your ICP perfectly",
                    "Identify 3 key stakeholders per company (CTO, VP Eng, Head of Product)"
                  ],
                  deliverables: "ICP document + List of 10 target companies"
                },
                { day: 2, title: "Build Assessment MVP", phase: "Week 1: Foundation", focus: "Product Development", priority: "high",
                  description: "Create the simplest version of your AI maturity assessment that provides value.",
                  tasks: [
                    "Draft 15 assessment questions covering: current AI usage, team skills, data readiness, infrastructure",
                    "Create scoring rubric (0-10 scale)",
                    "Set up Google Form or Typeform",
                    "Add logic to calculate maturity score",
                    "Create automated email response with results"
                  ],
                  deliverables: "Working assessment form + Automated scoring"
                },
                { day: 3, title: "Test & Refine Assessment", phase: "Week 1: Foundation", focus: "Quality Assurance", priority: "medium",
                  tasks: [
                    "Send assessment to 10 colleagues/friends",
                    "Ask for feedback on question clarity",
                    "Time how long it takes (goal: under 10 minutes)",
                    "Fix confusing or redundant questions",
                    "Verify scoring logic works correctly"
                  ],
                  deliverables: "Validated assessment v1.0"
                },
                { day: 4, title: "Create Workshop Deck", phase: "Week 1: Foundation", focus: "Content Creation", priority: "high",
                  description: "Build your core workshop presentation that demonstrates value.",
                  tasks: [
                    "Create 30-slide workshop deck: Intro (5), Maturity Model (10), Case Studies (8), Action Plan (7)",
                    "Add 3 real case studies showing transformation at each maturity level",
                    "Include interactive elements: polls, breakout discussions, Q&A",
                    "Design handout: ROI calculator template",
                    "Prepare speaker notes for each slide"
                  ],
                  deliverables: "Workshop deck + Handouts"
                },
                { day: 5, title: "Build Contact List", phase: "Week 1: Foundation", focus: "Outreach Prep", priority: "high",
                  tasks: [
                    "Use LinkedIn Sales Navigator to find 30 target contacts",
                    "Research each company's AI initiatives (check blog, press releases)",
                    "Find email addresses using Hunter.io or RocketReach",
                    "Create spreadsheet: Name, Company, Title, Email, LinkedIn, Notes",
                    "Segment into: Hot (showing AI interest), Warm (right profile), Cold (expansion)"
                  ],
                  deliverables: "Segmented contact list of 30 decision makers"
                },
                { day: 6, title: "Draft Outreach Emails", phase: "Week 1: Foundation", focus: "Marketing Content", priority: "medium",
                  tasks: [
                    "Write 3 email templates: Cold outreach, Assessment invite, Workshop invitation",
                    "Personalize first line with specific company insight",
                    "Keep emails under 100 words",
                    "Include clear CTA (book call, take assessment, attend workshop)",
                    "A/B test subject lines: Ask 5 people which they'd open"
                  ],
                  deliverables: "3 email templates ready to send"
                },
                { day: 7, title: "Week 1 Review & Planning", phase: "Week 1: Foundation", focus: "Strategy", priority: "medium",
                  tasks: [
                    "Review all deliverables from Week 1",
                    "Set up tracking dashboard (Google Sheets): Outreach sent, Responses, Calls booked, Revenue",
                    "Plan Week 2 priorities",
                    "Schedule social media posts for next week",
                    "Goal: Everything ready to start outreach on Day 8"
                  ],
                  deliverables: "Tracking dashboard + Week 2 plan"
                },

                // WEEK 2: First Outreach
                { day: 8, title: "Launch First Outreach", phase: "Week 2: Outreach", focus: "Sales", priority: "high",
                  description: "Start contacting your target list with personalized messages.",
                  tasks: [
                    "Send 10 personalized emails to 'Hot' segment",
                    "Connect with 15 people on LinkedIn (no pitch, just connect)",
                    "Post on LinkedIn about AI maturity topic with assessment link",
                    "Track open rates and responses in dashboard",
                    "Goal: 3-5 responses by end of day"
                  ],
                  deliverables: "10 emails sent + 15 LinkedIn connections"
                },
                { day: 9, title: "Follow-Up & Engage", phase: "Week 2: Outreach", focus: "Engagement", priority: "high",
                  tasks: [
                    "Send 10 more emails to 'Warm' segment",
                    "Respond to any replies within 1 hour",
                    "Comment on target prospects' LinkedIn posts",
                    "Share assessment link in 2 relevant LinkedIn groups",
                    "Book any discovery calls that come in"
                  ],
                  deliverables: "10 emails + Active engagement"
                },
                { day: 10, title: "Content Marketing Push", phase: "Week 2: Outreach", focus: "Content", priority: "medium",
                  tasks: [
                    "Write LinkedIn article: 'The Hidden Cost of AI Chaos: Why Maturity Matters'",
                    "Include assessment link and workshop announcement",
                    "Share article with your network",
                    "Ask 5 colleagues to comment/share",
                    "Post in 3 relevant LinkedIn groups"
                  ],
                  deliverables: "Published LinkedIn article"
                },

                // Continue with detailed days 11-90...
                // I'll add first month in full detail, then summarize remaining 60 days by week

                { day: 11, title: "Discovery Calls", phase: "Week 2: Outreach", focus: "Sales Calls", priority: "high",
                  tasks: [
                    "Conduct 3-5 discovery calls with interested leads",
                    "Use framework: Current state (10min), Pain points (15min), Vision (10min), Next steps (5min)",
                    "Take detailed notes on each call",
                    "Send assessment link immediately after each call",
                    "Book follow-up calls for assessment results review"
                  ],
                  deliverables: "3-5 discovery calls completed"
                },
                { day: 12, title: "Refine Pitch", phase: "Week 2: Outreach", focus: "Sales Process", priority: "medium",
                  tasks: [
                    "Review all discovery call notes",
                    "Identify common objections and prepare responses",
                    "Update pitch deck based on what resonates",
                    "Create FAQ document from common questions",
                    "Practice elevator pitch (30 seconds)"
                  ],
                  deliverables: "Updated pitch materials"
                },
                { day: 13, title: "Assessment Results Calls", phase: "Week 2: Outreach", focus: "Value Delivery", priority: "high",
                  tasks: [
                    "Review assessment results for each lead",
                    "Prepare personalized recommendations (2-3 quick wins per company)",
                    "Conduct results review calls",
                    "Present workshop as next step",
                    "Send follow-up email with roadmap preview"
                  ],
                  deliverables: "Results calls + Personalized roadmaps"
                },
                { day: 14, title: "Week 2 Review", phase: "Week 2: Outreach", focus: "Analytics", priority: "medium",
                  tasks: [
                    "Update tracking dashboard with all metrics",
                    "Calculate: Email open rate, response rate, call-to-workshop conversion",
                    "Review what's working vs. what's not",
                    "Adjust email templates based on data",
                    "Plan Week 3: Goal is to book first paid workshop"
                  ],
                  deliverables: "Week 2 metrics report"
                },

                // WEEK 3: Closing First Deal
                { day: 15, title: "Workshop Sales Push", phase: "Week 3: Closing", focus: "Sales", priority: "high",
                  description: "Focus on converting interested leads into paid workshop bookings.",
                  tasks: [
                    "Send workshop proposal to 5 warmest leads",
                    "Include: Agenda, pricing ($2.5K web / $10K in-person), testimonials (if any)",
                    "Offer early bird discount: 20% off if booked this week",
                    "Follow up via phone call same day",
                    "Goal: Book first workshop this week"
                  ],
                  deliverables: "5 workshop proposals sent"
                },

                // Adding abbreviated format for remaining days to save space
                { day: 16, title: "Objection Handling", phase: "Week 3: Closing", focus: "Sales", priority: "high",
                  tasks: ["Prepare responses to top 5 objections", "Role-play objection handling", "Update proposal with ROI calculator", "Send case study to hesitant leads", "Schedule decision-maker calls"],
                  deliverables: "Objection handling playbook"
                },
                { day: 17, title: "Pricing Strategy", phase: "Week 3: Closing", focus: "Business Model", priority: "medium",
                  tasks: ["Analyze competitor pricing", "Create 3-tier pricing: Basic workshop, Premium, Enterprise", "Design payment plans option", "Test pricing with 2-3 leads", "Finalize pricing structure"],
                  deliverables: "Pricing tiers finalized"
                },
                { day: 18, title: "Contract & Legal", phase: "Week 3: Closing", focus: "Operations", priority: "high",
                  tasks: ["Create simple service agreement template", "Include: Scope, deliverables, payment terms, cancellation policy", "Have lawyer review (if budget allows)", "Set up invoice template", "Choose payment processor (Stripe/PayPal)"],
                  deliverables: "Legal docs + Payment system ready"
                },
                { day: 19, title: "Close First Deal", phase: "Week 3: Closing", focus: "Sales", priority: "high",
                  tasks: ["Follow up with all open proposals", "Offer to answer any remaining questions", "Send contract to ready-to-buy leads", "Collect first payment!", "Schedule workshop date"],
                  deliverables: " GOAL: First paid workshop booked"
                },
                { day: 20, title: "Prep First Workshop", phase: "Week 3: Closing", focus: "Delivery Prep", priority: "high",
                  tasks: ["Customize deck for client's industry", "Prepare breakout exercises", "Set up Zoom/venue", "Send pre-workshop survey to attendees", "Test all tech 24hrs before"],
                  deliverables: "Workshop ready to deliver"
                },
                { day: 21, title: "Week 3 Review + Month 1 Wrap", phase: "Week 3: Closing", focus: "Strategy", priority: "medium",
                  tasks: ["Review Month 1 metrics: Leads, calls, conversions, revenue", "Document lessons learned", "Update ICP based on who converted", "Plan Month 2: Scale what's working", "Celebrate first win! "],
                  deliverables: "Month 1 complete - First revenue!"
                },

                // WEEK 4: First Delivery
                { day: 22, title: "Deliver First Workshop", phase: "Week 4: Delivery", focus: "Service Delivery", priority: "high",
                  description: "Over-deliver on your first paid engagement to create a raving fan.",
                  tasks: [
                    "Arrive 15 mins early to test tech and welcome attendees",
                    "Deliver workshop with energy - over-prepare means you can adapt",
                    "Take photos/screenshots for case study",
                    "Leave 20 mins for Q&A - capture their questions for future content",
                    "Send follow-up email within 2 hours with resources and action items"
                  ],
                  deliverables: "Workshop delivered + Photos + Attendee questions documented"
                },
                { day: 23, title: "Immediate Follow-Up", phase: "Week 4: Delivery", focus: "Customer Success", priority: "high",
                  tasks: [
                    "Send personalized thank you to each attendee",
                    "Share additional resources (templates, checklists, reading list)",
                    "Ask for testimonial via email (make it easy with 3 specific questions)",
                    "Request LinkedIn recommendations from 2-3 key attendees",
                    "Schedule 30-day check-in call"
                  ],
                  deliverables: "Thank you sent + Resources shared + Testimonial requests sent"
                },
                { day: 24, title: "Ask for Referrals", phase: "Week 4: Delivery", focus: "Growth", priority: "high",
                  tasks: [
                    "Email client asking for 2-3 warm introductions",
                    "Make it specific: 'Do you know anyone else facing similar AI challenges?'",
                    "Offer incentive: 10% off next workshop for each referral",
                    "Create simple referral tracking sheet",
                    "Follow up if no response in 3 days"
                  ],
                  deliverables: "Referral requests sent + Tracking sheet created"
                },
                { day: 25, title: "Document & Create Case Study", phase: "Week 4: Delivery", focus: "Marketing", priority: "medium",
                  tasks: [
                    "Write case study draft (500-800 words): Challenge, Solution, Results",
                    "Include specific metrics even if preliminary (e.g., '15 team members trained')",
                    "Add customer quote from testimonial",
                    "Create visual: before/after diagram of their AI maturity",
                    "Get customer approval to share publicly"
                  ],
                  deliverables: "Draft case study ready for review"
                },
                { day: 26, title: "Publish & Promote Case Study", phase: "Week 4: Delivery", focus: "Content Marketing", priority: "medium",
                  tasks: [
                    "Publish case study on website/LinkedIn",
                    "Tag client in LinkedIn post (with their permission)",
                    "Email case study to all prospects in pipeline",
                    "Create 3 social posts highlighting different aspects",
                    "Add to pitch deck as proof point"
                  ],
                  deliverables: "Case study published + Social posts scheduled"
                },
                { day: 27, title: "Continue Outreach", phase: "Week 4: Delivery", focus: "Sales", priority: "high",
                  tasks: [
                    "Reach out to 15 new prospects using case study as social proof",
                    "Reference specific results in outreach: 'Just helped [Company] improve their AI readiness by 40%'",
                    "Book 5-7 discovery calls for next week",
                    "Update CRM with all interactions",
                    "Respond to any pending inquiries"
                  ],
                  deliverables: "15 emails sent + 5-7 calls booked"
                },
                { day: 28, title: "Week 4 Review + Month 1 Complete", phase: "Week 4: Delivery", focus: "Strategy", priority: "medium",
                  tasks: [
                    "Calculate Month 1 metrics: Revenue, Customers, Assessments, Conversion rate",
                    "What worked best? What didn't work?",
                    "Refine ICP based on who actually bought",
                    "Plan Month 2 goals (aim for 2-3x Month 1 revenue)",
                    "Celebrate your wins! Take a break. You earned it. "
                  ],
                  deliverables: "Month 1 complete - First revenue + lessons learned!"
                },

                // MONTH 2: First Revenue & Refinement
                // WEEK 5: Close First Deal
                { day: 29, title: "Month 2 Planning", phase: "Week 5: Scale", focus: "Strategy", priority: "high",
                  tasks: [
                    "Set Month 2 revenue goal (realistic: 2-3x Month 1)",
                    "Identify which service offering is resonating most",
                    "Create early bird pricing for next cohort (20% off)",
                    "Draft announcement: 'Starting cohort on [specific date]'",
                    "Create urgency: limited to first 5 customers"
                  ],
                  deliverables: "Month 2 goals + Early bird offer created"
                },
                { day: 30, title: "Follow Up Warm Leads", phase: "Week 5: Scale", focus: "Sales", priority: "high",
                  tasks: [
                    "Email everyone from Month 1 who showed interest",
                    "Share case study and offer early bird pricing",
                    "Address objections head-on: 'Too expensive?'  Show ROI",
                    "Create comparison doc: DIY vs. Done-With-You vs. Done-For-You",
                    "Goal: Convert 1-2 warm leads this week"
                  ],
                  deliverables: "Follow-up emails sent + Comparison doc created"
                },
                { day: 31, title: "Webinar Prep", phase: "Week 5: Scale", focus: "Marketing", priority: "medium",
                  tasks: [
                    "Plan free webinar: 'AI Maturity Assessment Results Explained'",
                    "Create webinar deck (30 slides): Results overview, Common patterns, Action steps",
                    "Set up Zoom webinar + registration page",
                    "Schedule for next week",
                    "Create email sequence: Invite, reminder day before, day of"
                  ],
                  deliverables: "Webinar scheduled + Deck created + Registration live"
                },
                { day: 32, title: "Webinar Promotion", phase: "Week 5: Scale", focus: "Marketing", priority: "high",
                  tasks: [
                    "Email all assessment takers inviting to webinar",
                    "Post on LinkedIn 3x this week promoting webinar",
                    "Ask first customer to share with their network",
                    "Goal: 30+ registrations",
                    "Create slide with soft pitch at end"
                  ],
                  deliverables: "Webinar promoted + 30+ registrations"
                },
                { day: 33, title: "Deliver Webinar", phase: "Week 5: Scale", focus: "Marketing", priority: "high",
                  tasks: [
                    "Run webinar - provide massive value upfront",
                    "Last 10 mins: soft pitch for paid workshop",
                    "Record entire session",
                    "Capture Q&A for future content",
                    "Send recording + CTA within 1 hour"
                  ],
                  deliverables: "Webinar delivered + Recording shared + Leads captured"
                },
                { day: 34, title: "Webinar Follow-Up", phase: "Week 5: Scale", focus: "Sales", priority: "high",
                  tasks: [
                    "Email all attendees with special offer (valid 48 hours)",
                    "Personal outreach to top 5 engaged attendees",
                    "Book calls with anyone who showed interest",
                    "Add non-attendees to nurture sequence",
                    "Goal: Book 3-5 sales calls"
                  ],
                  deliverables: "Follow-up emails sent + Sales calls booked"
                },
                { day: 35, title: "Week 5 Review", phase: "Week 5: Scale", focus: "Analytics", priority: "medium",
                  tasks: [
                    "Revenue so far in Month 2: $___",
                    "How many sales conversations this week?",
                    "Webinar conversion rate: Attendees  Calls  Sales",
                    "What objections are you hearing most?",
                    "Adjust pitch based on feedback"
                  ],
                  deliverables: "Week 5 metrics + Adjusted pitch"
                },

                // WEEK 6: Deliver First Service
                { day: 36, title: "Service Delivery Prep", phase: "Week 6: Delivery", focus: "Operations", priority: "high",
                  tasks: [
                    "Confirm all logistics for upcoming workshops/consulting",
                    "Customize materials for each client's industry",
                    "Over-prepare: backup slides, extra exercises, bonus resources",
                    "Send pre-session survey to understand their context",
                    "Test all technology 24 hours before"
                  ],
                  deliverables: "Everything prepped for flawless delivery"
                },
                { day: 37, title: "Deliver Session 1", phase: "Week 6: Delivery", focus: "Service Delivery", priority: "high",
                  tasks: [
                    "Deliver workshop/consulting with high energy",
                    "Adapt based on real-time feedback and questions",
                    "Take detailed notes on what resonates",
                    "Capture specific wins and 'aha moments'",
                    "Send same-day recap email with action items"
                  ],
                  deliverables: "Session 1 delivered successfully"
                },
                { day: 38, title: "Deliver Session 2", phase: "Week 6: Delivery", focus: "Service Delivery", priority: "high",
                  tasks: [
                    "Continue service delivery with adjustments from Session 1",
                    "Document what's working well vs. what needs improvement",
                    "Over-deliver with bonus templates or tools",
                    "Build personal rapport - this drives referrals",
                    "Ask for real-time feedback: 'What's most valuable so far?'"
                  ],
                  deliverables: "Session 2 delivered + Feedback collected"
                },
                { day: 39, title: "Collect Testimonials", phase: "Week 6: Delivery", focus: "Marketing", priority: "high",
                  tasks: [
                    "Send testimonial request while experience is fresh",
                    "Make it easy: provide 3 specific questions they can answer",
                    "Offer to draft it for them based on their verbal feedback",
                    "Ask for video testimonial from most satisfied customer",
                    "Request LinkedIn recommendation"
                  ],
                  deliverables: "Testimonials collected + Video request sent"
                },
                { day: 40, title: "Generate Referrals", phase: "Week 6: Delivery", focus: "Growth", priority: "high",
                  tasks: [
                    "Ask each client for 2-3 specific referrals",
                    "Make it easy: 'Who else in [industry/role] faces similar challenges?'",
                    "Offer referral bonus: 10% off next engagement",
                    "Send simple referral template they can forward",
                    "Follow up on any referrals within 24 hours"
                  ],
                  deliverables: "Referral requests sent + Tracking started"
                },
                { day: 41, title: "Document Delivery Process", phase: "Week 6: Delivery", focus: "Operations", priority: "medium",
                  tasks: [
                    "Create standard operating procedure for workshop delivery",
                    "Document what works: timing, exercises, examples",
                    "Note client-specific customizations needed",
                    "Build reusable templates and tools",
                    "Identify opportunities to streamline future delivery"
                  ],
                  deliverables: "SOP created + Templates standardized"
                },
                { day: 42, title: "Week 6 Review", phase: "Week 6: Delivery", focus: "Strategy", priority: "medium",
                  tasks: [
                    "How many customers served this week?",
                    "Customer satisfaction score (1-10)?",
                    "Testimonials received: ___",
                    "Referrals generated: ___",
                    "Revenue this week: $___"
                  ],
                  deliverables: "Week 6 metrics + Delivery insights"
                },

                // WEEK 7: Case Study & Expand Outreach
                { day: 43, title: "Create Case Study #2", phase: "Week 7: Growth", focus: "Content", priority: "high",
                  tasks: [
                    "Write second case study based on recent delivery",
                    "Include specific before/after metrics",
                    "Add customer quotes and testimonials",
                    "Create visual comparison showing transformation",
                    "Get customer approval"
                  ],
                  deliverables: "Second case study completed"
                },
                { day: 44, title: "Publish & Promote", phase: "Week 7: Growth", focus: "Marketing", priority: "high",
                  tasks: [
                    "Publish case study on LinkedIn, website, Medium",
                    "Create carousel post highlighting key results",
                    "Email to all prospects: 'Here's what we're achieving...'",
                    "Tag customer (with permission)",
                    "Schedule 5 social posts over next week"
                  ],
                  deliverables: "Case study published across all channels"
                },
                { day: 45, title: "Scale Outreach", phase: "Week 7: Growth", focus: "Sales", priority: "high",
                  tasks: [
                    "Reach out to 25 new prospects referencing both case studies",
                    "Use social proof: 'Just helped 2 companies improve AI maturity by X%'",
                    "Segment outreach by industry (personalize messaging)",
                    "Goal: Book 7-10 discovery calls",
                    "Track response rates by message type"
                  ],
                  deliverables: "25 emails sent + 7-10 calls booked"
                },
                { day: 46, title: "Discovery Calls", phase: "Week 7: Growth", focus: "Sales", priority: "high",
                  tasks: [
                    "Conduct 3-4 discovery calls today",
                    "Use new pitch incorporating case study results",
                    "Identify exact pain points and quantify impact",
                    "Present tailored solution with pricing",
                    "Send proposal within 24 hours of call"
                  ],
                  deliverables: "3-4 calls completed + Proposals sent"
                },
                { day: 47, title: "More Discovery Calls", phase: "Week 7: Growth", focus: "Sales", priority: "high",
                  tasks: [
                    "Conduct 3-4 more discovery calls",
                    "Test different closing techniques",
                    "Address common objections upfront",
                    "Create urgency with limited availability",
                    "Goal: Close at least 1 deal this week"
                  ],
                  deliverables: "More calls completed + At least 1 deal closed"
                },
                { day: 48, title: "Nurture Pipeline", phase: "Week 7: Growth", focus: "Sales", priority: "medium",
                  tasks: [
                    "Follow up with anyone who hasn't responded to proposals",
                    "Send value-add content to warm leads (not pushy)",
                    "Create FAQ document answering common objections",
                    "Update CRM with all lead statuses",
                    "Identify which leads to prioritize next week"
                  ],
                  deliverables: "Pipeline updated + FAQ created"
                },
                { day: 49, title: "Week 7 Review", phase: "Week 7: Growth", focus: "Analytics", priority: "medium",
                  tasks: [
                    "Outreach sent this week: ___",
                    "Calls conducted: ___",
                    "Deals closed: ___",
                    "Revenue added: $___",
                    "Plan Week 8: What's working? Do more of that."
                  ],
                  deliverables: "Week 7 metrics + Week 8 plan"
                },

                // WEEK 8: Package & Productize
                { day: 50, title: "Productize Workshop", phase: "Week 8: Productization", focus: "Product Development", priority: "high",
                  tasks: [
                    "Create standard workshop template based on delivery learnings",
                    "Build reusable slide deck (reduce customization needed)",
                    "Create participant workbook/handouts",
                    "Develop exercise templates that work across industries",
                    "Set standard pricing tiers (no more custom quotes)"
                  ],
                  deliverables: "Standard workshop package ready to sell"
                },
                { day: 51, title: "Create Pricing Tiers", phase: "Week 8: Productization", focus: "Business Model", priority: "high",
                  tasks: [
                    "Define 3 tiers: DIY, Guided, Done-With-You",
                    "DIY: $299 - Course only",
                    "Guided: $799 - Course + 2 group Q&A",
                    "Done-With-You: $2,999 - Course + private consulting",
                    "Create comparison chart showing value at each tier"
                  ],
                  deliverables: "Pricing tiers defined + Comparison chart"
                },
                { day: 52, title: "Build Service Menu", phase: "Week 8: Productization", focus: "Sales Materials", priority: "medium",
                  tasks: [
                    "Create 1-page service menu showcasing all offerings",
                    "Include: Assessments, Workshops, Consulting, Course",
                    "Add pricing, timeline, deliverables for each",
                    "Design visually (Canva is fine)",
                    "PDF version for email, web version for site"
                  ],
                  deliverables: "Service menu created"
                },
                { day: 53, title: "Standardize Proposals", phase: "Week 8: Productization", focus: "Sales Operations", priority: "medium",
                  tasks: [
                    "Create proposal template with sections: Problem, Solution, Approach, Timeline, Investment",
                    "Add case study snippets",
                    "Include testimonials",
                    "Make it easy to customize in 15 mins or less",
                    "Add clear next steps and CTA"
                  ],
                  deliverables: "Proposal template ready"
                },
                { day: 54, title: "Update Marketing Materials", phase: "Week 8: Productization", focus: "Marketing", priority: "medium",
                  tasks: [
                    "Update website with new service tiers",
                    "Refresh pitch deck with latest case studies",
                    "Create new email sequences for each tier",
                    "Update LinkedIn profile/company page",
                    "Refresh all social media headers/bios"
                  ],
                  deliverables: "All marketing updated with new offerings"
                },
                { day: 55, title: "Sales Push", phase: "Week 8: Productization", focus: "Sales", priority: "high",
                  tasks: [
                    "Email entire prospect list with new tiered offerings",
                    "Highlight different tier for different segments",
                    "Offer Month 2 special: 20% off any tier (expires in 5 days)",
                    "Book calls to present new packages",
                    "Goal: 3-5 new deals this week"
                  ],
                  deliverables: "Sales emails sent + Deals in progress"
                },
                { day: 56, title: "Week 8 & Month 2 Review", phase: "Week 8: Productization", focus: "Strategy", priority: "medium",
                  tasks: [
                    "Month 2 revenue: $___",
                    "Total customers served: ___",
                    "Testimonials collected: ___",
                    "Case studies published: ___",
                    "Biggest win this month?",
                    "Biggest challenge?",
                    "Is the business model working?",
                    "Plan Month 3: Scale and systematize"
                  ],
                  deliverables: "Month 2 complete + Month 3 roadmap"
                },

                // MONTH 3: Systematize & Scale
                // WEEK 9: Create Course MVP
                { day: 57, title: "Course Planning", phase: "Week 9: Course Creation", focus: "Product Development", priority: "high",
                  tasks: [
                    "Outline course structure: 6-8 modules covering AI maturity journey",
                    "Module 1: Understanding AI Maturity Levels",
                    "Module 2: Assessing Your Current State",
                    "Module 3-6: Strategies for each maturity level",
                    "Module 7-8: Implementation and scaling",
                    "Define learning objectives for each module"
                  ],
                  deliverables: "Course outline completed"
                },
                { day: 58, title: "Record Module 1-2", phase: "Week 9: Course Creation", focus: "Content Production", priority: "high",
                  tasks: [
                    "Set up recording space (good mic, lighting, clean background)",
                    "Record Module 1: AI Maturity Overview (15-20 mins)",
                    "Record Module 2: Self-Assessment Guide (15-20 mins)",
                    "Use screen share + talking head format",
                    "Keep it conversational, not scripted"
                  ],
                  deliverables: "Modules 1-2 recorded"
                },
                { day: 59, title: "Record Module 3-4", phase: "Week 9: Course Creation", focus: "Content Production", priority: "high",
                  tasks: [
                    "Record Module 3: Foundation Level Strategies (15-20 mins)",
                    "Record Module 4: Intermediate Level Tactics (15-20 mins)",
                    "Include real examples from your clients",
                    "Add worksheets and templates for each module",
                    "Keep videos under 20 mins for retention"
                  ],
                  deliverables: "Modules 3-4 recorded + Worksheets"
                },
                { day: 60, title: "Record Module 5-6", phase: "Week 9: Course Creation", focus: "Content Production", priority: "high",
                  tasks: [
                    "Record Module 5: Advanced Strategies (15-20 mins)",
                    "Record Module 6: Scaling AI Initiatives (15-20 mins)",
                    "Add case studies and success stories",
                    "Create action items checklist for each module",
                    "Review all recordings for quality"
                  ],
                  deliverables: "Modules 5-6 recorded"
                },
                { day: 61, title: "Course Platform Setup", phase: "Week 9: Course Creation", focus: "Tech Setup", priority: "medium",
                  tasks: [
                    "Choose platform: Teachable, Thinkific, or Gumroad",
                    "Upload all video modules",
                    "Add worksheets and downloadable resources",
                    "Set up payment processing",
                    "Create course landing page with sales copy"
                  ],
                  deliverables: "Course platform ready"
                },
                { day: 62, title: "Beta Testing", phase: "Week 9: Course Creation", focus: "Quality Assurance", priority: "medium",
                  tasks: [
                    "Invite 5 past customers to beta test course for free",
                    "Ask for detailed feedback on each module",
                    "Test all links, downloads, and videos",
                    "Fix any technical issues",
                    "Collect testimonials from beta users"
                  ],
                  deliverables: "Course tested + Feedback incorporated"
                },
                { day: 63, title: "Course Launch Prep", phase: "Week 9: Course Creation", focus: "Marketing", priority: "high",
                  tasks: [
                    "Set course price: $299 for DIY tier",
                    "Create launch discount: $199 for first 20 students",
                    "Write launch email sequence (5 emails over 5 days)",
                    "Create social media launch plan",
                    "Schedule launch for next Monday"
                  ],
                  deliverables: "Course ready to launch"
                },

                // WEEK 10: Hybrid Model Test
                { day: 64, title: "Course Launch", phase: "Week 10: Launch", focus: "Marketing", priority: "high",
                  tasks: [
                    "Send launch email to entire email list",
                    "Post on LinkedIn announcing course",
                    "Share on all social channels",
                    "Reach out personally to top prospects",
                    "Goal: 10 course sales in first week"
                  ],
                  deliverables: "Course launched publicly"
                },
                { day: 65, title: "Launch Promotion", phase: "Week 10: Launch", focus: "Marketing", priority: "high",
                  tasks: [
                    "Post daily on LinkedIn about course benefits",
                    "Share student testimonials",
                    "Create urgency: discount expires in 4 days",
                    "Run live Q&A session about course content",
                    "Email day 2 of launch sequence"
                  ],
                  deliverables: "Daily promotion executed"
                },
                { day: 66, title: "Continue Promotion", phase: "Week 10: Launch", focus: "Sales", priority: "high",
                  tasks: [
                    "Email day 3 of launch sequence",
                    "Highlight specific module that solves pain point",
                    "Share case study of beta tester results",
                    "Offer payment plan option: 3 payments of $75",
                    "Book calls with anyone who asks questions"
                  ],
                  deliverables: "Sales momentum building"
                },
                { day: 67, title: "Tiered Upsells", phase: "Week 10: Launch", focus: "Sales", priority: "high",
                  tasks: [
                    "Email course buyers offering Guided tier upgrade",
                    "Guided tier: Course + 2 group calls for $499 total ($200 upgrade)",
                    "Create urgency: upgrade offer expires in 48 hours",
                    "Goal: Convert 30% of DIY buyers to Guided",
                    "Track which tier is selling best"
                  ],
                  deliverables: "Upsell offers sent"
                },
                { day: 68, title: "Launch Final Push", phase: "Week 10: Launch", focus: "Sales", priority: "high",
                  tasks: [
                    "Final launch email: Discount expires tonight!",
                    "Last call social posts",
                    "Personal outreach to anyone on fence",
                    "Host final live Q&A at 5pm",
                    "Close cart at midnight"
                  ],
                  deliverables: "Launch week completed"
                },
                { day: 69, title: "Analyze Launch", phase: "Week 10: Launch", focus: "Analytics", priority: "medium",
                  tasks: [
                    "Total course sales: ___",
                    "Revenue from launch: $___",
                    "Conversion rate: Email opens  Sales",
                    "Which tier sold best?",
                    "What marketing channel drove most sales?"
                  ],
                  deliverables: "Launch metrics analyzed"
                },
                { day: 70, title: "Week 10 Review", phase: "Week 10: Launch", focus: "Strategy", priority: "medium",
                  tasks: [
                    "Celebrate course launch success!",
                    "Engage with new course students",
                    "Set up student onboarding sequence",
                    "Plan first group Q&A for Guided tier",
                    "Begin planning Week 11 community building"
                  ],
                  deliverables: "Week 10 complete + Student engagement started"
                },

                // WEEK 11: Community Building
                { day: 71, title: "Community Setup", phase: "Week 11: Community", focus: "Community Building", priority: "high",
                  tasks: [
                    "Create private Slack or Discord for all customers",
                    "Set up channels: Intros, wins, questions, resources",
                    "Invite all course students and consulting clients",
                    "Create welcome message and community guidelines",
                    "Introduce yourself and set expectations"
                  ],
                  deliverables: "Community platform launched"
                },
                { day: 72, title: "First Office Hours", phase: "Week 11: Community", focus: "Customer Success", priority: "high",
                  tasks: [
                    "Host first live 'Office Hours' (1 hour, open Q&A)",
                    "Invite all community members",
                    "Answer questions, provide guidance",
                    "Record session for those who can't attend",
                    "Collect feedback on what topics to cover next"
                  ],
                  deliverables: "Office hours delivered"
                },
                { day: 73, title: "Share Resources", phase: "Week 11: Community", focus: "Value Delivery", priority: "medium",
                  tasks: [
                    "Post daily valuable resources in community",
                    "Share templates, checklists, case studies",
                    "Curate industry news and AI updates",
                    "Highlight member wins and progress",
                    "Encourage peer-to-peer introductions"
                  ],
                  deliverables: "Resources shared + Engagement growing"
                },
                { day: 74, title: "Content Marketing Ramp", phase: "Week 11: Community", focus: "Marketing", priority: "high",
                  tasks: [
                    "Commit to posting 3x/week on LinkedIn",
                    "Share thought leadership on AI trends",
                    "Highlight customer wins and testimonials",
                    "Create content calendar for next 2 weeks",
                    "Engage on 10 relevant posts daily"
                  ],
                  deliverables: "Content calendar created + Posting consistently"
                },
                { day: 75, title: "Email Newsletter Launch", phase: "Week 11: Community", focus: "Marketing", priority: "medium",
                  tasks: [
                    "Set up email newsletter (Beehiiv, Substack, or ConvertKit)",
                    "Write first issue: AI maturity insights, case study, resources",
                    "Email to all assessment takers and community",
                    "Commit to weekly cadence",
                    "Add newsletter signup to website"
                  ],
                  deliverables: "Newsletter launched"
                },
                { day: 76, title: "Guest Post Outreach", phase: "Week 11: Community", focus: "Growth", priority: "medium",
                  tasks: [
                    "Identify 5 relevant industry blogs/publications",
                    "Pitch guest post ideas on AI maturity",
                    "Leverage case studies and data",
                    "Include backlink to your assessment",
                    "Goal: Secure 1-2 guest post opportunities"
                  ],
                  deliverables: "Guest post pitches sent"
                },
                { day: 77, title: "Week 11 Review", phase: "Week 11: Community", focus: "Analytics", priority: "medium",
                  tasks: [
                    "Community members: ___",
                    "Engagement rate in community",
                    "Office hours attendance",
                    "Newsletter subscribers: ___",
                    "Guest post acceptances: ___"
                  ],
                  deliverables: "Week 11 metrics"
                },

                // WEEK 12: Quarter Review & Roadmap
                { day: 78, title: "Metrics Deep Dive", phase: "Week 12: Review", focus: "Analytics", priority: "high",
                  tasks: [
                    "Total assessments completed: ___ (Goal: 50+)",
                    "Total customers: ___ (Goal: 5-10)",
                    "Total revenue: $___ (Goal: $15K-25K)",
                    "Course sales: ___",
                    "Average customer satisfaction (NPS): ___"
                  ],
                  deliverables: "Complete Q1 metrics compiled"
                },
                { day: 79, title: "What's Working Analysis", phase: "Week 12: Review", focus: "Strategy", priority: "high",
                  tasks: [
                    "Which customer segment converts best?",
                    "Which service tier is most popular?",
                    "What marketing channel brings best leads?",
                    "What content gets most engagement?",
                    "Which referral sources are strongest?"
                  ],
                  deliverables: "Analysis of what's working"
                },
                { day: 80, title: "What's Not Working", phase: "Week 12: Review", focus: "Strategy", priority: "high",
                  tasks: [
                    "Where are prospects dropping off?",
                    "What objections keep coming up?",
                    "What's taking too much time for ROI?",
                    "What should you stop doing?",
                    "What processes need improvement?"
                  ],
                  deliverables: "List of improvements needed"
                },
                { day: 81, title: "Customer Feedback", phase: "Week 12: Review", focus: "Customer Success", priority: "medium",
                  tasks: [
                    "Survey all customers: 'What can we improve?'",
                    "Ask for testimonials from anyone not yet asked",
                    "Identify your biggest fans for advocacy program",
                    "Note feature requests for product roadmap",
                    "Calculate NPS score"
                  ],
                  deliverables: "Customer feedback collected"
                },
                { day: 82, title: "Financial Review", phase: "Week 12: Review", focus: "Finance", priority: "high",
                  tasks: [
                    "Revenue breakdown by offering type",
                    "Calculate actual costs (time, tools, services)",
                    "Profit margin per offering",
                    "Customer acquisition cost",
                    "Lifetime value estimate"
                  ],
                  deliverables: "Financial analysis complete"
                },
                { day: 83, title: "Q2 Planning", phase: "Week 12: Review", focus: "Strategy", priority: "high",
                  tasks: [
                    "Set Q2 revenue goal (2-3x Q1)",
                    "Pick 1-2 new initiatives based on learnings",
                    "Identify partnerships to pursue",
                    "Plan platform beta testing",
                    "Create Q2 week-by-week roadmap"
                  ],
                  deliverables: "Q2 strategic plan"
                },
                { day: 84, title: "Celebrate & Reset", phase: "Week 12: Review", focus: "Celebration", priority: "high",
                  tasks: [
                    "Review all wins from Q1",
                    "Celebrate your progress! You've built a real business!",
                    "Share success with your network",
                    "Take a day off - you earned it",
                    "Come back Monday ready to scale in Q2"
                  ],
                  deliverables: "Q1 COMPLETE!  Time to scale."
                },

                // DAYS 85-90: Q2 Prep & Early Execution
                { day: 85, title: "Partnership Identification", phase: "Q2 Start", focus: "Partnerships", priority: "high",
                  tasks: [
                    "List 10 potential white-label partners",
                    "Complementary services (HR consulting, change management, tech vendors)",
                    "Research their customer base and service gaps",
                    "Draft partnership value proposition",
                    "Reach out to top 3 partners"
                  ],
                  deliverables: "Partner list + Outreach started"
                },
                { day: 86, title: "Partner Package Creation", phase: "Q2 Start", focus: "Partnerships", priority: "medium",
                  tasks: [
                    "Create white-label partner package",
                    "Define revenue share model (60/40 or 50/50)",
                    "Build co-branded materials template",
                    "Create partner onboarding process",
                    "Draft partnership agreement"
                  ],
                  deliverables: "Partner package ready"
                },
                { day: 87, title: "Platform Beta Planning", phase: "Q2 Start", focus: "Product", priority: "high",
                  tasks: [
                    "Identify 10 power users for platform beta",
                    "Define MVP features for beta: dashboard, team tracking, reports",
                    "Create beta tester agreement and NDA",
                    "Set beta timeline: 4-6 weeks",
                    "Invite beta testers"
                  ],
                  deliverables: "Beta program designed + Testers invited"
                },
                { day: 88, title: "Automated Marketing Setup", phase: "Q2 Start", focus: "Marketing Automation", priority: "medium",
                  tasks: [
                    "Map out email automation funnel",
                    "Assessment takers  nurture sequence  course/workshop",
                    "Set up abandoned cart emails for course",
                    "Create post-purchase onboarding sequence",
                    "Build re-engagement campaign for inactive leads"
                  ],
                  deliverables: "Email automation flows mapped"
                },
                { day: 89, title: "Referral Program Launch", phase: "Q2 Start", focus: "Growth", priority: "high",
                  tasks: [
                    "Design referral program: Give $50, Get $50",
                    "Create simple referral tracking system",
                    "Build referral landing page",
                    "Email all customers with referral invite",
                    "Add referral CTA to all customer touchpoints"
                  ],
                  deliverables: "Referral program live"
                },
                { day: 90, title: "90-Day Reflection", phase: "90-Day Complete", focus: "Reflection", priority: "high",
                  tasks: [
                    "You started with an idea. Now you have a business.",
                    "Customers served: ___",
                    "Revenue generated: $___",
                    "Lessons learned: ___",
                    "You proved people will pay you to solve their problem",
                    "Now: Scale what works, stop what doesn't, and keep building",
                    "The next 90 days will be even better. Let's go! "
                  ],
                  deliverables: "90-DAY JOURNEY COMPLETE! "
                }
            ];
        }

        // Inline editing - click to edit any section
        document.addEventListener('click', (e) => {
            const editable = e.target.closest('.gtm-editable');
            if (editable && editable.contentEditable !== 'true') {
                // Enable editing on click
                editable.contentEditable = 'true';
                editable.focus();

                // Save on blur
                const saveHandler = () => {
                    editable.contentEditable = 'false';
                    const section = editable.dataset.section;
                    if (section) {
                        saveGTMSection(section, editable.innerHTML);
                        showToast('Changes saved! ');
                    }
                    editable.removeEventListener('blur', saveHandler);
                };

                editable.addEventListener('blur', saveHandler);

                // Save on Ctrl/Cmd + Enter
                const keyHandler = (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                        editable.blur();
                        editable.removeEventListener('keydown', keyHandler);
                    }
                };
                editable.addEventListener('keydown', keyHandler);
            }
        }, true);

        // Save section to localStorage (and optionally Supabase)
        async function saveGTMSection(section, content) {
            // Save to localStorage
            localStorage.setItem(`gtm_${section}`, content);

            // In production, save to Supabase for real-time collaboration
            console.log('Saving section:', section, content);
        }

        // Copy workshop template
        function copyWorkshopTemplate(type) {
            const templates = {
                web: `WEB WORKSHOP OUTLINE\n\n3-Hour AI Strategy Workshop ($2,500 - $5,000)\n\nPart 1: Foundation (60 mins)\n- The 5-stage AI maturity model\n- Interactive assessment of attendees\n- Industry-specific examples\n\nPart 2: Implementation (60 mins)\n- Common mistakes at each stage\n- 30-day quick wins by maturity level\n- ROI calculation framework\n\nPart 3: Action Planning (60 mins)\n- Real case studies from similar companies\n- Q&A and problem solving\n- Personalized roadmap creation\n\nBonus Materials:\n- AI tool comparison spreadsheet\n- ROI calculator template\n- 30-day implementation checklist\n- 30-day email follow-up sequence`,
                inperson: `IN-PERSON WORKSHOP OUTLINE\n\nFull-Day Implementation Workshop ($10,000 - $15,000)\n\nMorning Session (9am - 12pm):\n- AI maturity assessment for team\n- Live process mapping exercise\n- Hands-on tool setup and configuration\n- Custom use case development\n\nLunch & Networking (12pm - 1pm)\n\nAfternoon Session (1pm - 5pm):\n- Team collaboration exercises\n- Build first AI workflow together\n- 90-day roadmap creation\n- Implementation planning\n- Q&A and troubleshooting\n\nIncludes:\n- All workshop materials printed\n- Custom templates for your industry\n- Dedicated Slack channel for 30 days\n- Follow-up call at day 15 and day 30\n- Travel and expenses included`
            };
            navigator.clipboard.writeText(templates[type]).then(() => {
                showToast(`${type === 'web' ? 'Web' : 'In-Person'} workshop outline copied! `);
            }).catch(() => {
                showToast('Failed to copy - please try again', 2000);
            });
        }

        // Copy to clipboard function
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showToast('Template copied to clipboard! ');
            }).catch(() => {
                showToast('Failed to copy - please try again', 2000);
            });
        }

        // ==========================================
        // INTERACTIVE GANTT CHART
        // ==========================================

        function renderInteractiveGantt() {
            const container = document.getElementById('mermaidDiagram');
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

            // Group items by quarter
            const quarters = {
                'Q1 2026': roadmapItems.filter(i => i.quarter === 'Q1 2026'),
                'Q2 2026': roadmapItems.filter(i => i.quarter === 'Q2 2026'),
                'Q3 2026': roadmapItems.filter(i => i.quarter === 'Q3 2026'),
                'Q4 2026': roadmapItems.filter(i => i.quarter === 'Q4 2026')
            };

            container.innerHTML = `
                <div class="interactive-gantt">
                    <div class="gantt-header">
                        <h2 class="gantt-title">HumanGlue Development Roadmap 2026</h2>
                        <div class="gantt-controls">
                            <button class="btn btn-primary" onclick="openRoadmapModal()" style="padding: 8px 16px; font-size: 13px;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 6px; vertical-align: -3px;">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                </svg>
                                Add Item
                            </button>
                            <button class="btn btn-secondary" onclick="loadDiagram('roadmap', document.querySelector('[onclick*=roadmap]'))" style="padding: 8px 16px; font-size: 13px;">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 6px; vertical-align: -3px;">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                </svg>
                                Refresh
                            </button>
                        </div>
                    </div>

                    <div class="gantt-months" style="margin-left: 180px;">
                        ${months.map(m => `<div class="gantt-month">${m}</div>`).join('')}
                    </div>

                    <div class="gantt-timeline">
                        ${Object.entries(quarters).map(([quarter, items]) => `
                            <div class="gantt-section">
                                <div class="gantt-section-title">${quarter}</div>
                                <div class="gantt-items">
                                    ${items.length === 0 ? `
                                        <div style="padding: 16px; color: #6b7280; font-size: 13px;">
                                            No items in ${quarter}. <a href="#" onclick="openRoadmapModal(); document.getElementById('roadmapQuarter').value='${quarter}'; return false;" style="color: var(--hg-cyan);">Add one</a>
                                        </div>
                                    ` : items.map(item => {
                                        const startDate = new Date(item.start_date);
                                        const startMonth = startDate.getMonth();
                                        const startDay = startDate.getDate();
                                        const leftPercent = ((startMonth * 30 + startDay) / 365) * 100;
                                        const widthPercent = (item.duration / 365) * 100;

                                        return `
                                            <div class="gantt-item">
                                                <div class="gantt-item-label" title="${item.title}">${item.title}</div>
                                                <div class="gantt-item-bar-container">
                                                    <div class="gantt-grid-lines">
                                                        ${months.map(() => '<div class="gantt-grid-line"></div>').join('')}
                                                    </div>
                                                    <div class="gantt-item-bar status-${item.status}"
                                                         style="left: ${leftPercent}%; width: ${Math.max(widthPercent, 5)}%;"
                                                         onclick="openRoadmapModal('${item.id}')"
                                                         title="${item.description || item.title}&#10;Duration: ${item.duration} days&#10;Click to edit">
                                                        <div class="drag-handle"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        `).join('')}

                        <button class="gantt-add-btn" onclick="openRoadmapModal()">
                            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                            </svg>
                            Add Timeline Item
                        </button>
                    </div>

                    <div style="margin-top: 24px; padding: 16px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.2);">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                            <svg width="18" height="18" fill="none" stroke="var(--hg-blue)" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <span style="color: var(--hg-blue); font-weight: 600; font-size: 13px;">AI Tip</span>
                        </div>
                        <p style="color: #e5e7eb; font-size: 13px; margin: 0;">
                            Click on any timeline item to edit it. Add tasks from architecture diagrams and they'll sync here automatically.
                            Ask the AI assistant about dependencies or blockers for any feature.
                        </p>
                    </div>
                </div>
            `;
        }

        // ==========================================
        // KANBAN BOARD RENDERING
        // ==========================================

        function renderKanbanBoard() {
            const container = document.getElementById('mermaidDiagram');
            const columns = [
                { id: 'backlog', title: 'Backlog', dot: 'backlog' },
                { id: 'todo', title: 'To Do', dot: 'todo' },
                { id: 'progress', title: 'In Progress', dot: 'progress' },
                { id: 'review', title: 'Review', dot: 'review' },
                { id: 'done', title: 'Done', dot: 'done' }
            ];

            const totalPoints = sprintTasks.reduce((sum, t) => sum + t.points, 0);
            const donePoints = sprintTasks.filter(t => t.status === 'done').reduce((sum, t) => sum + t.points, 0);
            const progressPercent = Math.round((donePoints / totalPoints) * 100);

            container.innerHTML = `
                <div style="display: flex; flex-direction: column; height: 100%;">
                    <!-- Sprint Header -->
                    <div class="kanban-sprint-header">
                        <div class="kanban-sprint-info">
                            <span class="kanban-sprint-name">Sprint 12</span>
                            <span class="kanban-sprint-dates">Dec 2-15, 2025</span>
                        </div>
                        <div class="kanban-sprint-progress">
                            <div class="kanban-progress-bar">
                                <div class="kanban-progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <span class="kanban-progress-text">${donePoints}/${totalPoints} pts (${progressPercent}%)</span>
                        </div>
                    </div>

                    <!-- Sprint Stats -->
                    <div class="sprint-stats-grid">
                        <div class="sprint-stat">
                            <div class="sprint-stat-value">${sprintTasks.length}</div>
                            <div class="sprint-stat-label">Total Tasks</div>
                        </div>
                        <div class="sprint-stat">
                            <div class="sprint-stat-value" style="color: #F59E0B;">${sprintTasks.filter(t => t.status === 'progress').length}</div>
                            <div class="sprint-stat-label">In Progress</div>
                        </div>
                        <div class="sprint-stat">
                            <div class="sprint-stat-value" style="color: #10B981;">${sprintTasks.filter(t => t.status === 'done').length}</div>
                            <div class="sprint-stat-label">Completed</div>
                        </div>
                        <div class="sprint-stat">
                            <div class="sprint-stat-value">${totalPoints}</div>
                            <div class="sprint-stat-label">Story Points</div>
                        </div>
                    </div>

                    <!-- Kanban Board -->
                    <div class="kanban-board">
                        ${columns.map(col => {
                            const tasks = sprintTasks.filter(t => t.status === col.id);
                            return `
                                <div class="kanban-column" data-status="${col.id}">
                                    <div class="kanban-column-header">
                                        <div class="kanban-column-title">
                                            <span class="kanban-column-dot ${col.dot}"></span>
                                            ${col.title}
                                            <span class="kanban-column-count">${tasks.length}</span>
                                        </div>
                                    </div>
                                    <div class="kanban-column-items"
                                         ondragover="handleDragOver(event)"
                                         ondragleave="handleDragLeave(event)"
                                         ondrop="handleDrop(event, '${col.id}')">
                                        ${tasks.map(task => `
                                            <div class="kanban-card"
                                                 draggable="true"
                                                 data-task-id="${task.id}"
                                                 ondragstart="handleDragStart(event, '${task.id}')"
                                                 ondragend="handleDragEnd(event)"
                                                 onclick="openSprintTaskDetail('${task.id}')"
                                                 style="cursor: pointer;">
                                                <div class="kanban-card-title">${task.title}</div>
                                                <div class="kanban-card-meta">
                                                    <span class="kanban-card-tag ${task.type}">${task.type}</span>
                                                    <span class="kanban-card-points">${task.points} pts</span>
                                                    ${task.assignee ? `<span class="kanban-card-assignee">${task.assignee}</span>` : ''}
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <button class="kanban-add-card" onclick="openSprintTaskModal(null, '${col.id}')">
                                        <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                        </svg>
                                        Add Card
                                    </button>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // Kanban Drag and Drop
        function handleDragStart(event, taskId) {
            draggedCard = taskId;
            event.target.classList.add('dragging');
        }

        function handleDragEnd(event) {
            event.target.classList.remove('dragging');
            draggedCard = null;
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(event) {
            event.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(event, newStatus) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');

            if (draggedCard) {
                const task = sprintTasks.find(t => t.id === draggedCard);
                if (task) {
                    task.status = newStatus;
                    renderKanbanBoard();
                    localStorage.setItem('hg_sprint_tasks', JSON.stringify(sprintTasks));
                }
            }
        }

        function openSprintTaskModal(taskId, defaultStatus = 'backlog') {
            editingSprintTaskId = taskId;
            const task = taskId ? sprintTasks.find(t => t.id === taskId) : null;

            // Reuse the roadmap modal for now with different content
            const modal = document.getElementById('roadmapModal');
            modal.querySelector('.modal-title').textContent = task ? 'Edit Task' : 'Add Task';
            modal.querySelector('.modal-body').innerHTML = `
                <div class="form-group">
                    <label class="form-label">Task Title</label>
                    <input type="text" id="sprintTaskTitle" class="form-input" value="${task?.title || ''}" placeholder="Task title...">
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="sprintTaskDesc" class="form-textarea" placeholder="Task description...">${task?.description || ''}</textarea>
                </div>
                <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select id="sprintTaskStatus" class="form-select">
                            <option value="backlog" ${(task?.status || defaultStatus) === 'backlog' ? 'selected' : ''}>Backlog</option>
                            <option value="todo" ${(task?.status || defaultStatus) === 'todo' ? 'selected' : ''}>To Do</option>
                            <option value="progress" ${(task?.status || defaultStatus) === 'progress' ? 'selected' : ''}>In Progress</option>
                            <option value="review" ${(task?.status || defaultStatus) === 'review' ? 'selected' : ''}>Review</option>
                            <option value="done" ${(task?.status || defaultStatus) === 'done' ? 'selected' : ''}>Done</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select id="sprintTaskType" class="form-select">
                            <option value="feature" ${task?.type === 'feature' ? 'selected' : ''}>Feature</option>
                            <option value="bug" ${task?.type === 'bug' ? 'selected' : ''}>Bug</option>
                            <option value="enhancement" ${task?.type === 'enhancement' ? 'selected' : ''}>Enhancement</option>
                            <option value="docs" ${task?.type === 'docs' ? 'selected' : ''}>Docs</option>
                            <option value="design" ${task?.type === 'design' ? 'selected' : ''}>Design</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Points</label>
                        <select id="sprintTaskPoints" class="form-select">
                            <option value="1" ${task?.points === 1 ? 'selected' : ''}>1</option>
                            <option value="2" ${task?.points === 2 ? 'selected' : ''}>2</option>
                            <option value="3" ${task?.points === 3 ? 'selected' : ''}>3</option>
                            <option value="5" ${task?.points === 5 ? 'selected' : ''}>5</option>
                            <option value="8" ${task?.points === 8 ? 'selected' : ''}>8</option>
                            <option value="13" ${task?.points === 13 ? 'selected' : ''}>13</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Assignee Initials</label>
                    <input type="text" id="sprintTaskAssignee" class="form-input" value="${task?.assignee || ''}" placeholder="e.g., MS" maxlength="3">
                </div>
            `;
            modal.querySelector('.modal-actions').innerHTML = `
                ${task ? '<button class="btn btn-danger" onclick="deleteSprintTask()">Delete</button>' : ''}
                <button class="btn btn-secondary" onclick="closeRoadmapModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveSprintTask()">Save Task</button>
            `;
            modal.classList.add('show');
        }

        function saveSprintTask() {
            const taskData = {
                title: document.getElementById('sprintTaskTitle').value,
                description: document.getElementById('sprintTaskDesc').value,
                status: document.getElementById('sprintTaskStatus').value,
                type: document.getElementById('sprintTaskType').value,
                points: parseInt(document.getElementById('sprintTaskPoints').value),
                assignee: document.getElementById('sprintTaskAssignee').value
            };

            if (editingSprintTaskId) {
                const idx = sprintTasks.findIndex(t => t.id === editingSprintTaskId);
                if (idx !== -1) {
                    sprintTasks[idx] = { ...sprintTasks[idx], ...taskData };
                }
            } else {
                sprintTasks.push({ id: Date.now().toString(), ...taskData });
            }

            localStorage.setItem('hg_sprint_tasks', JSON.stringify(sprintTasks));
            renderKanbanBoard();
            closeRoadmapModal();
        }

        function deleteSprintTask() {
            if (editingSprintTaskId && confirm('Delete this task?')) {
                sprintTasks = sprintTasks.filter(t => t.id !== editingSprintTaskId);
                localStorage.setItem('hg_sprint_tasks', JSON.stringify(sprintTasks));
                renderKanbanBoard();
                closeRoadmapModal();
            }
        }

        // ==========================================
        // MIND MAP RENDERING
        // ==========================================

        function renderMindMap() {
            const container = document.getElementById('mermaidDiagram');

            container.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; min-height: 600px; overflow: hidden;">
                    <svg id="mindMapSvg" width="100%" height="100%" style="position: absolute; top: 0; left: 0;">
                        <!-- Connection lines will be drawn here -->
                    </svg>
                    <div id="mindMapNodes" style="position: relative; width: 100%; height: 100%;">
                        ${mindMapNodes.map(node => `
                            <div class="mindmap-node"
                                 data-node-id="${node.id}"
                                 style="
                                    position: absolute;
                                    left: ${node.x}px;
                                    top: ${node.y}px;
                                    background: ${node.color}20;
                                    border: 2px solid ${node.color};
                                    border-radius: 12px;
                                    padding: 12px 20px;
                                    cursor: grab;
                                    transition: transform 0.1s, box-shadow 0.2s;
                                    z-index: 10;
                                    font-size: ${node.id === 'root' ? '16px' : '13px'};
                                    font-weight: ${node.id === 'root' ? '600' : '500'};
                                    color: ${node.color};
                                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                                    ${node.status === 'blocked' ? 'opacity: 0.6; border-style: dashed;' : ''}
                                    ${node.prunable ? 'border-style: dotted;' : ''}
                                 "
                                 onmousedown="startMindMapDrag(event, '${node.id}')"
                                 onclick="handleMindMapNodeClick('${node.id}')"
                                 title=" ${node.label}&#10; Priority: ${node.priority || 'medium'}&#10; ${node.why || 'No context'}&#10;${node.prunable ? ' PRUNABLE - Consider deferring' : ' Essential'}">
                                ${node.children && node.children.length > 0 ? `
                                    <span style="margin-right: 6px; opacity: 0.7;">${node.expanded ? '' : '+'}</span>
                                ` : ''}
                                ${node.priority === 'critical' ? ' ' : node.priority === 'high' ? ' ' : node.priority === 'low' ? ' ' : ' '}
                                ${node.label}
                                ${node.status === 'blocked' ? '<span style="margin-left: 6px;"></span>' : ''}
                                ${node.prunable ? '<span style="margin-left: 6px; font-size: 10px;"></span>' : ''}
                            </div>
                        `).join('')}
                    </div>

                    <!-- Node Palette -->
                    <div class="node-palette visible" style="display: flex;">
                        <span class="node-palette-title">Add Node:</span>
                        <button class="node-palette-item component" onclick="addMindMapNode('component')">
                            <svg width="12" height="12" fill="currentColor" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
                            Component
                        </button>
                        <button class="node-palette-item service" onclick="addMindMapNode('service')">
                            <svg width="12" height="12" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"/></svg>
                            Service
                        </button>
                        <button class="node-palette-item database" onclick="addMindMapNode('database')">
                            <svg width="12" height="12" fill="currentColor" viewBox="0 0 24 24"><ellipse cx="12" cy="6" rx="8" ry="3"/><path d="M4 6v12c0 1.66 3.58 3 8 3s8-1.34 8-3V6"/></svg>
                            Database
                        </button>
                        <button class="node-palette-item external" onclick="addMindMapNode('external')">
                            <svg width="12" height="12" fill="currentColor" viewBox="0 0 24 24"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6M15 3h6v6M10 14L21 3"/></svg>
                            External
                        </button>
                    </div>
                </div>
            `;

            // Draw connection lines
            drawMindMapConnections();
        }

        function drawMindMapConnections() {
            const svg = document.getElementById('mindMapSvg');
            if (!svg) return;

            let lines = '';
            mindMapNodes.forEach(node => {
                if (node.children && node.expanded) {
                    node.children.forEach(childId => {
                        const child = mindMapNodes.find(n => n.id === childId);
                        if (child) {
                            const x1 = node.x + 80;
                            const y1 = node.y + 20;
                            const x2 = child.x + 40;
                            const y2 = child.y + 20;
                            const midX = (x1 + x2) / 2;

                            lines += `
                                <path d="M ${x1} ${y1} C ${midX} ${y1}, ${midX} ${y2}, ${x2} ${y2}"
                                      stroke="${child.color || '#61D8FE'}"
                                      stroke-width="2"
                                      fill="none"
                                      stroke-opacity="0.5"/>
                            `;
                        }
                    });
                }
            });
            svg.innerHTML = lines;
        }

        function handleMindMapNodeClick(nodeId) {
            const node = mindMapNodes.find(n => n.id === nodeId);
            if (node && node.children && node.children.length > 0) {
                node.expanded = !node.expanded;
                renderMindMap();
            } else {
                // Show AI tooltip for leaf nodes
                const context = componentContext[nodeId] || componentContext['default'];
                showAITooltip(nodeId, node.label, event.clientX, event.clientY);
            }
        }

        function addMindMapNode(type) {
            const colors = {
                component: '#61D8FE',
                service: '#3B82F6',
                database: '#10B981',
                external: '#F59E0B'
            };

            const newNode = {
                id: 'node_' + Date.now(),
                label: 'New ' + type.charAt(0).toUpperCase() + type.slice(1),
                x: 400 + Math.random() * 200 - 100,
                y: 300 + Math.random() * 200 - 100,
                children: [],
                expanded: false,
                color: colors[type]
            };

            mindMapNodes.push(newNode);
            renderMindMap();
        }

        // ==========================================
        // MIND MAP DRAG FUNCTIONS
        // ==========================================

        function startMindMapDrag(event, nodeId) {
            event.stopPropagation();
            const node = mindMapNodes.find(n => n.id === nodeId);
            if (!node) return;

            mindMapDragState = {
                isDragging: true,
                nodeId: nodeId,
                startX: event.clientX,
                startY: event.clientY,
                originalX: node.x,
                originalY: node.y
            };

            document.addEventListener('mousemove', handleMindMapDrag);
            document.addEventListener('mouseup', stopMindMapDrag);
            event.target.style.cursor = 'grabbing';
        }

        function handleMindMapDrag(event) {
            if (!mindMapDragState.isDragging) return;

            const node = mindMapNodes.find(n => n.id === mindMapDragState.nodeId);
            if (!node) return;

            const dx = event.clientX - mindMapDragState.startX;
            const dy = event.clientY - mindMapDragState.startY;

            node.x = mindMapDragState.originalX + dx;
            node.y = mindMapDragState.originalY + dy;

            renderMindMap();
        }

        function stopMindMapDrag(event) {
            if (mindMapDragState.isDragging) {
                document.removeEventListener('mousemove', handleMindMapDrag);
                document.removeEventListener('mouseup', stopMindMapDrag);
                mindMapDragState.isDragging = false;
                mindMapDragState.nodeId = null;
            }
        }

        // ==========================================
        // EXPERT ADVISORS FUNCTIONS
        // ==========================================

        let currentExpert = 'ai'; // Default to AI assistant
        let selectedChatExpert = 'ai';

        // Mind Reasoner Expert IDs (public trained minds)
        const MIND_REASONER_EXPERTS = {
            'steve-jobs': {
                mindId: '16c1b8bd-5a2b-46e3-b2e6-3657ca2bc964',
                name: 'Steve Jobs',
                icon: '',
                image: 'https://avatars.reasoner.com/public/steve_jobs.png',
                description: 'product vision'
            },
            'paul-graham': {
                mindId: '8600002e-4058-4b66-8e85-c44596300692',
                name: 'Paul Graham',
                icon: '',
                image: 'https://avatars.reasoner.com/public/paul_graham.png',
                description: 'startup strategy'
            },
            'jony-ive': {
                mindId: '29332f6c-fcdb-43c4-92b1-a859a837c564',
                name: 'Jony Ive',
                icon: '',
                image: 'https://avatars.reasoner.com/public/jony_ive.png',
                description: 'design'
            },
            'peter-thiel': {
                mindId: 'ad836d14-9f52-49f2-8027-49fd018e1ed4',
                name: 'Peter Thiel',
                icon: '',
                image: 'https://avatars.reasoner.com/public/peter_thiel.png',
                description: 'zero-to-one thinking'
            }
        };

        function selectExpertForChat(expertId) {
            selectedChatExpert = expertId;

            // Update button states
            document.querySelectorAll('.expert-chip').forEach(btn => {
                btn.style.border = '1px solid var(--border-subtle)';
                btn.style.background = 'var(--bg-tertiary)';
                btn.style.color = 'var(--text-secondary)';
            });

            const activeBtn = document.getElementById(`expert-btn-${expertId}`);
            if (activeBtn) {
                activeBtn.style.border = '1px solid var(--hg-cyan)';
                activeBtn.style.background = 'rgba(97, 216, 254, 0.1)';
                activeBtn.style.color = 'var(--hg-cyan)';
            }

            // Update chat placeholder
            const chatInput = document.getElementById('chatInput');
            const expertNames = {
                'ai': 'the project',
                'steve-jobs': 'Steve Jobs about product vision',
                'paul-graham': 'Paul Graham about startup strategy',
                'jony-ive': 'Jony Ive about design',
                'peter-thiel': 'Peter Thiel about zero-to-one strategy'
            };
            chatInput.placeholder = `Ask ${expertNames[expertId]}...`;

            // Add expert switch message to chat
            const chatMessages = document.getElementById('chatMessages');
            const expertDisplayNames = {
                'ai': ' AI Project Assistant',
                'steve-jobs': ' Steve Jobs',
                'paul-graham': ' Paul Graham',
                'jony-ive': ' Jony Ive',
                'peter-thiel': ' Peter Thiel'
            };

            const switchMessage = document.createElement('div');
            switchMessage.className = 'chat-message system';
            switchMessage.innerHTML = `
                <div style="text-align: center; padding: 8px; color: var(--text-muted); font-size: 12px;">
                    Now chatting with <strong style="color: var(--hg-cyan);">${expertDisplayNames[expertId]}</strong>
                </div>
            `;
            chatMessages.appendChild(switchMessage);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function toggleExpertsList() {
            const modal = document.getElementById('expertsModal');
            if (modal.style.display === 'flex') {
                closeExpertsModal();
            } else {
                modal.style.display = 'flex';
            }
        }

        function closeExpertsModal() {
            const modal = document.getElementById('expertsModal');
            if (modal) modal.style.display = 'none';
        }

        function consultExpert(expertId) {
            currentExpert = expertId;
            const expertNames = {
                'steve-jobs': 'Steve Jobs',
                'paul-graham': 'Paul Graham',
                'jony-ive': 'Jony Ive'
            };
            const expertDescriptions = {
                'steve-jobs': 'Focus, simplicity, and user experience. Will challenge you on product vision and push for excellence.',
                'paul-graham': 'Startup strategy, product-market fit, and lean execution. Will probe your assumptions and help refine your business model.',
                'jony-ive': 'Design thinking, craftsmanship, and attention to detail. Will help you think about form, function, and the emotional impact of your product.'
            };

            document.getElementById('expertConsultTitle').textContent = `Consult with ${expertNames[expertId]}`;
            document.getElementById('expertConsultDescription').textContent = expertDescriptions[expertId];
            document.getElementById('expertConsultModal').style.display = 'flex';
            closeExpertsModal();
        }

        function closeExpertConsultModal() {
            document.getElementById('expertConsultModal').style.display = 'none';
            currentExpert = null;
        }

        async function sendExpertQuery() {
            const input = document.getElementById('expertQueryInput');
            const query = input.value.trim();
            if (!query) return;

            const responseDiv = document.getElementById('expertResponse');
            responseDiv.innerHTML = '<div style="color: var(--hg-cyan);"> Thinking...</div>';

            // Get project context
            const projectContext = `
                Project: HumanGlue Platform
                Current Phase: MVP Development
                Components: ${mindMapNodes.map(n => n.label).join(', ')}
                Critical Items: ${mindMapNodes.filter(n => n.priority === 'critical').map(n => n.label).join(', ')}
                Prunable: ${mindMapNodes.filter(n => n.prunable).map(n => n.label).join(', ') || 'None identified'}
            `;

            // Simulate expert response (in real implementation, would call Mind Reasoner API)
            setTimeout(() => {
                const responses = {
                    'steve-jobs': `Focus. That's what's missing in most products. You have ${mindMapNodes.length} components here. Do you really need all of them for your MVP? I see some marked as prunable - that's good thinking. But let me challenge you: what's the ONE thing that makes HumanGlue irreplaceable? Start there. Everything else is a distraction until you nail that.`,
                    'paul-graham': `Looking at your architecture, the question isn't whether it's technically sound - it's whether you're building something people desperately want. Your Assessment Engine seems to be the core. Have you talked to 10 potential customers this week? What's the conversion rate on your current prototype? The best startups I've seen don't worry about perfect architecture - they worry about finding product-market fit first.`,
                    'jony-ive': `The complexity I see here concerns me from a user experience perspective. Every component you add is another cognitive load on your users. Think about the journey: someone comes to HumanGlue, what do they see first? How does each interaction feel? The best products feel inevitable, as if they couldn't have been designed any other way. Does yours?`
                };
                responseDiv.innerHTML = `<div style="color: var(--text-primary); line-height: 1.6;">${responses[currentExpert] || 'Expert response would appear here...'}</div>`;
            }, 1500);

            input.value = '';
        }

        function askExpertQuickQuestion(question) {
            document.getElementById('expertQueryInput').value = question;
            sendExpertQuery();
        }

        // ==========================================
        // CUSTOM SECTIONS FUNCTIONS
        // ==========================================

        let customSections = JSON.parse(localStorage.getItem('hg_custom_sections') || '[]');
        let newSectionColor = '#61D8FE';

        function openAddSectionModal() {
            document.getElementById('addSectionModal').style.display = 'flex';
            document.getElementById('newSectionName').value = '';
            document.getElementById('newSectionDescription').value = '';
        }

        function closeAddSectionModal() {
            document.getElementById('addSectionModal').style.display = 'none';
        }

        function setNewSectionColor(color) {
            newSectionColor = color;
            document.querySelectorAll('.color-option').forEach(opt => {
                opt.style.border = opt.dataset.color === color ? '2px solid white' : '2px solid transparent';
            });
        }

        function saveCustomSection() {
            const name = document.getElementById('newSectionName').value.trim();
            const description = document.getElementById('newSectionDescription').value.trim();

            if (!name) {
                alert('Please enter a section name');
                return;
            }

            const section = {
                id: 'section_' + Date.now(),
                name: name,
                description: description,
                color: newSectionColor,
                created: new Date().toISOString()
            };

            customSections.push(section);
            localStorage.setItem('hg_custom_sections', JSON.stringify(customSections));
            renderCustomSections();
            closeAddSectionModal();
        }

        function renderCustomSections() {
            const container = document.getElementById('customSectionsContainer');
            if (!container) return;

            container.innerHTML = customSections.map(section => `
                <button class="nav-item" onclick="showCustomSection('${section.id}')" style="border-left: 3px solid ${section.color};">
                    ${section.name}
                </button>
            `).join('');
        }

        function showCustomSection(sectionId) {
            const section = customSections.find(s => s.id === sectionId);
            if (!section) return;

            // For now, show in the main content area
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div style="padding: 20px;">
                    <h2 style="color: ${section.color}; margin-bottom: 10px;">${section.name}</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">${section.description || 'No description provided.'}</p>
                    <div style="background: var(--bg-secondary); border-radius: 8px; padding: 20px; border: 1px solid var(--border-subtle);">
                        <p style="color: var(--text-muted);">This custom section is ready for your content. You can add notes, diagrams, or any project documentation here.</p>
                    </div>
                </div>
            `;
        }

        function deleteCustomSection(sectionId) {
            customSections = customSections.filter(s => s.id !== sectionId);
            localStorage.setItem('hg_custom_sections', JSON.stringify(customSections));
            renderCustomSections();
        }

        // ==========================================
        // SPRINT CARD DETAIL FUNCTIONS
        // ==========================================

        const sprintTaskDetails = {
            'onboarding-flow': {
                title: 'Organization Onboarding Flow',
                status: 'done',
                priority: 'critical',
                description: 'Complete signup and onboarding experience for new organizations including account creation, team setup, and initial configuration.',
                components: ['Authentication System', 'User Management', 'Organization Settings', 'Email Notifications'],
                dependencies: ['Supabase Auth', 'Email Service (Resend)', 'Database Schema'],
                linkedFiles: [
                    { path: 'app/signup/page.tsx', status: 'complete' },
                    { path: 'app/api/organizations/register/route.ts', status: 'complete' },
                    { path: 'lib/email-templates.ts', status: 'complete' }
                ],
                acceptanceCriteria: [
                    { text: 'User can create organization account', done: true },
                    { text: 'Email verification sent on signup', done: true },
                    { text: 'Admin can invite team members', done: true },
                    { text: 'Organization settings page functional', done: true }
                ],
                notes: 'Implemented with Supabase Auth. Supports SSO for enterprise tier.'
            },
            'assessment-engine': {
                title: 'AI Assessment Engine',
                status: 'in-progress',
                priority: 'critical',
                description: 'Core assessment engine that powers the AI maturity evaluation. Integrates VAPI for voice interactions and generates comprehensive reports.',
                components: ['VAPI Integration', 'Scoring Algorithm', 'Report Generator', 'PDF Export'],
                dependencies: ['VAPI API', 'Assessment Schema', 'Supabase Database'],
                linkedFiles: [
                    { path: 'app/api/assessments/[id]/pdf/route.ts', status: 'in-progress' },
                    { path: 'lib/services/assessment-scoring.ts', status: 'complete' },
                    { path: 'components/organisms/AssessmentFlow.tsx', status: 'in-progress' }
                ],
                acceptanceCriteria: [
                    { text: 'Voice assessment via VAPI works end-to-end', done: true },
                    { text: 'Scoring algorithm calculates maturity level', done: true },
                    { text: 'PDF reports generate correctly', done: false },
                    { text: 'Results stored in database', done: true }
                ],
                notes: 'PDF export having issues with chart rendering. Need to investigate.'
            },
            'admin-dashboard': {
                title: 'Admin Dashboard',
                status: 'in-progress',
                priority: 'high',
                description: 'Comprehensive admin interface for managing organizations, users, assessments, and platform analytics.',
                components: ['Analytics Charts', 'User Management', 'Assessment Viewer', 'Settings Panel'],
                dependencies: ['Recharts Library', 'Supabase Admin API', 'Role-based Access'],
                linkedFiles: [
                    { path: 'app/admin/page.tsx', status: 'in-progress' },
                    { path: 'app/admin/analytics/page.tsx', status: 'in-progress' },
                    { path: 'app/admin/users/page.tsx', status: 'complete' },
                    { path: 'components/organisms/DashboardSidebar.tsx', status: 'complete' }
                ],
                acceptanceCriteria: [
                    { text: 'Dashboard shows key metrics', done: true },
                    { text: 'Can view all organizations', done: true },
                    { text: 'Can manage user roles', done: true },
                    { text: 'Analytics charts render correctly', done: false }
                ],
                notes: 'Charts need color scheme update to match new branding.'
            },
            'expert-network': {
                title: 'Expert Application System',
                status: 'todo',
                priority: 'medium',
                description: 'Allow industry experts to apply to join the HumanGlue expert network. Includes application form, review workflow, and expert profiles.',
                components: ['Application Form', 'Admin Review Panel', 'Expert Profiles', 'Matching Algorithm'],
                dependencies: ['Supabase Storage (resumes)', 'Email Notifications', 'Expert Schema'],
                linkedFiles: [
                    { path: 'app/apply/page.tsx', status: 'planned' },
                    { path: 'app/api/expert-applications/route.ts', status: 'planned' },
                    { path: 'app/admin/applications/page.tsx', status: 'planned' }
                ],
                acceptanceCriteria: [
                    { text: 'Experts can submit application', done: false },
                    { text: 'Admin can review applications', done: false },
                    { text: 'Approved experts appear in directory', done: false },
                    { text: 'Email notifications for status changes', done: false }
                ],
                notes: 'Database migration ready. Need to implement UI components.'
            },
            'video-conferencing': {
                title: 'Video Conferencing Integration',
                status: 'todo',
                priority: 'medium',
                description: 'Integrate video conferencing for live consultations between clients and experts.',
                components: ['Daily.co Integration', 'Meeting Scheduler', 'Recording Storage', 'Transcription'],
                dependencies: ['Daily.co API', 'Calendar System', 'Supabase Storage'],
                linkedFiles: [
                    { path: 'lib/services/video-conferencing.ts', status: 'in-progress' },
                    { path: 'app/api/video-conferencing/meetings/route.ts', status: 'planned' }
                ],
                acceptanceCriteria: [
                    { text: 'Can schedule video meetings', done: false },
                    { text: 'Video calls work in browser', done: false },
                    { text: 'Recordings saved to storage', done: false },
                    { text: 'AI transcription generated', done: false }
                ],
                notes: 'Daily.co preferred over Zoom for better API experience.'
            }
        };

        function openSprintTaskDetail(taskId) {
            // First try to get from detailed predefined data
            let task = sprintTaskDetails[taskId];

            // If not found, get from sprint tasks array
            if (!task) {
                const sprintTask = sprintTasks.find(t => t.id === taskId);
                if (!sprintTask) {
                    console.warn('Task not found:', taskId);
                    return;
                }

                // Build a basic task object from sprint data
                const statusMapping = {
                    'done': 'done',
                    'progress': 'in-progress',
                    'todo': 'todo',
                    'backlog': 'todo'
                };

                task = {
                    title: sprintTask.title,
                    status: statusMapping[sprintTask.status] || 'todo',
                    priority: sprintTask.points >= 8 ? 'high' : sprintTask.points >= 5 ? 'medium' : 'low',
                    description: sprintTask.description || 'No detailed description available.',
                    components: [sprintTask.type.charAt(0).toUpperCase() + sprintTask.type.slice(1)],
                    dependencies: [],
                    linkedFiles: [],
                    acceptanceCriteria: [
                        { text: 'Task completed as specified', done: sprintTask.status === 'done' }
                    ],
                    notes: `Assigned to: ${sprintTask.assignee || 'Unassigned'} | Story Points: ${sprintTask.points}`
                };
            }

            const statusColors = {
                'done': '#10B981',
                'in-progress': '#3B82F6',
                'todo': '#6B7280'
            };
            const statusLabels = {
                'done': 'Completed',
                'in-progress': 'In Progress',
                'todo': 'To Do'
            };

            const modal = document.createElement('div');
            modal.id = 'sprintTaskModal';
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h2 style="margin-bottom: 8px;">${task.title}</h2>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <span class="status-badge" style="background: ${statusColors[task.status]}20; color: ${statusColors[task.status]}; padding: 4px 12px; border-radius: 12px; font-size: 12px;">
                                    ${statusLabels[task.status]}
                                </span>
                                <span style="color: var(--text-muted); font-size: 12px;">Priority: ${task.priority}</span>
                            </div>
                        </div>
                        <button onclick="closeSprintTaskModal()" style="background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer;">&times;</button>
                    </div>

                    <div style="margin-top: 20px;">
                        <p style="color: var(--text-secondary); line-height: 1.6;">${task.description}</p>
                    </div>

                    <div style="margin-top: 24px;">
                        <h4 style="color: var(--hg-cyan); margin-bottom: 12px;"> Components</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${task.components.map(c => `<span style="background: var(--bg-tertiary); padding: 6px 12px; border-radius: 6px; font-size: 12px;">${c}</span>`).join('')}
                        </div>
                    </div>

                    <div style="margin-top: 24px;">
                        <h4 style="color: var(--hg-cyan); margin-bottom: 12px;"> Dependencies</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${task.dependencies.map(d => `<span style="background: rgba(59, 130, 246, 0.1); color: #3B82F6; padding: 6px 12px; border-radius: 6px; font-size: 12px;">${d}</span>`).join('')}
                        </div>
                    </div>

                    <div style="margin-top: 24px;">
                        <h4 style="color: var(--hg-cyan); margin-bottom: 12px;"> Linked Files</h4>
                        <div style="background: var(--bg-secondary); border-radius: 8px; padding: 12px;">
                            ${task.linkedFiles.map(f => `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid var(--border-subtle);">
                                    <code style="font-size: 12px; color: var(--text-primary);">${f.path}</code>
                                    <span style="font-size: 11px; padding: 2px 8px; border-radius: 4px; background: ${f.status === 'complete' ? '#10B98120' : f.status === 'in-progress' ? '#3B82F620' : '#6B728020'}; color: ${f.status === 'complete' ? '#10B981' : f.status === 'in-progress' ? '#3B82F6' : '#6B7280'};">
                                        ${f.status}
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div style="margin-top: 24px;">
                        <h4 style="color: var(--hg-cyan); margin-bottom: 12px;"> Acceptance Criteria</h4>
                        <div style="background: var(--bg-secondary); border-radius: 8px; padding: 12px;">
                            ${task.acceptanceCriteria.map(c => `
                                <div style="display: flex; align-items: center; gap: 10px; padding: 8px;">
                                    <span style="color: ${c.done ? '#10B981' : '#6B7280'};">${c.done ? '' : ''}</span>
                                    <span style="color: ${c.done ? 'var(--text-primary)' : 'var(--text-secondary)'}; ${c.done ? '' : 'opacity: 0.7;'}">${c.text}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div style="margin-top: 24px;">
                        <h4 style="color: var(--hg-cyan); margin-bottom: 12px;"> Notes</h4>
                        <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 16px; border-left: 3px solid var(--hg-cyan);">
                            <p style="color: var(--text-secondary); font-style: italic;">${task.notes}</p>
                        </div>
                    </div>

                    <div style="margin-top: 24px; display: flex; gap: 12px; justify-content: flex-end;">
                        <button onclick="openInMindMap('${taskId}')" style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-subtle); padding: 10px 20px; border-radius: 6px; cursor: pointer;">
                             View in Mind Map
                        </button>
                        <button onclick="closeSprintTaskModal()" style="background: var(--hg-cyan); color: black; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            Close
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function closeSprintTaskModal() {
            const modal = document.getElementById('sprintTaskModal');
            if (modal) {
                modal.remove();
            }
        }

        function openInMindMap(taskId) {
            closeSprintTaskModal();
            showView('architecture');
            // Highlight the relevant node
            setTimeout(() => {
                const nodeMapping = {
                    'onboarding-flow': 'admin',
                    'assessment-engine': 'assessment',
                    'admin-dashboard': 'admin',
                    'expert-network': 'client',
                    'video-conferencing': 'integrations'
                };
                const nodeId = nodeMapping[taskId];
                if (nodeId) {
                    const node = mindMapNodes.find(n => n.id === nodeId);
                    if (node) {
                        node.expanded = true;
                        renderMindMap();
                    }
                }
            }, 100);
        }

        // ==========================================
        // SIDEBAR COLLAPSE FUNCTIONS
        // ==========================================

        function toggleSidebar() {
            const container = document.querySelector('.app-container');
            container.classList.toggle('sidebar-collapsed');
            // Save preference
            localStorage.setItem('hg_sidebar_collapsed', container.classList.contains('sidebar-collapsed'));
        }

        function toggleRightPanel() {
            const container = document.querySelector('.app-container');
            container.classList.toggle('right-collapsed');
            // Save preference
            localStorage.setItem('hg_right_collapsed', container.classList.contains('right-collapsed'));
        }

        // Restore sidebar state on load
        function restoreSidebarState() {
            const container = document.querySelector('.app-container');
            if (localStorage.getItem('hg_sidebar_collapsed') === 'true') {
                container.classList.add('sidebar-collapsed');
            }
            if (localStorage.getItem('hg_right_collapsed') === 'true') {
                container.classList.add('right-collapsed');
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeNoteModal();
                closeSettingsModal();
                closeRoadmapModal();
                hideAITooltip();
                closeExpertsModal();
                closeExpertConsultModal();
                closeAddSectionModal();
                closeSprintTaskModal();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === '=') {
                e.preventDefault();
                zoomIn();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === '-') {
                e.preventDefault();
                zoomOut();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === '0') {
                e.preventDefault();
                resetZoom();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                openNoteModal();
            }
            // Toggle sidebars with [ and ]
            if (e.key === '[' && !e.ctrlKey && !e.metaKey) {
                toggleSidebar();
            }
            if (e.key === ']' && !e.ctrlKey && !e.metaKey) {
                toggleRightPanel();
            }
        });

        // Service worker for offline support (optional)
        if ('serviceWorker' in navigator) {
            // Could register a service worker for offline functionality
        }
    </script>
</body>
</html>
